/* empty css             *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                */import{x as ie,aX as de,az as ge,r as D,h as be,y as Q,z as B,P as k,H as N,O as le,a6 as ae,G as se,A as M,C as xe,M as ue,c as ee,ag as we,X as Ee,k as _e,L as q,I as he,Q as fe}from"./core-BfEwNXui.js";/* empty css                   *//* empty css                  *//* empty css                     *//* empty css                  */import{G as ye,H as ve,I as me,B as Ce,D as Le,n as Ie,m as Se,J as Oe,K as Ae}from"./ui-B3K06Owz.js";import{_ as ce}from"./main-DEf5jZjr.js";var re={exports:{}},pe;function je(){return pe||(pe=1,function(H,L){(function(S,V){H.exports=V()})(window,function(){return R={},S.m=V=[function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0}),h.SVGNS="http://www.w3.org/2000/svg"},function(E,h,g){var b,x=this&&this.__extends||(b=function(l,n){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,e){o.__proto__=e}||function(o,e){for(var r in e)e.hasOwnProperty(r)&&(o[r]=e[r])})(l,n)},function(l,n){function o(){this.constructor=l}b(l,n),l.prototype=n===null?Object.create(n):(o.prototype=n.prototype,new o)}),p=this&&this.__values||function(l){var n=typeof Symbol=="function"&&Symbol.iterator,o=n&&l[n],e=0;if(o)return o.call(l);if(l&&typeof l.length=="number")return{next:function(){return l&&e>=l.length&&(l=void 0),{value:l&&l[e++],done:!l}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var y,f,m,d=g(4),u=g(3);function s(){var l=f!==null&&f.apply(this,arguments)||this;return l.entities=new Map,l.nextId=0,l}y=h.Base||(h.Base={}),f=u.EventEmitter,x(s,f),Object.defineProperty(s.prototype,"json",{get:function(){var l,n,o=[];try{for(var e=p(this.values()),r=e.next();!r.done;r=e.next()){var t=r.value;"json"in t?o.push(t.json):o.push(JSON.parse(JSON.stringify(t)))}}catch(i){l={error:i}}finally{try{r&&!r.done&&(n=e.return)&&n.call(e)}finally{if(l)throw l.error}}return o},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"length",{get:function(){return this.entities.size},enumerable:!0,configurable:!0}),s.prototype.get=function(l){return d.assert(this.has(l),"There's no Entity which id="+l+" in repo!"),this.entities.get(l)},s.prototype.has=function(l){return this.entities.has(l)},s.prototype.set=function(l,n){var o=this.has(l);return this.entities.set(l,n),o?this.emit("updated",n):(this.nextId<l+1&&(this.nextId=l+1),this.emit("created",n)),this},s.prototype.add=function(l){if("id"in l){var n=l.id;return d.assert(!this.has(n),"reAdd "+n+"!"),n===null?(l.id=this.nextId,this.add(l)):(this.set(n,l),n)}var o=this.nextId;return this.set(o,l),o},s.prototype[Symbol.iterator]=function(){return this.entities[Symbol.iterator]()},s.prototype.delete=function(l){if(typeof l=="number"&&this.has(l)){var n=this.get(l);return this.entities.delete(l),this.emit("removed",n),!0}return typeof l!="number"&&"id"in l&&this.delete(l.id)},s.prototype.values=function(){return this.entities.values()},m=s,y.Repository=m},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0});var b=(Object.defineProperty(x.prototype,"isSome",{get:function(){return this.value!==null},enumerable:!0,configurable:!0}),x.prototype.map=function(f){return this.value===null?new x(null):new x(f(this.value))},x.prototype.flatMap=function(f){return this.value===null?new x(null):y(f(this.value).toNullable())},x.prototype.orElse=function(f){return this.value===null?f:this.value},x.prototype.toNullable=function(){return this.value},x.prototype.match=function(f,m){return this.isSome?f:m},x);function x(f){this.value=f}function p(f){return new b(f)}function y(f){return f==null?h.none:p(f)}h.Option=b,h.none=new b(null),h.some=p,h.fromNullable=y,h.fromTry=function(f){try{return p(f())}catch{return h.none}}},function(E,h,g){var b,x=typeof Reflect=="object"?Reflect:null,p=x&&typeof x.apply=="function"?x.apply:function(e,r,t){return Function.prototype.apply.call(e,r,t)};b=x&&typeof x.ownKeys=="function"?x.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var y=Number.isNaN||function(e){return e!=e};function f(){f.init.call(this)}((E.exports=f).EventEmitter=f).prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var m=10;function d(e){return e._maxListeners===void 0?f.defaultMaxListeners:e._maxListeners}function u(e,r,t,i){var a,c,v;if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if((c=e._events)===void 0?(c=e._events=Object.create(null),e._eventsCount=0):(c.newListener!==void 0&&(e.emit("newListener",r,t.listener?t.listener:t),c=e._events),v=c[r]),v===void 0)v=c[r]=t,++e._eventsCount;else if(typeof v=="function"?v=c[r]=i?[t,v]:[v,t]:i?v.unshift(t):v.push(t),0<(a=d(e))&&v.length>a&&!v.warned){v.warned=!0;var w=new Error("Possible EventEmitter memory leak detected. "+v.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");w.name="MaxListenersExceededWarning",w.emitter=e,w.type=r,w.count=v.length,function(_){console&&console.warn&&console.warn(_)}(w)}return e}function s(e,r,t){var i={fired:!1,wrapFn:void 0,target:e,type:r,listener:t},a=(function(){for(var c=[],v=0;v<arguments.length;v++)c.push(arguments[v]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,p(this.listener,this.target,c))}).bind(i);return a.listener=t,i.wrapFn=a}function l(e,r,t){var i=e._events;if(i===void 0)return[];var a=i[r];return a===void 0?[]:typeof a=="function"?t?[a.listener||a]:[a]:t?function(c){for(var v=new Array(c.length),w=0;w<v.length;++w)v[w]=c[w].listener||c[w];return v}(a):o(a,a.length)}function n(e){var r=this._events;if(r!==void 0){var t=r[e];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}function o(e,r){for(var t=new Array(r),i=0;i<r;++i)t[i]=e[i];return t}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return m},set:function(e){if(typeof e!="number"||e<0||y(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");m=e}}),f.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||y(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},f.prototype.getMaxListeners=function(){return d(this)},f.prototype.emit=function(e){for(var r=[],t=1;t<arguments.length;t++)r.push(arguments[t]);var i=e==="error",a=this._events;if(a!==void 0)i=i&&a.error===void 0;else if(!i)return!1;if(i){var c;if(0<r.length&&(c=r[0]),c instanceof Error)throw c;var v=new Error("Unhandled error."+(c?" ("+c.message+")":""));throw v.context=c,v}var w=a[e];if(w===void 0)return!1;if(typeof w=="function")p(w,this,r);else{var _=w.length,C=o(w,_);for(t=0;t<_;++t)p(C[t],this,r)}return!0},f.prototype.on=f.prototype.addListener=function(e,r){return u(this,e,r,!1)},f.prototype.prependListener=function(e,r){return u(this,e,r,!0)},f.prototype.once=function(e,r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);return this.on(e,s(this,e,r)),this},f.prototype.prependOnceListener=function(e,r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);return this.prependListener(e,s(this,e,r)),this},f.prototype.off=f.prototype.removeListener=function(e,r){var t,i,a,c,v;if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r);if((i=this._events)===void 0)return this;if((t=i[e])===void 0)return this;if(t===r||t.listener===r)--this._eventsCount==0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,t.listener||r));else if(typeof t!="function"){for(a=-1,c=t.length-1;0<=c;c--)if(t[c]===r||t[c].listener===r){v=t[c].listener,a=c;break}if(a<0)return this;a===0?t.shift():function(w,_){for(;_+1<w.length;_++)w[_]=w[_+1];w.pop()}(t,a),t.length===1&&(i[e]=t[0]),i.removeListener!==void 0&&this.emit("removeListener",e,v||r)}return this},f.prototype.removeAllListeners=function(e){var r,t,i;if((t=this._events)===void 0)return this;if(t.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):t[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete t[e]),this;if(arguments.length===0){var a,c=Object.keys(t);for(i=0;i<c.length;++i)(a=c[i])!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(r=t[e])=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;0<=i;i--)this.removeListener(e,r[i]);return this},f.prototype.listeners=function(e){return l(this,e,!0)},f.prototype.rawListeners=function(e){return l(this,e,!1)},f.listenerCount=function(e,r){return typeof e.listenerCount=="function"?e.listenerCount(r):n.call(e,r)},f.prototype.listenerCount=n,f.prototype.eventNames=function(){return 0<this._eventsCount?b(this._events):[]}},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0}),h.assert=function(b,x){}},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0}),h.shadeColor=function(b,x){var p=parseInt(b.slice(1),16),y=Math.min((p>>16)+(p>>16)*x/100,255),f=Math.min((p>>8&255)+(p>>8&255)*x/100,255);return"#"+(Math.min((255&p)+(255&p)*x/100,255)|f<<8|y<<16).toString(16)},h.addAlpha=function(b,x){var p=parseInt(b.slice(1),16);return"rgba("+(p>>16)+","+(p>>8&255)+","+(255&p)+","+x+"%)"}},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0});function b(){this.layer=0}h.TopContextUser=b,h.overLaps=function x(p,y){return p.layer===y.layer&&(p.left>y.left?x(y,p):!(p.left+p.width<y.left))}},function(E,h,g){var b,x=this&&this.__extends||(b=function(s,l){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var e in o)o.hasOwnProperty(e)&&(n[e]=o[e])})(s,l)},function(s,l){function n(){this.constructor=s}b(s,l),s.prototype=l===null?Object.create(l):(n.prototype=l.prototype,new n)}),p=this&&this.__read||function(s,l){var n=typeof Symbol=="function"&&s[Symbol.iterator];if(!n)return s;var o,e,r=n.call(s),t=[];try{for(;(l===void 0||0<l--)&&!(o=r.next()).done;)t.push(o.value)}catch(i){e={error:i}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return t},y=this&&this.__spread||function(){for(var s=[],l=0;l<arguments.length;l++)s=s.concat(p(arguments[l]));return s};Object.defineProperty(h,"__esModule",{value:!0});var f=g(6),m=g(0),d=g(1),u=g(5);(function(s){var l,n=(l=f.TopContextUser,x(o,l),Object.defineProperty(o.prototype,"id",{get:function(){return this.store.id},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineIn",{get:function(){return this.contextIn.belongTo},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"view",{get:function(){return this.lineIn.view},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"highLightWidth",{get:function(){return this.view.contentWidth(this.store.startIndex,this.store.endIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"highLightLeft",{get:function(){return this.view.contentWidth(this.lineIn.startIndex,this.store.startIndex)+this.lineIn.view.paddingLeft},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"middle",{get:function(){return this.highLightLeft+this.highLightWidth/2},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"labelLeft",{get:function(){return this.middle-this.labelWidth/2},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"labelRight",{get:function(){return this.middle+this.labelWidth/2},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"labelWidth",{get:function(){return this.view.labelFont.widthOf(this.store.category.text)+this.config.labelPadding+2},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"left",{get:function(){return this.config.labelWidthCalcMethod==="max"?this.labelWidth>this.highLightWidth?this.labelLeft:this.highLightLeft:this.labelLeft},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this.config.labelWidthCalcMethod==="max"?this.labelWidth>this.highLightWidth-1?this.labelWidth:this.highLightWidth-1:this.labelWidth},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"annotationY",{get:function(){return-this.view.topContextLayerHeight*(this.layer-1)-(this.view.labelFont.lineHeight+2+2*this.config.labelPadding+this.config.bracketWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"globalY",{get:function(){return this.lineIn.y+this.annotationY},enumerable:!0,configurable:!0}),o.prototype.render=function(){var i;this.svgElement=document.createElementNS(m.SVGNS,"g"),(i=this.svgElement.classList).add.apply(i,y(this.config.labelClasses));var a=this.createHighLightElement(),c=this.createAnnotationElement(),v=this.view.topContextLayerHeight*(this.layer-1),w=this.createBracketElement(this.highLightWidth,-v,0,-v,this.config.bracketWidth);return this.svgElement.appendChild(a),this.svgElement.appendChild(c),this.svgElement.appendChild(w),this.svgElement},o.prototype.update=function(){this.svgElement.style.transform="translate("+this.highLightLeft+"px,"+this.lineIn.y+"px)"},o.prototype.remove=function(){this.svgElement.remove()},o.prototype.createHighLightElement=function(){var i=document.createElementNS(m.SVGNS,"rect"),a=this.store.category.color;return i.setAttribute("height",this.lineIn.view.contentFont.lineHeight.toString()),i.setAttribute("width",this.highLightWidth.toString()),i.setAttribute("fill",/^#/g.test(a)?u.addAlpha(a,70):a),i},o.prototype.createBracketElement=function(i,a,c,v,w,_){_===void 0&&(_=.6);var C=i-c,I=a-v,O=Math.sqrt(C*C+I*I),j=i+_*w*(I/=O),T=a-_*w*(C/=O),F=i-.25*O*C+(1-_)*w*I,A=a-.25*O*I-(1-_)*w*C,X=i-.5*O*C+w*I,$=a-.5*O*I-w*C,U=c+_*w*I,G=v-_*w*C,te=i-.75*O*C+(1-_)*w*I,ne=a-.75*O*I-(1-_)*w*C,W=document.createElementNS(m.SVGNS,"path");return W.setAttribute("d","M"+i+","+a+"Q"+j+","+T+","+F+","+A+"T"+X+","+$+"M"+c+","+v+"Q"+U+","+G+","+te+","+ne+"T"+X+","+$),W.setAttribute("fill","none"),W.setAttribute("stroke",this.store.category.borderColor),W},o.prototype.createAnnotationElement=function(){var i=this,a=this.view.labelCategoryElementFactoryRepository.get(this.store.category.id).create();return a.style.transform="translate("+(this.highLightWidth-this.labelWidth)/2+"px,"+this.annotationY+"px)",a.onclick=function(c){i.view.root.emit("labelClicked",i.id,c)},a.ondblclick=function(c){i.view.root.emit("labelDoubleClicked",i.id,c)},a.oncontextmenu=function(c){i.view.root.emit("labelRightClicked",i.id,c),c.preventDefault()},a.onmouseenter=function(){i.svgElement.classList.add("hover"),Array.from(i.store.connectionsFrom).map(function(c){return i.view.connectionViewRepository.get(c.id)}).map(function(c){return c.addHover("from")}),Array.from(i.store.connectionsTo).map(function(c){return i.view.connectionViewRepository.get(c.id)}).map(function(c){return c.addHover("to")})},a.onmouseleave=function(){i.svgElement.classList.remove("hover"),Array.from(i.store.connectionsFrom).map(function(c){return i.view.connectionViewRepository.get(c.id)}).map(function(c){return c.removeHover("from")}),Array.from(i.store.connectionsTo).map(function(c){return i.view.connectionViewRepository.get(c.id)}).map(function(c){return c.removeHover("to")})},a},o);function o(i,a,c){var v=l.call(this)||this;return v.store=i,v.contextIn=a,v.config=c,v.layer=0,v.svgElement=null,v}s.Entity=n;var e,r=(e=d.Base.Repository,x(t,e),t.prototype.get=function(i){return this.entities.get(i)},t);function t(){return e!==null&&e.apply(this,arguments)||this}s.Repository=r})(h.LabelView||(h.LabelView={}))},function(E,h,g){var b,x=this&&this.__extends||(b=function(f,m){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,u){d.__proto__=u}||function(d,u){for(var s in u)u.hasOwnProperty(s)&&(d[s]=u[s])})(f,m)},function(f,m){function d(){this.constructor=f}b(f,m),f.prototype=m===null?Object.create(m):(d.prototype=m.prototype,new d)}),p=this&&this.__values||function(f){var m=typeof Symbol=="function"&&Symbol.iterator,d=m&&f[m],u=0;if(d)return d.call(f);if(f&&typeof f.length=="number")return{next:function(){return f&&u>=f.length&&(f=void 0),{value:f&&f[u++],done:!f}}};throw new TypeError(m?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var y=g(1);(function(f){var m=(Object.defineProperty(d.prototype,"startIndex",{get:function(){return this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"endIndex",{get:function(){return this._endIndex},enumerable:!0,configurable:!0}),d.prototype.move=function(e){this._startIndex+=e,this._endIndex+=e},Object.defineProperty(d.prototype,"category",{get:function(){return this.root.labelCategoryRepo.get(this.categoryId)},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"json",{get:function(){return{id:this.id,categoryId:this.categoryId,startIndex:this.startIndex,endIndex:this.endIndex}},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"sameLineConnections",{get:function(){var e,r,t=[];try{for(var i=p(this.root.connectionRepo.values()),a=i.next();!a.done;a=i.next()){var c=a.value;c.priorLabel===this&&t.push(c)}}catch(v){e={error:v}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"connectionsFrom",{get:function(){var e,r,t=new Set;try{for(var i=p(this.root.connectionRepo.values()),a=i.next();!a.done;a=i.next()){var c=a.value;c.from===this&&t.add(c)}}catch(v){e={error:v}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"connectionsTo",{get:function(){var e,r,t=new Set;try{for(var i=p(this.root.connectionRepo.values()),a=i.next();!a.done;a=i.next()){var c=a.value;c.to===this&&t.add(c)}}catch(v){e={error:v}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"allConnections",{get:function(){return new Set(Array.prototype.concat(Array.from(this.connectionsFrom),Array.from(this.connectionsTo)))},enumerable:!0,configurable:!0}),d);function d(e,r,t,i,a){this.id=e,this.categoryId=r,this._startIndex=t,this._endIndex=i,this.root=a}f.Entity=m;var u,s,l=(u=y.Base.Repository,x(n,u),n.prototype.set=function(e,r){return this.againstMultipleLabelWith(r)?console.warn("try set a label against the againstMultipleLabelWith rule!"):u.prototype.set.call(this,e,r),this},n.prototype.add=function(e){return this.againstMultipleLabelWith(e)?(console.warn("try add a label against the againstMultipleLabelWith rule!"),-1):u.prototype.add.call(this,e)},n.prototype.againstMultipleLabelWith=function(e){function r(i,a){return i.startIndex===a.startIndex&&i.endIndex===a.endIndex}var t=this.config.allowMultipleLabel==="notAllowed"?r:function(i,a){return r(i,a)&&i.categoryId==a.categoryId};return Array.from(this.values()).some(function(i){return t(i,e)})},n.prototype.getEntitiesInRange=function(e,r){return Array.from(this.entities.values()).filter(function(t){return e<=t.startIndex&&t.endIndex<=r})},n.prototype.getEntitiesCross=function(e){return Array.from(this.entities.values()).filter(function(r){return r.startIndex<=e&&e<r.endIndex})},n);function n(e){var r=u.call(this)||this;return r.config=e,r}function o(e,r){return new m(e.id,e.categoryId,e.startIndex,e.endIndex,r)}f.Repository=l,(s=f.Factory||(f.Factory={})).create=o,s.createAll=function(e,r){return e.map(function(t){return o(t,r)})}})(h.Label||(h.Label={}))},function(E,h,g){var b,x=this&&this.__extends||(b=function(y,f){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,d){m.__proto__=d}||function(m,d){for(var u in d)d.hasOwnProperty(u)&&(m[u]=d[u])})(y,f)},function(y,f){function m(){this.constructor=y}b(y,f),y.prototype=f===null?Object.create(f):(m.prototype=f.prototype,new m)});Object.defineProperty(h,"__esModule",{value:!0});var p=g(1);(function(y){var f=(Object.defineProperty(m.prototype,"category",{get:function(){return this.root.connectionCategoryRepo.get(this.categoryId)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"from",{get:function(){return this.root.labelRepo.get(this.fromId)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"to",{get:function(){return this.root.labelRepo.get(this.toId)},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"priorLabel",{get:function(){return this.from.startIndex<this.to.startIndex?this.from:this.to},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"posteriorLabel",{get:function(){return this.from.startIndex>=this.to.startIndex?this.from:this.to},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"json",{get:function(){return{id:this.id,categoryId:this.categoryId,fromId:this.fromId,toId:this.toId}},enumerable:!0,configurable:!0}),m);function m(o,e,r,t,i){this.id=o,this.categoryId=e,this.fromId=r,this.toId=t,this.root=i}y.Entity=f;var d,u,s=(d=p.Base.Repository,x(l,d),l.prototype.set=function(o,e){return this.againstMultipleConnectionRuleWith(e)?console.warn("try set a label against the checkMultipleLabel rule!"):d.prototype.set.call(this,o,e),this},l.prototype.add=function(o){return this.againstMultipleConnectionRuleWith(o)?(console.warn("try add a label against the checkMultipleLabel rule!"),-1):d.prototype.add.call(this,o)},l.prototype.againstMultipleConnectionRuleWith=function(o){function e(t,i){return t.from===i.from&&t.to===i.to}var r=this.config.allowMultipleConnection==="notAllowed"?e:function(t,i){return e(t,i)&&t.categoryId==i.categoryId};return Array.from(this.values()).some(function(t){return r(t,o)})},l);function l(o){var e=d.call(this)||this;return e.config=o,e}function n(o,e){return new f(o.id,o.categoryId,o.fromId,o.toId,e)}y.Repository=s,(u=y.Factory||(y.Factory={})).create=n,u.createAll=function(o,e){return o.map(function(r){return n(r,e)})}})(h.Connection||(h.Connection={}))},function(E,h,g){var b,x=this&&this.__extends||(b=function(u,s){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,n){l.__proto__=n}||function(l,n){for(var o in n)n.hasOwnProperty(o)&&(l[o]=n[o])})(u,s)},function(u,s){function l(){this.constructor=u}b(u,s),u.prototype=s===null?Object.create(s):(l.prototype=s.prototype,new l)}),p=this&&this.__read||function(u,s){var l=typeof Symbol=="function"&&u[Symbol.iterator];if(!l)return u;var n,o,e=l.call(u),r=[];try{for(;(s===void 0||0<s--)&&!(n=e.next()).done;)r.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(l=e.return)&&l.call(e)}finally{if(o)throw o.error}}return r},y=this&&this.__spread||function(){for(var u=[],s=0;s<arguments.length;s++)u=u.concat(p(arguments[s]));return u};Object.defineProperty(h,"__esModule",{value:!0});var f=g(1),m=g(0),d=g(6);(function(u){var s,l=(s=d.TopContextUser,x(n,s),Object.defineProperty(n.prototype,"id",{get:function(){return this.store.id},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineIn",{get:function(){return this.contextIn.belongTo},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"view",{get:function(){return this.lineIn.view},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sameLineLabelView",{get:function(){return this.view.labelViewRepository.get(this.store.priorLabel.id)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mayNotSameLineLabelView",{get:function(){return this.view.labelViewRepository.get(this.store.posteriorLabel.id)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fromLabelView",{get:function(){return this.view.labelViewRepository.get(this.store.from.id)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"toLabelView",{get:function(){return this.view.labelViewRepository.get(this.store.to.id)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftLabelView",{get:function(){return this.fromLabelView.labelLeft<this.toLabelView.labelLeft?this.fromLabelView:this.toLabelView},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightLabelView",{get:function(){return this.fromLabelView.labelLeft>=this.toLabelView.labelLeft?this.fromLabelView:this.toLabelView},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"middle",{get:function(){return(this.leftLabelView.labelLeft+this.rightLabelView.labelRight)/2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textWidth",{get:function(){return this.view.connectionFont.widthOf(this.store.category.text)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textLeft",{get:function(){return this.middle-this.textWidth/2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineIncludedWidth",{get:function(){return this.fromLabelView.labelLeft<this.toLabelView.labelLeft?this.toLabelView.labelRight-this.fromLabelView.labelLeft:this.fromLabelView.labelRight-this.toLabelView.labelLeft},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineIncludedLeft",{get:function(){return this.fromLabelView.labelLeft<this.toLabelView.labelLeft?this.fromLabelView.labelLeft:this.toLabelView.labelLeft},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.config.connectionWidthCalcMethod==="text"?this.textWidth:this.lineIncludedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"left",{get:function(){return this.config.connectionWidthCalcMethod==="text"?this.textLeft:this.lineIncludedLeft},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"globalY",{get:function(){return this.lineIn.y-this.layer*this.view.topContextLayerHeight},enumerable:!0,configurable:!0}),n.prototype.render=function(){var t=this;this.svgElement=document.createElementNS(m.SVGNS,"g");var i=this.view.connectionCategoryElementFactoryRepository.get(this.store.category.id).create();return this.svgElement.appendChild(i),this.svgElement.style.cursor="pointer",this.svgElement.onclick=function(a){t.view.root.emit("connectionClicked",t.id,a)},this.svgElement.ondblclick=function(a){t.view.root.emit("connectionDoubleClicked",t.id,a)},this.svgElement.oncontextmenu=function(a){t.view.root.emit("connectionRightClicked",t.id,a),a.preventDefault()},this.svgElement.onmouseenter=function(){t.svgElement.classList.add("hover"),t.lineElement.classList.add("hover")},this.svgElement.onmouseleave=function(){t.svgElement.classList.remove("hover"),t.lineElement.classList.remove("hover")},this.renderLine(),this.svgElement},n.prototype.update=function(){this.svgElement.style.transform="translate("+this.textLeft+"px,"+this.globalY+"px)",this.updateLine()},n.prototype.addHover=function(t){this.svgElement.classList.add("hover-"+t),this.lineElement.classList.add("hover-"+t)},n.prototype.removeHover=function(t){this.svgElement.classList.remove("hover-"+t),this.lineElement.classList.remove("hover-"+t)},n.prototype.remove=function(){this.svgElement.remove(),this.lineElement.remove()},n.prototype.updateLine=function(){var t=this.globalY+this.view.topContextLayerHeight/2-this.view.labelFont.fontSize+2;this.fromLabelView.labelLeft<this.toLabelView.labelLeft?this.lineElement.setAttribute("d",`
                    M `+(this.fromLabelView.labelLeft+1)+"   "+(this.fromLabelView.globalY+1)+`
                    C `+(this.fromLabelView.labelLeft-8)+"  "+t+`,
                      `+(this.fromLabelView.labelLeft-8)+"  "+t+`,
                      `+(this.fromLabelView.labelLeft+1)+"   "+t+`
                    L `+(this.toLabelView.labelLeft+this.toLabelView.labelWidth)+" "+t+`
                    C `+(this.toLabelView.labelLeft+this.toLabelView.labelWidth+8)+"  "+t+`,
                      `+(this.toLabelView.labelLeft+this.toLabelView.labelWidth+8)+"  "+t+`,
                      `+(this.toLabelView.labelLeft+this.toLabelView.labelWidth)+"   "+(this.toLabelView.globalY-1)+`
                `):this.lineElement.setAttribute("d",`
                    M `+(this.fromLabelView.labelRight-1)+"   "+(this.fromLabelView.globalY+1)+`
                    C `+(this.fromLabelView.labelRight+8)+"  "+t+`,
                      `+(this.fromLabelView.labelRight+8)+"  "+t+`,
                      `+(this.fromLabelView.labelRight-1)+"   "+t+`
                    L `+this.toLabelView.labelLeft+"          "+t+`
                    C `+(this.toLabelView.labelLeft-8)+"  "+t+`,
                      `+(this.toLabelView.labelLeft-8)+"  "+t+`,
                      `+this.toLabelView.labelLeft+"   "+(this.toLabelView.globalY-1)+`
                `)},n.prototype.renderLine=function(){var t;this.lineElement=document.createElementNS(m.SVGNS,"path"),(t=this.lineElement.classList).add.apply(t,y(this.config.connectionClasses.map(function(i){return i+"-line"}))),this.lineElement.setAttribute("fill","none"),this.lineElement.style.markerEnd="url(#marker-arrow)",this.updateLine(),this.contextIn.backgroundElement.appendChild(this.lineElement)},n);function n(t,i,a){var c=s.call(this)||this;return c.store=t,c.contextIn=i,c.config=a,c.svgElement=null,c.lineElement=null,c}u.Entity=l;var o,e=(o=f.Base.Repository,x(r,o),r);function r(){return o!==null&&o.apply(this,arguments)||this}u.Repository=e})(h.ConnectionView||(h.ConnectionView={}))},function(E,h,g){var b=this&&this.__read||function(d,u){var s=typeof Symbol=="function"&&d[Symbol.iterator];if(!s)return d;var l,n,o=s.call(d),e=[];try{for(;(u===void 0||0<u--)&&!(l=o.next()).done;)e.push(l.value)}catch(r){n={error:r}}finally{try{l&&!l.done&&(s=o.return)&&s.call(o)}finally{if(n)throw n.error}}return e},x=this&&this.__spread||function(){for(var d=[],u=0;u<arguments.length;u++)d=d.concat(b(arguments[u]));return d};Object.defineProperty(h,"__esModule",{value:!0});var p,y,f=g(0);function m(d,u,s,l,n,o){this.fontFamily=d,this.fontSize=u,this.fontWeight=s,this.lineHeight=l,this.topToBaseLine=n,this.width=o}p=h.Font||(h.Font={}),m.prototype.widthOf=function(d){var u=this;return typeof d=="string"?this.widthOf(Array.from(d)):d.map(function(s){return u.width.get(s)}).reduce(function(s,l){return s+l},0)},y=m,p.ValueObject=y,function(d){function u(n,o,e){var r=new Map,t=new Set(n);t.delete(`
`);var i=Array.from(t);o.textContent=i.join(""),o.parentNode.parentNode.insertBefore(e,o.parentNode),i.forEach(function(C,I){r.set(C,o.getExtentOfChar(I).width)});var a=e.getBoundingClientRect().top-o.getBoundingClientRect().top,c=parseFloat(window.getComputedStyle(o).fontSize),v=window.getComputedStyle(o).fontFamily,w=window.getComputedStyle(o).fontWeight,_=o.getBoundingClientRect().height;return new y(v,c,w,_,a,r)}d.create=u;var s=(l.prototype.thanCreate=function(n,o){var e,r;(e=this.measuringElement.classList).add.apply(e,x(n));var t=u(o,this.measuringElement,this.baseLineReferenceElement);return(r=this.measuringElement.classList).remove.apply(r,x(n)),this.result.push(t),this},l.prototype.endBatch=function(){return this.baseLineReferenceElement.remove(),this.measuringElement.remove(),this.result},l);function l(n,o){this.svgElement=n,this.textElement=o,this.baseLineReferenceElement=document.createElementNS(f.SVGNS,"rect"),this.baseLineReferenceElement.setAttribute("width","1px"),this.baseLineReferenceElement.setAttribute("height","1px"),this.svgElement.appendChild(this.baseLineReferenceElement),this.measuringElement=document.createElementNS(f.SVGNS,"tspan"),this.textElement.appendChild(this.measuringElement),this.result=[]}d.startBatch=function(n,o){return new s(n,o)}}(p.Factory||(p.Factory={})),(p.Service||(p.Service={})).measureMore=function(d,u,s,l){var n,o=new Set(u);o.delete(`
`);var e=Array.from(o).filter(function(t){return!d.width.has(t)});if(0<e.length){var r=document.createElementNS(f.SVGNS,"tspan");(n=r.classList).add.apply(n,x(s)),r.textContent=e.join(""),l.appendChild(r),e.forEach(function(t,i){d.width.set(t,r.getExtentOfChar(i).width)}),r.remove()}return d}},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0});var b=g(13);h.Annotator=b.Annotator;var x=g(27),p=g(28),y=g(29),f={Connection:x.Connection,Label:p.Label,Content:y.Content};h.Action=f},function(E,h,g){var b,x=this&&this.__extends||(b=function(e,r){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var a in i)i.hasOwnProperty(a)&&(t[a]=i[a])})(e,r)},function(e,r){function t(){this.constructor=e}b(e,r),e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)});Object.defineProperty(h,"__esModule",{value:!0});var p,y=g(3),f=g(14),m=g(17),d=g(0),u=g(24),s=g(25),l=g(26),n=(p=y.EventEmitter,x(o,p),o.prototype.applyAction=function(e){e.apply(this.store)},o.prototype.export=function(){this.view.contentEditor.hide();var e=this.view.svgElement.outerHTML.replace(/&nbsp;/," ");return this.view.contentEditor.show(),e},o.prototype.remove=function(){this.view.svgElement.remove(),this.store.config.contentEditable&&this.view.contentEditor.remove()},o);function o(e,r,t){var i=p.call(this)||this;i.containerElement=r,i.configInput=t;var a=u.parseInput(t||{});i.store=new f.Store(a),i.store.json=typeof e=="string"?JSON.parse(e):e;var c=document.createElementNS(d.SVGNS,"svg");return c.setAttribute("xmlns",d.SVGNS),r.appendChild(c),i.view=new m.View(i,c,a),i.textSelectionHandler=new s.TextSelectionHandler(i,a),i.twoLabelsClickedHandler=new l.TwoLabelsClickedHandler(i,a),i}h.Annotator=n},function(E,h,g){var b,x=this&&this.__extends||(b=function(n,o){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(n,o)},function(n,o){function e(){this.constructor=n}b(n,o),n.prototype=o===null?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0});var p,y=g(15),f=g(8),m=g(16),d=g(9),u=g(3),s=(p=u.EventEmitter,x(l,p),Object.defineProperty(l.prototype,"content",{get:function(){return this._content},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"json",{get:function(){return{content:this._content,labelCategories:this.labelCategoryRepo.json,labels:this.labelRepo.json,connectionCategories:this.connectionCategoryRepo.json,connections:this.connectionRepo.json}},set:function(n){var o=this;this._content=n.content.endsWith(`
`)?n.content:n.content+`
`,y.LabelCategory.Factory.createAll(n.labelCategories,this.config).map(function(e){return o.labelCategoryRepo.add(e)}),f.Label.Factory.createAll(n.labels,this).map(function(e){return o.labelRepo.add(e)}),n.connectionCategories.map(function(e){return o.connectionCategoryRepo.add(e)}),d.Connection.Factory.createAll(n.connections,this).map(function(e){return o.connectionRepo.add(e)})},enumerable:!0,configurable:!0}),l.prototype.contentSlice=function(n,o){return this.content.slice(n,o)},l.prototype.moveLabels=function(n,o){Array.from(this.labelRepo.values()).filter(function(e){return e.startIndex>=n}).map(function(e){return e.move(o)})},l.prototype.spliceContent=function(n,o){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];var t=n+o;if(o===0||Array.from(this.labelRepo.values()).find(function(w){return w.startIndex<=n&&n<w.endIndex||w.startIndex<t&&t<w.endIndex})===void 0){var i=this.content.slice(0,n),a=this.content.slice(n,n+o),c=e.join(""),v=this.content.slice(n+o);this._content=i+c+v,this.moveLabels(n+o,c.length-a.length),this.emit("contentSpliced",n,a,c)}},l);function l(n){var o=p.call(this)||this;return o._content="",o.config=n,o.labelCategoryRepo=new y.LabelCategory.Repository,o.labelRepo=new f.Label.Repository(n),o.connectionCategoryRepo=new m.ConnectionCategory.Repository,o.connectionRepo=new d.Connection.Repository(n),o}h.Store=s},function(E,h,g){var b,x=this&&this.__extends||(b=function(n,o){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(n,o)},function(n,o){function e(){this.constructor=n}b(n,o),n.prototype=o===null?Object.create(o):(e.prototype=o.prototype,new e)});Object.defineProperty(h,"__esModule",{value:!0});var p,y,f,m,d=g(1),u=g(5);function s(){return y!==null&&y.apply(this,arguments)||this}function l(n,o){var e=n.borderColor,r=n.color;return!n.borderColor&&n["border-color"]&&(e=n["border-color"]),n.color||(r=o),n.borderColor||(e=u.shadeColor(r,-30)),{id:n.id,text:n.text,color:r,borderColor:e}}p=h.LabelCategory||(h.LabelCategory={}),y=d.Base.Repository,x(s,y),m=s,p.Repository=m,(f=p.Factory||(p.Factory={})).create=l,f.createAll=function(n,o){return n.map(function(e){return l(e,o.defaultLabelColor)})}},function(E,h,g){var b,x=this&&this.__extends||(b=function(u,s){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,n){l.__proto__=n}||function(l,n){for(var o in n)n.hasOwnProperty(o)&&(l[o]=n[o])})(u,s)},function(u,s){function l(){this.constructor=u}b(u,s),u.prototype=s===null?Object.create(s):(l.prototype=s.prototype,new l)});Object.defineProperty(h,"__esModule",{value:!0});var p,y,f,m=g(1);function d(){return y!==null&&y.apply(this,arguments)||this}p=h.ConnectionCategory||(h.ConnectionCategory={}),y=m.Base.Repository,x(d,y),f=d,p.Repository=f},function(E,h,g){var b=this&&this.__read||function(t,i){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var c,v,w=a.call(t),_=[];try{for(;(i===void 0||0<i--)&&!(c=w.next()).done;)_.push(c.value)}catch(C){v={error:C}}finally{try{c&&!c.done&&(a=w.return)&&a.call(w)}finally{if(v)throw v.error}}return _},x=this&&this.__spread||function(){for(var t=[],i=0;i<arguments.length;i++)t=t.concat(b(arguments[i]));return t},p=this&&this.__values||function(t){var i=typeof Symbol=="function"&&Symbol.iterator,a=i&&t[i],c=0;if(a)return a.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&c>=t.length&&(t=void 0),{value:t&&t[c++],done:!t}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var y=g(0),f=g(18),m=g(11),d=g(21),u=g(7),s=g(10),l=g(22),n=g(23),o=g(2),e=(r.layoutTopContextsAfter=function(t){for(;t.next.isSome;)t.topContext.update(),t=t.next.toNullable();t.topContext.update()},r.prototype.constructLabelViewsForLine=function(t){var i=this,a=this.store.labelRepo.getEntitiesInRange(t.startIndex,t.endIndex).map(function(c){return new u.LabelView.Entity(c,t.topContext,i.config)});return a.map(function(c){return i.labelViewRepository.add(c)}),a.map(function(c){return t.topContext.addChild(c)}),a},r.prototype.constructConnectionsForLine=function(t){var i=this;return this.store.labelRepo.getEntitiesInRange(t.startIndex,t.endIndex).map(function(a){var c=a.sameLineConnections.filter(function(v){return!i.connectionViewRepository.has(v.id)}).map(function(v){return new s.ConnectionView.Entity(v,t.topContext,i.config)});return c.map(function(v){return i.connectionViewRepository.add(v)}),c.map(function(v){return t.topContext.addChild(v)}),c}).reduce(function(a,c){return a.concat(c)},[])},Object.defineProperty(r.prototype,"height",{get:function(){var t=this;return this.lines.reduce(function(i,a){return i+a.height+t.contentFont.fontSize*(t.config.lineHeight-1)},20)},enumerable:!0,configurable:!0}),r.createMarkerElement=function(){var t=document.createElementNS(y.SVGNS,"path");t.setAttribute("d","M0,4 L0,8 L6,6 L0,4 L0,8"),t.setAttribute("stroke","#000000"),t.setAttribute("fill","#000000");var i=document.createElementNS(y.SVGNS,"marker");return i.setAttribute("id","marker-arrow"),i.setAttribute("markerWidth","8"),i.setAttribute("markerHeight","10"),i.setAttribute("orient","auto"),i.setAttribute("refX","5"),i.setAttribute("refY","6"),i.appendChild(t),i},r.prototype.contentWidth=function(t,i){return this.contentFont.widthOf(this.store.contentSlice(t,i))},r.prototype.removeLine=function(t){var i=this;t.remove(),t.topContext.children.forEach(function(a){a instanceof u.LabelView.Entity?i.labelViewRepository.delete(a):a instanceof s.ConnectionView.Entity&&i.connectionViewRepository.delete(a)})},r.prototype.registerEventHandlers=function(){var t=this;this.textElement.onmouseup=function(i){window.getSelection().type==="Range"?t.root.textSelectionHandler.textSelected():t.config.contentEditable&&t.contentEditor.caretChanged(i.clientY)},this.store.labelRepo.on("created",this.onLabelCreated.bind(this)),this.store.labelRepo.on("removed",function(i){var a=t.labelViewRepository.get(i.id);a.lineIn.topContext.removeChild(a),a.remove(),t.labelViewRepository.delete(a),a.lineIn.topContext.update(),a.lineIn.update(),r.layoutTopContextsAfter(a.lineIn),t.config.contentEditable&&t.contentEditor.update()}),this.store.connectionRepo.on("created",this.onConnectionCreated.bind(this)),this.store.connectionRepo.on("removed",function(i){var a=t.connectionViewRepository.get(i.id);a.lineIn.topContext.removeChild(a),a.remove(),t.connectionViewRepository.delete(a),a.lineIn.topContext.update(),a.lineIn.update(),r.layoutTopContextsAfter(a.lineIn),t.config.contentEditable&&t.contentEditor.update()}),this.config.contentEditable&&this.store.on("contentSpliced",this.onContentSpliced.bind(this))},r.prototype.rerenderLines=function(t,i){for(var a,c,v,w,_,C,I,O=this.lines[0].svgElement.parentElement,j=t;j<=i;++j)this.removeLine(this.lines[j]);var T=this.lines[t],F=this.lines[i],A=f.Line.Service.divide(this,T.startIndex,F.endIndex);for(A.length!==0&&(A[0].last=T.last,T.last.map(function(P){return P.next=o.some(A[0])}),A[A.length-1].next=F.next,F.next.map(function(P){return P.last=o.some(A[A.length-1])}),(a=this.lines).splice.apply(a,x([t,i-t+1],A)),t===0?F.next.isSome?A[0].insertBefore(F.next):A[0].insertInto(O):A[0].insertAfter(T.last)),j=1;j<A.length;++j)A[j].insertAfter(o.some(A[j-1]));function X(P){$.constructLabelViewsForLine(P).map(function(oe){return P.topContext.renderChild(oe)})}var $=this;try{for(var U=p(A),G=U.next();!G.done;G=U.next())X(Z=G.value)}catch(P){c={error:P}}finally{try{G&&!G.done&&(v=U.return)&&v.call(U)}finally{if(c)throw c.error}}function te(P){ne.constructConnectionsForLine(P).map(function(oe){return P.topContext.renderChild(oe)})}var ne=this;try{for(var W=p(A),Y=W.next();!Y.done;Y=W.next())te(Z=Y.value)}catch(P){w={error:P}}finally{try{Y&&!Y.done&&(_=W.return)&&_.call(W)}finally{if(w)throw w.error}}try{for(var K=p(A),J=K.next();!J.done;J=K.next()){var Z;(Z=J.value).update(),Z.topContext.update()}}catch(P){C={error:P}}finally{try{J&&!J.done&&(I=K.return)&&I.call(K)}finally{if(C)throw C.error}}},r.prototype.onLabelCreated=function(t){var i=b(this.findRangeInLines(t.startIndex,t.endIndex),2),a=i[0];if(i[1]===a+1){var c=this.lines[a],v=new u.LabelView.Entity(t,c.topContext,this.config);this.labelViewRepository.add(v),c.topContext.addChild(v),c.topContext.renderChild(v),c.topContext.update(),c.update()}else{var w=this.findHardLineEndsInIndex(a);this.rerenderLines(a,w)}r.layoutTopContextsAfter(this.lines[a]),this.config.contentEditable&&this.contentEditor.update(),this.svgElement.style.height=this.height.toString()+"px"},r.prototype.findRangeInLines=function(t,i){var a=0,c=0;return this.lines.forEach(function(v,w){v.startIndex<=t&&t<v.endIndex&&(a=w),v.startIndex<=i-1&&i-1<v.endIndex&&(c=w+1)}),[a,c]},r.prototype.onConnectionCreated=function(t){var i=this.labelViewRepository.get(t.priorLabel.id),a=i.lineIn.topContext,c=new s.ConnectionView.Entity(t,a,this.config);this.connectionViewRepository.add(c),a.addChild(c),a.renderChild(c),a.update(),i.lineIn.update(),r.layoutTopContextsAfter(i.lineIn),this.config.contentEditable&&this.contentEditor.update(),this.svgElement.style.height=this.height.toString()+"px"},r.prototype.onContentSpliced=function(t,i,a){i!==""&&this.onRemoved(t,i),a!==""&&this.onInserted(t,a)},r.prototype.onRemoved=function(t,i){var a=b(this.findRangeInLines(t,t+1),2),c=a[0];a[1],this.lines[c].startIndex===t-i.length?this.lines[c].move(-i.length):this.lines[c].inserted(-i.length);for(var v=c+1;v<this.lines.length;)this.lines[v].move(-i.length),++v;var w=this.findHardLineEndsInIndex(c);if(i===`
`&&this.lines[c].isBlank){var _=this.lines[c].last,C=this.lines[c].next;this.lines[c].remove(),this.lines.splice(c,1),_.map(function(O){return O.next=C}),C.map(function(O){return O.last=_})}else this.rerenderLines(c,w);r.layoutTopContextsAfter(this.lines[w-1]);var I=Array.from(i).filter(function(O){return O===`
`}).length;I===0?(this.contentEditor.characterIndex-=i.length,this.contentEditor.avoidInLabel("forward")):0<=this.contentEditor.lineIndex-I&&(this.contentEditor.lineIndex-=I,this.contentEditor.characterIndex=this.contentEditor.line.content.length,this.contentEditor.avoidInLabel("forward")),this.contentEditor.update(),this.svgElement.style.height=this.height.toString()+"px"},r.prototype.onInserted=function(t,i){var a=b(this.findRangeInLines(t,t+1),2),c=a[0];a[1],this.lines[c].startIndex===t+i.length?this.lines[c].move(i.length):this.lines[c].inserted(i.length);for(var v=c+1;v<this.lines.length;)this.lines[v].move(i.length),++v;var w=this.findHardLineEndsInIndex(c);this.rerenderLines(c,w),r.layoutTopContextsAfter(this.lines[w]);var _=Array.from(i),C=_.filter(function(j){return j===`
`}).length,I=_.lastIndexOf(`
`),O=i.length-I;C===0?this.contentEditor.characterIndex+=i.length:(this.contentEditor.lineIndex+=C,this.contentEditor.characterIndex=O-1),this.contentEditor.avoidInLabel("forward"),this.contentEditor.update(),this.svgElement.style.height=this.height.toString()+"px"},r.prototype.findHardLineEndsInIndex=function(t){var i;for(i=t;i<this.lines.length-1&&!this.lines[i].endWithHardLineBreak;++i);return i},r.prototype.collectStyle=function(){var t=document.createElementNS(y.SVGNS,"style"),i=`
        `+this.config.contentClasses.map(function(_){return"."+_}).join(",")+` {
            font-family: `+this.contentFont.fontFamily+`;
            font-weight: `+this.contentFont.fontWeight+`;
            font-size: `+this.contentFont.fontSize+`px;
            line-height: `+this.contentFont.lineHeight+`px;
        }
        `,a=`
        `+this.config.labelClasses.map(function(_){return"."+_}).join(",")+` {
            font-family: `+this.labelFont.fontFamily+`;
            font-weight: `+this.labelFont.fontWeight+`;
            font-size: `+this.labelFont.fontSize+`px;
        }
        `,c=this.config.connectionClasses.map(function(_){return"."+_}).join(","),v=this.config.connectionClasses.map(function(_){return"."+_+"-line"}).join(","),w=`
        `+c+` {
            font-family: `+this.connectionFont.fontFamily+`;
            font-weight: `+this.connectionFont.fontWeight+`;
            font-size: `+this.connectionFont.fontSize+`px;
        }
        `+v+` {
            stroke: #000;
        }
        `;return t.innerHTML=i+a+w,t},Object.defineProperty(r.prototype,"paddingLeft",{get:function(){var t=this;return Math.max.apply(Math,x(Array.from(this.store.labelCategoryRepo.values()).map(function(i){return t.labelFont.widthOf(i.text)})))/2+1},enumerable:!0,configurable:!0}),r);function r(t,i,a){var c,v,w;this.root=t,this.svgElement=i,this.config=a,this.contentEditor=null,this.store=t.store,this.labelViewRepository=new u.LabelView.Repository,this.connectionViewRepository=new s.ConnectionView.Repository,this.markerElement=r.createMarkerElement(),this.svgElement.appendChild(this.markerElement),this.textElement=document.createElementNS(y.SVGNS,"text"),this.textElement.style.whiteSpace="pre",this.textElement.style.wordWrap="normal",this.svgElement.appendChild(this.textElement);var _=Array.from(this.store.labelCategoryRepo.values()).map(function(A){return A.text}).join(""),C=Array.from(this.store.connectionCategoryRepo.values()).map(function(A){return A.text}).join("");c=b(m.Font.Factory.startBatch(i,this.textElement).thanCreate(a.contentClasses,this.store.content).thanCreate(a.labelClasses,_).thanCreate(a.connectionClasses,C).endBatch(),3),this.contentFont=c[0],this.labelFont=c[1],this.connectionFont=c[2];var I=this.labelFont.lineHeight+2+2*a.labelPadding+a.bracketWidth;this.topContextLayerHeight=2*a.topContextMargin+Math.max(I,this.connectionFont.lineHeight),(v=this.textElement.classList).add.apply(v,x(a.contentClasses)),this.labelCategoryElementFactoryRepository=new d.LabelCategoryElement.FactoryRepository(this,a),this.connectionCategoryElementFactoryRepository=new l.ConnectionCategoryElement.FactoryRepository(this,a),this.lineMaxWidth=i.width.baseVal.value-2*this.paddingLeft,this.lines=f.Line.Service.divide(this,0,this.store.content.length),this.lines.map(this.constructLabelViewsForLine.bind(this)),this.lines.map(this.constructConnectionsForLine.bind(this));var O=this.lines.map(function(A){return A.render()});if((w=this.textElement).append.apply(w,x(O)),this.svgElement.style.height=this.height.toString()+"px",this.registerEventHandlers(),this.config.contentEditable){this.contentEditor=new n.ContentEditor(this);var j=b(this.contentEditor.render(),2),T=j[0],F=j[1];this.svgElement.appendChild(T),this.svgElement.parentNode.insertBefore(F,this.svgElement)}this.svgElement.appendChild(this.collectStyle())}h.View=e},function(E,h,g){var b=this&&this.__read||function(d,u){var s=typeof Symbol=="function"&&d[Symbol.iterator];if(!s)return d;var l,n,o=s.call(d),e=[];try{for(;(u===void 0||0<u--)&&!(l=o.next()).done;)e.push(l.value)}catch(r){n={error:r}}finally{try{l&&!l.done&&(s=o.return)&&s.call(o)}finally{if(n)throw n.error}}return e},x=this&&this.__values||function(d){var u=typeof Symbol=="function"&&Symbol.iterator,s=u&&d[u],l=0;if(s)return s.call(d);if(d&&typeof d.length=="number")return{next:function(){return d&&l>=d.length&&(d=void 0),{value:d&&d[l++],done:!d}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var p=g(2),y=g(0),f=g(19),m=g(20);(function(d){var u=(Object.defineProperty(s.prototype,"startIndex",{get:function(){return this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endIndex",{get:function(){return this._endIndex},enumerable:!0,configurable:!0}),s.prototype.move=function(o){this._startIndex+=o,this._endIndex+=o},s.prototype.inserted=function(o){this._endIndex+=o},Object.defineProperty(s.prototype,"dy",{get:function(){return this.last.match(this.view.contentFont.fontSize*this.config.lineHeight,this.view.contentFont.topToBaseLine)+this.topContext.layer*this.view.topContextLayerHeight},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this.topContext.layer*this.view.topContextLayerHeight+this.view.contentFont.fontSize},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"y",{get:function(){var o=this;return m.takeWhile(this.view.lines,function(e){return e!==o}).reduce(function(e,r){return e+r.height+o.view.contentFont.fontSize*(o.config.lineHeight-1)},0)+this.topContext.layer*this.view.topContextLayerHeight},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isBlank",{get:function(){return this.view.store.content.slice(this.startIndex,this.endIndex-1)===""},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"content",{get:function(){return this.endWithHardLineBreak?this.isBlank?"⮐":this.view.store.content.slice(this.startIndex,this.endIndex-1):this.view.store.content.slice(this.startIndex,this.endIndex)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"endWithHardLineBreak",{get:function(){return this.view.store.content[this.endIndex-1]===`
`},enumerable:!0,configurable:!0}),s.prototype.update=function(){this.svgElement.innerHTML=this.content.replace(/ /g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.isBlank&&(this.svgElement.style.fontSize=this.view.contentFont.fontSize/4+"px"),this.svgElement.setAttribute("x",this.view.paddingLeft.toString()),this.svgElement.setAttribute("dy",this.dy.toString()+"px")},s.prototype.render=function(){this.svgElement=document.createElementNS(y.SVGNS,"tspan");var o=b(this.topContext.render(),2),e=o[0],r=o[1];return this.view.svgElement.insertBefore(e,this.view.textElement),this.view.markerElement.insertAdjacentElement("afterend",r),Object.assign(this.svgElement,{annotatorElement:this}),this.update(),this.svgElement},s.prototype.remove=function(){this.topContext.remove(),this.svgElement.remove()},s.prototype.insertBefore=function(o){var e=this;this.render(),o.map(function(r){r.svgElement.parentNode.insertBefore(e.svgElement,r.svgElement),r.topContext.svgElement.parentNode.insertBefore(e.topContext.svgElement,r.topContext.svgElement),r.topContext.backgroundElement.parentNode.insertBefore(e.topContext.backgroundElement,r.topContext.backgroundElement)})},s.prototype.insertAfter=function(o){var e=this;this.render(),o.map(function(r){r.svgElement.insertAdjacentElement("afterend",e.svgElement),r.topContext.svgElement.insertAdjacentElement("afterend",e.topContext.svgElement),r.topContext.backgroundElement.insertAdjacentElement("afterend",e.topContext.backgroundElement)})},s.prototype.insertInto=function(o){this.render(),o.appendChild(this.svgElement)},s);function s(o,e,r,t,i){this.last=r,this.next=t,this.view=i,this.svgElement=null,this._startIndex=o,this._endIndex=e,this.topContext=new f.TopContext(this),this.config=i.config}d.ValueObject=u;var l=(Object.defineProperty(n.prototype,"store",{get:function(){return this.view.store},enumerable:!0,configurable:!0}),n.prototype.divide=function(o,e){var r,t;this.init();var i=o,a=o+1;do{var c=this.mergeLabel(a),v=this.mergeWord(c),w=c===a&&c===v;this.store.content[a-1]===`
`?(this.tokenQueue.length===0?this.reduce(a-1,a):this.reduce(this.tokenQueue[0].startIndex,a),i=a):w&&(this.shiftWithAutoReduce({startIndex:i,endIndex:a}),i=a),++a}while(i<e);function _(j){C.map(function(T){return T.next=p.some(j)}),j.last=C,C=p.some(j)}this.tokenQueue.length!==0&&this.reduce(this.tokenQueue[0].startIndex,this.tokenQueue[this.tokenQueue.length-1].endIndex);var C=p.none;try{for(var I=x(this.result),O=I.next();!O.done;O=I.next())_(O.value)}catch(j){r={error:j}}finally{try{O&&!O.done&&(t=I.return)&&t.call(I)}finally{if(r)throw r.error}}return this.result},n.prototype.init=function(){this.result=[],this.tokenQueue=[]},n.prototype.mergeLabel=function(o){return this.store.labelRepo.getEntitiesCross(o-1).some(function(e){return e.endIndex>o})?this.store.labelRepo.getEntitiesCross(o-1).filter(function(e){return e.endIndex>o}).sort(function(e,r){return r.endIndex-e.endIndex})[0].endIndex:o},n.prototype.mergeWord=function(o){n.wordReg.lastIndex=0;var e=n.wordReg.exec(this.store.contentSlice(o-1,o+1));return e===null?o:e[0].length===2?o+1:o},n.prototype.reduce=function(o,e){var r=new d.ValueObject(o,e,p.none,p.none,this.view);this.result.push(r),this.tokenQueue=[]},n.prototype.shiftWithAutoReduce=function(o){var e=this.tokenQueue.length===0?0:this.view.contentWidth(this.tokenQueue[0].startIndex,this.tokenQueue[this.tokenQueue.length-1].endIndex),r=this.view.contentWidth(o.startIndex,o.endIndex);this.tokenQueue.length!==0&&e+r>this.view.lineMaxWidth&&this.reduce(this.tokenQueue[0].startIndex,this.tokenQueue[this.tokenQueue.length-1].endIndex),r>this.view.lineMaxWidth?(this.reduce(o.startIndex,o.endIndex),console.warn('the token "'+this.store.contentSlice(o.startIndex,o.endIndex)+'" is too long for a line!')):this.tokenQueue.push(o)},n.wordReg=/([a-zA-z][a-zA-Z0-9'’]*[-|.]?)|([+\-]?[0-9.][0-9.%]*)/g,n);function n(o){this.view=o,this.result=[],this.tokenQueue=[]}(d.Service||(d.Service={})).divide=function(o,e,r){return new l(o).divide(e,r)}})(h.Line||(h.Line={}))},function(E,h,g){var b=this&&this.__read||function(n,o){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var r,t,i=e.call(n),a=[];try{for(;(o===void 0||0<o--)&&!(r=i.next()).done;)a.push(r.value)}catch(c){t={error:c}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}return a},x=this&&this.__spread||function(){for(var n=[],o=0;o<arguments.length;o++)n=n.concat(b(arguments[o]));return n},p=this&&this.__values||function(n){var o=typeof Symbol=="function"&&Symbol.iterator,e=o&&n[o],r=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var y=g(0),f=g(6),m=g(10),d=g(4),u=g(7),s=(Object.defineProperty(l.prototype,"layer",{get:function(){return this.children.size===0?0:Math.max.apply(Math,x(Array.from(this.children).map(function(n){return n.layer})))},enumerable:!0,configurable:!0}),l.prototype.update=function(){var n=this;this.children.forEach(function(o){return o.update()}),Array.from(this.children).filter(function(o){return o instanceof u.LabelView.Entity}).map(function(o){o.store.allConnections.forEach(function(e){if(n.belongTo.view.connectionViewRepository.has(e.id)){var r=n.belongTo.view.connectionViewRepository.get(e.id);r.mayNotSameLineLabelView===o&&r.update()}})})},l.prototype.render=function(){var n=this;return this.svgElement=document.createElementNS(y.SVGNS,"g"),this.backgroundElement=document.createElementNS(y.SVGNS,"g"),this.children.forEach(function(o){n.renderChild(o)}),this.update(),[this.svgElement,this.backgroundElement]},l.prototype.addChild=function(n){var o,e,r=this.layer,t=!1;n instanceof m.ConnectionView.Entity&&(n.layer=n.sameLineLabelView.layer);do{++n.layer,t=!1;try{for(var i=(o=void 0,p(this.children)),a=i.next();!a.done;a=i.next()){var c=a.value;if(f.overLaps(n,c)){t=!0;break}}}catch(v){o={error:v}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(o)throw o.error}}}while(t);return this.children.add(n),this.layer-r},l.prototype.renderChild=function(n){d.assert(this.children.has(n));var o=n.render();this.svgElement.appendChild(o)},l.prototype.removeChild=function(n){d.assert(this.children.has(n)),this.children.delete(n)},l.prototype.remove=function(){this.svgElement.remove(),this.backgroundElement.remove()},l);function l(n){this.backgroundElement=null,this.svgElement=null,this.children=new Set,this.belongTo=n}h.TopContext=s},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0});var b=g(2);h.lookup=function(x,p){return x.length<=p?b.none:b.some(x[p])},h.takeWhile=function(x,p){var y;for(y=0;y<x.length&&p(x[y]);++y);return x.slice(0,y)}},function(E,h,g){var b,x=this&&this.__extends||(b=function(e,r){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var a in i)i.hasOwnProperty(a)&&(t[a]=i[a])})(e,r)},function(e,r){function t(){this.constructor=e}b(e,r),e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}),p=this&&this.__values||function(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],i=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var y,f,m,d,u=g(1),s=g(0),l=g(5);function n(e,r,t,i){this.store=e,this.font=r,this.padding=t,this.svgElement=document.createElementNS(s.SVGNS,"g");var a=document.createElementNS(s.SVGNS,"rect");a.setAttribute("fill",/^#/g.test(e.color)?l.addAlpha(e.color,i):e.color),a.setAttribute("stroke",e.borderColor),a.setAttribute("width",this.width.toString()),a.setAttribute("height",(r.lineHeight+2*t).toString()),a.setAttribute("rx",(2*t).toString()),a.style.cursor="pointer";var c=document.createElementNS(s.SVGNS,"text");c.style.userSelect="none",c.style.cursor="pointer",c.textContent=e.text,c.setAttribute("dx",t.toString()),c.setAttribute("dy",r.topToBaseLine+t+"px"),this.svgElement.appendChild(a),this.svgElement.appendChild(c)}function o(e,r){var t,i,a=m.call(this)||this;try{for(var c=p(e.store.labelCategoryRepo.values()),v=c.next();!v.done;v=c.next()){var w=v.value;a.add(new f(w,e.labelFont,r.labelPadding,r.labelOpacity))}}catch(_){t={error:_}}finally{try{v&&!v.done&&(i=c.return)&&i.call(c)}finally{if(t)throw t.error}}return a}y=h.LabelCategoryElement||(h.LabelCategoryElement={}),Object.defineProperty(n.prototype,"width",{get:function(){return this.font.widthOf(this.store.text)+2*this.padding},enumerable:!0,configurable:!0}),n.prototype.create=function(){return this.svgElement.cloneNode(!0)},Object.defineProperty(n.prototype,"id",{get:function(){return this.store.id},enumerable:!0,configurable:!0}),f=n,m=u.Base.Repository,x(o,m),d=o,y.FactoryRepository=d},function(E,h,g){var b,x=this&&this.__extends||(b=function(r,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,a){i.__proto__=a}||function(i,a){for(var c in a)a.hasOwnProperty(c)&&(i[c]=a[c])})(r,t)},function(r,t){function i(){this.constructor=r}b(r,t),r.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}),p=this&&this.__read||function(r,t){var i=typeof Symbol=="function"&&r[Symbol.iterator];if(!i)return r;var a,c,v=i.call(r),w=[];try{for(;(t===void 0||0<t--)&&!(a=v.next()).done;)w.push(a.value)}catch(_){c={error:_}}finally{try{a&&!a.done&&(i=v.return)&&i.call(v)}finally{if(c)throw c.error}}return w},y=this&&this.__spread||function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(p(arguments[t]));return r},f=this&&this.__values||function(r){var t=typeof Symbol=="function"&&Symbol.iterator,i=t&&r[t],a=0;if(i)return i.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&a>=r.length&&(r=void 0),{value:r&&r[a++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var m,d,u,s,l=g(1),n=g(0);function o(r,t,i){var a;this.store=r,this.svgElement=document.createElementNS(n.SVGNS,"g");var c=document.createElementNS(n.SVGNS,"rect");c.setAttribute("fill","#ffffff"),c.setAttribute("width",t.widthOf(r.text).toString()),c.setAttribute("height",t.lineHeight.toString());var v=document.createElementNS(n.SVGNS,"text");(a=v.classList).add.apply(a,y(i)),v.textContent=r.text,v.setAttribute("dy",t.topToBaseLine+"px"),this.svgElement.appendChild(c),this.svgElement.appendChild(v)}function e(r,t){var i,a,c=u.call(this)||this;c.config=t;try{for(var v=f(r.store.connectionCategoryRepo.values()),w=v.next();!w.done;w=v.next()){var _=w.value;u.prototype.add.call(c,new d(_,r.connectionFont,t.connectionClasses))}}catch(C){i={error:C}}finally{try{w&&!w.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}return c}m=h.ConnectionCategoryElement||(h.ConnectionCategoryElement={}),Object.defineProperty(o.prototype,"id",{get:function(){return this.store.id},enumerable:!0,configurable:!0}),o.prototype.create=function(){return this.svgElement.cloneNode(!0)},d=o,u=l.Base.Repository,x(e,u),s=e,m.FactoryRepository=s},function(E,h,g){var b=this&&this.__read||function(u,s){var l=typeof Symbol=="function"&&u[Symbol.iterator];if(!l)return u;var n,o,e=l.call(u),r=[];try{for(;(s===void 0||0<s--)&&!(n=e.next()).done;)r.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(l=e.return)&&l.call(e)}finally{if(o)throw o.error}}return r},x=this&&this.__spread||function(){for(var u=[],s=0;s<arguments.length;s++)u=u.concat(b(arguments[s]));return u};Object.defineProperty(h,"__esModule",{value:!0});var p=g(0),y=g(11),f=g(7),m=(Object.defineProperty(d.prototype,"characterIndex",{get:function(){return this._characterIndex},set:function(u){this.view.lines[this._lineIndex].isBlank?this._characterIndex=0:this._characterIndex=u},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"lineIndex",{get:function(){return this._lineIndex},set:function(u){this._lineIndex=u},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"line",{get:function(){return this.view.lines[this.lineIndex]},enumerable:!0,configurable:!0}),d.prototype.render=function(){var u=this;return this.constructCaretElement(),this.constructHiddenTextAreaElement(),this.parentSVGYOffset=this.view.svgElement.getBoundingClientRect().top-document.getElementsByTagName("html")[0].getBoundingClientRect().top,this.hiddenTextAreaElement.onkeyup=function(s){if(!u.inComposition){switch(s.key){case"ArrowLeft":u.characterIndex===0?u.line.last.isSome&&(--u.lineIndex,u.characterIndex=u.line.content.length):(--u.characterIndex,u.avoidInLabel("backward"));break;case"ArrowRight":u.characterIndex>=u.line.content.length||u.line.isBlank?u.line.next.isSome&&(++u.lineIndex,u.characterIndex=0):(++u.characterIndex,u.avoidInLabel("forward"));break;case"ArrowUp":u.line.last.isSome&&--u.lineIndex,u.characterIndex=Math.min(u.characterIndex,u.line.content.length),u.avoidInLabel("forward");break;case"ArrowDown":u.line.next.isSome&&++u.lineIndex,u.characterIndex=Math.min(u.characterIndex,u.line.content.length),u.avoidInLabel("forward");break;case"Backspace":var l=u.line.startIndex+u.characterIndex-1;u.view.root.emit("contentDelete",l,1);break;default:if(u.hiddenTextAreaElement.value!==""){y.Font.Service.measureMore(u.view.contentFont,u.hiddenTextAreaElement.value,u.view.config.contentClasses,u.view.textElement);var n=u.view.lines[u._lineIndex].startIndex+u.characterIndex;u.view.root.emit("contentInput",n,u.hiddenTextAreaElement.value),u.hiddenTextAreaElement.value=""}}u.update()}},this.hiddenTextAreaElement.addEventListener("compositionstart",function(){u.inComposition=!0}),this.hiddenTextAreaElement.addEventListener("compositionend",function(){u.inComposition=!1}),this.update(),this.hiddenTextAreaElement.style.opacity="0",[this.cursorElement,this.hiddenTextAreaElement]},d.prototype.avoidInLabel=function(u){for(var s=this.line.startIndex+this.characterIndex,l=Array.from(this.line.topContext.children).filter(function(o){return o instanceof f.LabelView.Entity}),n=l.find(function(o){return o.store.startIndex<=s-1&&s<o.store.endIndex});n!==void 0;)u==="forward"?++this.characterIndex:--this.characterIndex,s=this.line.startIndex+this.characterIndex,n=l.find(function(o){return o.store.startIndex<=s-1&&s<o.store.endIndex})},d.prototype.update=function(){var u=this.view.paddingLeft+this.view.contentFont.widthOf(this.line.content.slice(0,this.characterIndex));this.cursorElement.setAttribute("d",`
            M`+u+","+this.line.y+`
            L`+u+","+(this.line.y+this.view.contentFont.lineHeight)+`
        `),this.hiddenTextAreaElement.style.top=this.parentSVGYOffset+this.line.y+"px",this.hiddenTextAreaElement.style.left=this.cursorElement.getBoundingClientRect().left+"px"},d.prototype.caretChanged=function(u){var s=window.getSelection();if(s.type==="Caret"){var l=document.querySelector("svg").getClientRects()[0];if(s.anchorNode.parentNode!==null){var n=s.anchorNode.parentNode.getExtentOfChar(0);if(l.top+n.y+this.view.contentFont.lineHeight<=u){var o=s.anchorNode.parentNode.nextSibling.annotatorElement;this._lineIndex=this.view.lines.indexOf(o),this.characterIndex=0,this.avoidInLabel("forward")}else o=s.anchorNode.parentNode.annotatorElement,this._lineIndex=this.view.lines.indexOf(o),this.characterIndex=s.anchorOffset,this.avoidInLabel("forward");this.update(),this.hiddenTextAreaElement.focus({preventScroll:!0})}}},d.prototype.constructHiddenTextAreaElement=function(){var u;this.hiddenTextAreaElement=document.createElement("textarea"),this.hiddenTextAreaElement.setAttribute("autocorrect","off"),this.hiddenTextAreaElement.setAttribute("autocapitalize","off"),this.hiddenTextAreaElement.setAttribute("spellcheck","false"),(u=this.hiddenTextAreaElement.classList).add.apply(u,x(this.view.config.contentClasses)),this.hiddenTextAreaElement.style.position="absolute",this.hiddenTextAreaElement.style.padding="0",this.hiddenTextAreaElement.style.width="100vw",this.hiddenTextAreaElement.style.height="1em",this.hiddenTextAreaElement.style.outline="none",this.hiddenTextAreaElement.style.zIndex="-1",this.hiddenTextAreaElement.style.borderStyle="none",this.hiddenTextAreaElement.style.fontFamily=this.view.contentFont.fontFamily,this.hiddenTextAreaElement.style.fontSize=this.view.contentFont.fontSize+"px",this.hiddenTextAreaElement.style.fontWeight=this.view.contentFont.fontWeight,this.hiddenTextAreaElement.style.opacity="0"},d.prototype.constructCaretElement=function(){this.cursorElement=document.createElementNS(p.SVGNS,"path"),this.cursorElement.setAttribute("stroke","#000000"),this.cursorElement.setAttribute("stroke-width","1.5"),this.cursorElement.style.animationName="cursor",this.cursorElement.style.animationDuration="0.75s",this.cursorElement.style.animationTimingFunction="ease-out",this.cursorElement.style.animationDirection="alternate",this.cursorElement.style.animationIterationCount="infinite"},d.prototype.hide=function(){this.cursorElement.style.display="none"},d.prototype.show=function(){this.cursorElement.style.display="inline"},d.prototype.remove=function(){this.hiddenTextAreaElement.remove()},d);function d(u){this.view=u,this.cursorElement=null,this.hiddenTextAreaElement=null,this.parentSVGYOffset=null;var s=document.getElementsByTagName("head")[0],l=document.createElement("style");l.innerHTML="@keyframes cursor { from { opacity: 0; } to { opacity: 1; }  }",s.appendChild(l),this._lineIndex=0,this._characterIndex=0,this.inComposition=!1}h.ContentEditor=m},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0});var b={contentClasses:["poplar-annotation-content"],labelClasses:["poplar-annotation-label"],connectionClasses:["poplar-annotation-connection"],labelPadding:2,lineHeight:1.5,topContextMargin:3,bracketWidth:8,allowMultipleLabel:"differentCategory",allowMultipleConnection:"differentCategory",labelWidthCalcMethod:"max",connectionWidthCalcMethod:"line",labelOpacity:90,defaultLabelColor:"#ff9d61",selectingAreaStrip:/[\n ]/,unconnectedLineStyle:"curve",contentEditable:!0};h.parseInput=function(x){var p={};for(var y in b)p[y]=x[y]!==void 0?x[y]:b[y];return p}},function(E,h,g){var b=this&&this.__read||function(m,d){var u=typeof Symbol=="function"&&m[Symbol.iterator];if(!u)return m;var s,l,n=u.call(m),o=[];try{for(;(d===void 0||0<d--)&&!(s=n.next()).done;)o.push(s.value)}catch(e){l={error:e}}finally{try{s&&!s.done&&(u=n.return)&&u.call(n)}finally{if(l)throw l.error}}return o};Object.defineProperty(h,"__esModule",{value:!0});var x=g(2),p=g(4),y=(f.prototype.getSelectionInfo=function(){var m,d=this,u=window.getSelection();p.assert(u.type==="Range");var s,l,n,o,e=null,r=null;try{e=u.anchorNode.parentNode,r=u.focusNode.parentNode}catch{return null}try{if(s=e.annotatorElement,l=r.annotatorElement,s.view!==this.root.view||l.view!==this.root.view)return null;n=s.startIndex+u.anchorOffset,o=l.startIndex+u.focusOffset}catch{return null}return o<n&&(m=b([o,n],2),n=m[0],o=m[1]),x.fromNullable(this.config.selectingAreaStrip).map(function(t){for(;t.test(d.root.store.content[n]);)++n;for(;t.test(d.root.store.content[o-1]);)--o}),o<=n?null:{startIndex:n,endIndex:o}},f.prototype.textSelected=function(){var m,d=this.getSelectionInfo();d&&this.root.emit("textSelected",d.startIndex,d.endIndex),(m=window.getSelection())===null||m===void 0||m.removeAllRanges()},f);function f(m,d){this.root=m,this.config=d}h.TextSelectionHandler=y},function(E,h,g){var b=this&&this.__read||function(m,d){var u=typeof Symbol=="function"&&m[Symbol.iterator];if(!u)return m;var s,l,n=u.call(m),o=[];try{for(;(d===void 0||0<d--)&&!(s=n.next()).done;)o.push(s.value)}catch(e){l={error:e}}finally{try{s&&!s.done&&(u=n.return)&&u.call(n)}finally{if(l)throw l.error}}return o},x=this&&this.__spread||function(){for(var m=[],d=0;d<arguments.length;d++)m=m.concat(b(arguments[d]));return m};Object.defineProperty(h,"__esModule",{value:!0});function p(m,d){var u,s=this;this.root=m,this.config=d,this.lastSelection=f.none,this.svgElement=document.createElementNS(y.SVGNS,"path"),(u=this.svgElement.classList).add.apply(u,x(m.view.config.connectionClasses.map(function(l){return l+"-line"}))),this.svgElement.setAttribute("fill","none"),this.svgElement.style.markerEnd="url(#marker-arrow)",this.root.on("labelClicked",function(l){s.lastSelection.isSome?(s.root.emit("twoLabelsClicked",s.lastSelection.toNullable().id,l),s.svgElement.remove(),s.svgElement.setAttribute("d",""),s.lastSelection=f.none):(s.lastSelection=f.some(s.root.view.labelViewRepository.get(l)),s.root.view.svgElement.insertBefore(s.svgElement,s.root.view.svgElement.firstChild))}),this.root.view.svgElement.onmousemove=function(l){s.lastSelection.map(function(n){var o=n.labelLeft+1,e=n.labelRight-1,r=n.globalY+1,t=l.clientX-s.root.view.svgElement.getBoundingClientRect().left,i=l.clientY-s.root.view.svgElement.getBoundingClientRect().top,a=(o+e)/2<t?o:e;if(d.unconnectedLineStyle==="straight")s.svgElement.setAttribute("d",`
                    M`+a+","+r+`
                    L`+t+","+i+`
                `);else if(d.unconnectedLineStyle==="curve"){var c=(o-t)/4,v=Math.min(r,i)-20;s.svgElement.setAttribute("d",`
                        M`+a+","+r+`
                        C`+(a-c)+","+v+","+(t+c)+","+v+","+t+","+i+`
                    `)}})},this.root.view.svgElement.oncontextmenu=function(l){s.lastSelection.map(function(){s.svgElement.remove(),s.svgElement.setAttribute("d",""),s.lastSelection=f.none,l.preventDefault()})}}var y=g(0),f=g(2);h.TwoLabelsClickedHandler=p},function(E,h,g){Object.defineProperty(h,"__esModule",{value:!0});var b=g(9);(function(x){var p=(y.prototype.apply=function(l){l.connectionRepo.add(new b.Connection.Entity(null,this.categoryId,this.fromId,this.toId,l))},y);function y(l,n,o){this.categoryId=l,this.fromId=n,this.toId=o}x.CreateConnectionAction=p,x.Create=function(l,n,o){return new p(l,n,o)};var f=(m.prototype.apply=function(l){l.connectionRepo.delete(this.id)},m);function m(l){this.id=l}function d(l){return new f(l)}x.DeleteConnectionAction=f,x.Delete=d;var u=(s.prototype.apply=function(l){var n=l.connectionRepo.get(this.connectionId);d(this.connectionId).apply(l),l.connectionRepo.add(new b.Connection.Entity(this.connectionId,this.categoryId,n.fromId,n.toId,l))},s);function s(l,n){this.connectionId=l,this.categoryId=n}x.UpdateConnectionAction=u,x.Update=function(l,n){return new u(l,n)}})(h.Connection||(h.Connection={}))},function(E,h,g){var b=this&&this.__values||function(p){var y=typeof Symbol=="function"&&Symbol.iterator,f=y&&p[y],m=0;if(f)return f.call(p);if(p&&typeof p.length=="number")return{next:function(){return p&&m>=p.length&&(p=void 0),{value:p&&p[m++],done:!p}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(h,"__esModule",{value:!0});var x=g(8);(function(p){var y=(f.prototype.apply=function(n){if(n.content.slice(this.startIndex,this.endIndex).includes(`
`))throw Error("Insert label across hard line is not supported now! Please remove the \\n in content first!");n.labelRepo.add(new x.Label.Entity(null,this.categoryId,this.startIndex,this.endIndex,n))},f);function f(n,o,e){this.categoryId=n,this.startIndex=o,this.endIndex=e}p.CreateLabelAction=y,p.Create=function(n,o,e){return new y(n,o,e)};var m=(d.prototype.apply=function(n){var o,e;try{for(var r=b(n.labelRepo.get(this.id).allConnections),t=r.next();!t.done;t=r.next()){var i=t.value;n.connectionRepo.delete(i)}}catch(a){o={error:a}}finally{try{t&&!t.done&&(e=r.return)&&e.call(r)}finally{if(o)throw o.error}}n.labelRepo.delete(this.id)},d);function d(n){this.id=n}function u(n){return new m(n)}p.DeleteLabelAction=m,p.Delete=u;var s=(l.prototype.apply=function(n){var o=n.labelRepo.get(this.labelId),e=o.allConnections;u(this.labelId).apply(n),n.labelRepo.add(new x.Label.Entity(this.labelId,this.categoryId,o.startIndex,o.endIndex,n)),e.forEach(function(r){return n.connectionRepo.add(r)})},l);function l(n,o){this.labelId=n,this.categoryId=o}p.UpdateLabelAction=s,p.Update=function(n,o){return new s(n,o)}})(h.Label||(h.Label={}))},function(E,h,g){var b,x;function p(y,f,m){this.startIndex=y,this.removeLength=f,this.insert=m}Object.defineProperty(h,"__esModule",{value:!0}),b=h.Content||(h.Content={}),p.prototype.apply=function(y){if(!y.config.contentEditable)throw Error("Content edition is not on!");y.spliceContent(this.startIndex,this.removeLength,this.insert)},x=p,b.SpliceAction=x,b.Splice=function(y,f,m){return new x(y,f,m)}}],S.c=R,S.d=function(E,h,g){S.o(E,h)||Object.defineProperty(E,h,{enumerable:!0,get:g})},S.r=function(E){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(E,"__esModule",{value:!0})},S.t=function(E,h){if(1&h&&(E=S(E)),8&h||4&h&&typeof E=="object"&&E&&E.__esModule)return E;var g=Object.create(null);if(S.r(g),Object.defineProperty(g,"default",{enumerable:!0,value:E}),2&h&&typeof E!="string")for(var b in E)S.d(g,b,(function(x){return E[x]}).bind(null,b));return g},S.n=function(E){var h=E&&E.__esModule?function(){return E.default}:function(){return E};return S.d(h,"a",h),h},S.o=function(E,h){return Object.prototype.hasOwnProperty.call(E,h)},S.p="",S(S.s=12);function S(E){if(R[E])return R[E].exports;var h=R[E]={i:E,l:!1,exports:{}};return V[E].call(h.exports,h,h.exports,S),h.l=!0,h.exports}var V,R})}(re)),re.exports}var z=je();const Re=ie({__name:"index",props:de({LabelCategorys:{}},{visible:{default:!1},visibleModifiers:{}}),emits:de(["updateLable"],["update:visible"]),setup(H,{emit:L}){const S=L,V=ge(H,"visible"),R=D(),E=()=>{R.value!==null&&S("updateLable",R.value),R.value=void 0};return be(()=>{console.log(H.LabelCategorys)}),(h,g)=>{const b=me,x=ve,p=ye;return B(),Q("div",null,[k(p,{title:"选择分类",modelValue:V.value,"onUpdate:modelValue":g[1]||(g[1]=y=>V.value=y),width:"240"},{default:N(()=>[k(x,{modelValue:R.value,"onUpdate:modelValue":g[0]||(g[0]=y=>R.value=y),placeholder:"请选择",onChange:E},{default:N(()=>[(B(!0),Q(le,null,ae(h.LabelCategorys,y=>(B(),se(b,{key:y.id,label:y.text,value:y.id},{default:N(()=>[M("span",{class:"w-3 h-3 mr-1 inline-block",style:xe({backgroundColor:y.color})},null,4),M("span",null,ue(y.text),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),Ve=ce(Re,[["__scopeId","data-v-291685b6"]]),Pe=ie({__name:"index",props:{visible:{type:Boolean,default:()=>!1},connectionCategories:{}},emits:["update:visible","updateConnection"],setup(H,{emit:L}){const S=H,V=L,R=ee({get(){return S.visible},set(g){V("update:visible",g)}}),E=D(),h=()=>{E.value!==null&&V("updateConnection",E.value),E.value=void 0};return(g,b)=>{const x=we("Link"),p=Ce,y=me,f=ve,m=ye;return B(),Q("div",null,[k(m,{title:"选择关系",modelValue:R.value,"onUpdate:modelValue":b[1]||(b[1]=d=>R.value=d),width:"300"},{default:N(()=>[k(f,{modelValue:E.value,"onUpdate:modelValue":b[0]||(b[0]=d=>E.value=d),placeholder:"请选择",onChange:h},{default:N(()=>[(B(!0),Q(le,null,ae(g.connectionCategories,d=>(B(),se(y,{key:d.id,label:d.text,value:d.id},{default:N(()=>[k(p,{color:"#fb9776",size:"16",class:"mr-1 translate-y-[2px]"},{default:N(()=>[k(x)]),_:1}),M("span",null,ue(d.text),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}}),ke=ce(Pe,[["__scopeId","data-v-c44b241c"]]),Me={class:"h-full"},Ne={class:"p-5"},Te={class:"flex"},Fe={class:"editor w-1/2"},We={class:"ml-5 w-1/2"},Be={class:"dark:border-dark-border mb-3 rounded border border-[#dedede] px-2 py-3"},He={class:"mt-4 flex items-center"},Ge=ie({__name:"index",setup(H){const L=D(null),S=D(""),V=D(0),R=D(!1),E=D(!1),h=Ee({startIndex:-1,endIndex:-1,selectedId:-1,sourceId:-1,targetId:-1}),g={topContextMargin:0,connectionWidthCalcMethod:"line",unconnectedLineStyle:"curve",labelWidthCalcMethod:"label"},b=()=>{const s={content:S.value,labelCategories:[{id:0,text:"地方",color:"#fae88e",borderColor:"#dfc33a"},{id:1,text:"动物",color:"#cdec90",borderColor:"#98d918"},{id:2,text:"动作",color:"#7da1ed",borderColor:"#265ac9"}],labels:[{id:0,categoryId:0,startIndex:0,endIndex:2},{id:1,categoryId:1,startIndex:8,endIndex:9},{id:2,categoryId:2,startIndex:23,endIndex:24}],connectionCategories:[{id:0,text:"关系1"},{id:1,text:"关系2"}],connections:[{id:0,categoryId:0,fromId:0,toId:1},{id:1,categoryId:1,fromId:1,toId:2}]},l=document.getElementById("example");L.value&&L.value.remove(),L.value=new z.Annotator(s,l,g),L.value.on("textSelected",(n,o)=>{h.startIndex=n,h.endIndex=o,R.value=!0,V.value=0}),L.value.on("labelRightClicked",n=>{L.value.applyAction(z.Action.Label.Delete(n))}),L.value.on("labelDoubleClicked",n=>{V.value=1,h.selectedId=n,R.value=!0}),L.value.on("twoLabelsClicked",(n,o)=>{n!==o&&(h.sourceId=n,h.targetId=o,V.value=0,E.value=!0)}),L.value.on("connectionDoubleClicked",n=>{h.selectedId=n,V.value=1,E.value=!0}),L.value.on("connectionRightClicked",n=>{L.value.applyAction(z.Action.Connection.Delete(n))})},x=s=>{V.value===0?L.value.applyAction(z.Action.Label.Create(s,h.startIndex,h.endIndex)):L.value.applyAction(z.Action.Label.Update(h.selectedId,s)),R.value=!1},p=s=>{V.value===0?L.value.applyAction(z.Action.Connection.Create(s,h.sourceId,h.targetId)):L.value.applyAction(z.Action.Connection.Update(h.selectedId,s)),E.value=!1},y=()=>{const s=document.createElement("a");s.download="data.json",s.style.display="none";const l=new Blob([JSON.stringify(L.value.store.json,null,4)]);s.href=URL.createObjectURL(l),document.body.appendChild(s),s.click(),document.body.removeChild(s)},f=()=>{const s=document.createElement("a");s.download="data.svg",s.style.display="none";const l=new Blob([L.value.export()]);s.href=URL.createObjectURL(l),document.body.appendChild(s),s.click(),document.body.removeChild(s)},m=ee(()=>{if(L.value===null)return[];const s=[];for(const[l,n]of L.value.store.labelCategoryRepo)s.push(n);return s}),d=ee(()=>{if(L.value===null)return[];const s=[];for(const[l,n]of L.value.store.connectionCategoryRepo)s.push(n);return s}),u=ee(()=>{if(L.value===null)return[];const s=[],l=[];for(const[o,e]of L.value.store.labelCategoryRepo)l.push(e);for(const[o,e]of L.value.store.labelRepo)s.push(e.json);const n=s.reduce((o,e)=>(o.set(e.categoryId,(o.get(e.categoryId)||0)+1),o),new Map);return l.forEach(o=>{const e=o.id;n.has(e)&&(o.num=n.get(e))}),l});return _e(()=>{S.value="北冥有鱼，其名为鲲。 鲲之大，不知其几千里也；化而为鸟，其名为鹏。鹏之背，不知其几千里也；怒而飞，其翼若垂天之云。是鸟也，海运则将徙于南冥。南冥者，天池也。《齐谐》者，志怪者也。《谐》之言曰：“鹏之徙于南冥也，水击三千里，抟扶摇而上者九万里，去以六月息者也。”野马也，尘埃也，生物之以息相吹也。天之苍苍，其正色邪？其远而无所至极邪？其视下也，亦若是则已矣。"}),(s,l)=>{const n=Le,o=Ie,e=Se,r=Oe,t=Ae;return B(),Q("div",Me,[l[10]||(l[10]=M("h2",{class:"title w-full"},"文本标注",-1)),M("div",Ne,[k(n,{href:"https://github.com/synyi/poplar/blob/master/doc/zh.md",target:"_blank"},{default:N(()=>l[3]||(l[3]=[q("Poplar-annotator")])),_:1}),M("div",Te,[M("div",Fe,[l[5]||(l[5]=M("h4",{class:"my-1"},"文本输入",-1)),k(o,{modelValue:S.value,"onUpdate:modelValue":l[0]||(l[0]=i=>S.value=i),type:"textarea",resize:"none",rows:10,placeholder:""},null,8,["modelValue"]),k(e,{class:"mt-[10px]",type:"primary",onClick:b},{default:N(()=>l[4]||(l[4]=[q("抽取")])),_:1})]),M("div",We,[l[8]||(l[8]=M("h4",{class:"my-1"},"文本标注",-1)),M("div",Be,[(B(!0),Q(le,null,ae(u.value,i=>(B(),se(t,{key:i.id,value:i.num,class:"item mr-4",type:"warning"},{default:N(()=>[k(r,{hit:!0,color:i.color},{default:N(()=>[q(ue(i.text),1)]),_:2},1032,["color"])]),_:2},1032,["value"]))),128))]),l[9]||(l[9]=M("div",{id:"example",class:"dark:border-dark-border h-[300px] overflow-hidden rounded border border-[#dedede]"},null,-1)),M("div",He,[he(k(e,{type:"primary",onClick:y},{default:N(()=>l[6]||(l[6]=[q("导出JSON")])),_:1},512),[[fe,L.value]]),he(k(e,{type:"primary",onClick:f},{default:N(()=>l[7]||(l[7]=[q("导出SVG")])),_:1},512),[[fe,L.value]])])])])]),k(Ve,{visible:R.value,"onUpdate:visible":l[1]||(l[1]=i=>R.value=i),LabelCategorys:m.value,onUpdateLable:x},null,8,["visible","LabelCategorys"]),k(ke,{visible:E.value,"onUpdate:visible":l[2]||(l[2]=i=>E.value=i),connectionCategories:d.value,onUpdateConnection:p},null,8,["visible","connectionCategories"])])}}}),nt=ce(Ge,[["__scopeId","data-v-a33f485d"]]);export{nt as default};
