/* empty css             *//* empty css                  */import{x as R,aX as w,az as B,r as p,S as I,y as b,z as g,V,A as x,P as A,O as D,a6 as $,H,L as P,M as U}from"./core-DwZ6MPRT.js";import{_ as z}from"./main-Dcl6G1la.js";import{m as K}from"./ui-BeUbgTob.js";const q=R({__name:"editor",props:{matchList:{default:[]},matchListModifiers:{}},emits:w(["updateMatchList"],["update:matchList"]),setup(C,{expose:f,emit:c}){const i=c,u=B(C,"matchList"),l=p(null),s=p(!1),t=p(null),v=()=>{s.value=!0},d=r=>{s.value=!1,t.value!==null&&(clearTimeout(t.value),t.value=null),t.value=setTimeout(()=>{l.value&&(E(),u.value.forEach(n=>{k(n.matchLabel)})),t.value=null},0)},h=r=>{r.preventDefault()},M=r=>{r.preventDefault()},E=()=>{l.value.innerHTML=""},k=r=>{var N;const n=l.value;if(!n)return;const a=window.getSelection();(a==null?void 0:a.rangeCount)===0&&n.focus();let e=a==null?void 0:a.getRangeAt(0);if(!e||!n.contains(e.startContainer)){n.focus();const m=document.createRange();m.selectNodeContents(n),m.collapse(!1),e=m}const o=document.createElement("div");o.className="matchItem",o.contentEditable="false",o.innerHTML="".concat(r," <span>x</span>"),o.dataset.character=r,(N=o.querySelector("span"))==null||N.addEventListener("click",m=>{m.stopPropagation();const T=o.dataset.character,S=u.value.findIndex(y=>y.matchLabel===T);S!==-1&&u.value.splice(S,1),i("updateMatchList")}),e.deleteContents();const _=document.createTextNode("​");e.insertNode(_),e.setStartAfter(_),e.setEndAfter(_),e.insertNode(o),e.setStartAfter(o),e.setEndAfter(o);const L=document.createTextNode("​");e.insertNode(L),e.setStartAfter(L),e.setEndAfter(L),a==null||a.removeAllRanges(),a==null||a.addRange(e)};return I(()=>{t.value!==null&&clearTimeout(t.value)}),f({insertMatch:k,clearValue:E}),(r,n)=>(g(),b("div",{ref_key:"inputBoxRef",ref:l,contenteditable:"true",id:"editor-box",placeholder:"请插入",class:"dark:!border-dark-border","on:beforeInput":M,onPaste:n[0]||(n[0]=V(()=>{},["prevent"])),onCompositionstart:v,onCompositionend:d,onKeydown:h},null,544))}}),F=z(q,[["__scopeId","data-v-cb66bb5c"]]),O={class:"h-full"},X={class:"w-1/2 p-5"},j={class:"mb-5"},Z=R({__name:"index",setup(C){const f=["香蕉","西瓜","葡萄","荔枝","橘子"],c=p([]),i=p(),u=s=>{c.value.push({matchLabel:s}),i.value.insertMatch(s)},l=()=>{i.value.clearValue(),c.value.forEach(s=>{i.value.insertMatch(s.matchLabel)})};return(s,t)=>{const v=K;return g(),b("div",O,[t[1]||(t[1]=x("h2",{class:"title"},"contenteditable div 应用",-1)),x("div",X,[x("div",j,[(g(),b(D,null,$(f,(d,h)=>A(v,{onClick:M=>u(d),key:h},{default:H(()=>[P(U(d),1)]),_:2},1032,["onClick"])),64))]),A(F,{ref_key:"editorRef",ref:i,matchList:c.value,"onUpdate:matchList":t[0]||(t[0]=d=>c.value=d),onUpdateMatchList:l},null,8,["matchList"])])])}}});export{Z as default};
