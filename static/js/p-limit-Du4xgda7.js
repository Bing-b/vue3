var P=Object.defineProperty;var N=t=>{throw TypeError(t)};var T=(t,e,s)=>e in t?P(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var b=(t,e,s)=>T(t,typeof e!="symbol"?e+"":e,s),g=(t,e,s)=>e.has(t)||N("Cannot "+s);var u=(t,e,s)=>(g(t,e,"read from private field"),s?s.call(t):e.get(t)),v=(t,e,s)=>e.has(t)?N("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,s),a=(t,e,s,r)=>(g(t,e,"write to private field"),r?r.call(t,s):e.set(t,s),s);var w=(t,e,s,r)=>({set _(o){a(t,e,o,s)},get _(){return u(t,e,r)}});/* empty css             *//* empty css                  */import{m as y}from"./ui-BeUbgTob.js";import{x as z,r as C,y as I,z as k,A as m,P as E,H as V,L as B}from"./core-DwZ6MPRT.js";class L{constructor(e){b(this,"value");b(this,"next");this.value=e}}var i,d,c;class H{constructor(){v(this,i);v(this,d);v(this,c);this.clear()}enqueue(e){const s=new L(e);u(this,i)?(u(this,d).next=s,a(this,d,s)):(a(this,i,s),a(this,d,s)),w(this,c)._++}dequeue(){const e=u(this,i);if(e)return a(this,i,u(this,i).next),w(this,c)._--,e.value}peek(){if(u(this,i))return u(this,i).value}clear(){a(this,i,void 0),a(this,d,void 0),a(this,c,0)}get size(){return u(this,c)}*[Symbol.iterator](){let e=u(this,i);for(;e;)yield e.value,e=e.next}}i=new WeakMap,d=new WeakMap,c=new WeakMap;function M(t){q(t);const e=new H;let s=0;const r=()=>{s<t&&e.size>0&&(e.dequeue()(),s++)},o=()=>{s--,r()},n=async(l,p,f)=>{const h=(async()=>l(...f))();p(h);try{await h}catch(S){}o()},x=(l,p,f)=>{new Promise(h=>{e.enqueue(h)}).then(n.bind(void 0,l,p,f)),(async()=>(await Promise.resolve(),s<t&&r()))()},_=(l,...p)=>new Promise(f=>{x(l,f,p)});return Object.defineProperties(_,{activeCount:{get:()=>s},pendingCount:{get:()=>e.size},clearQueue:{value(){e.clear()}},concurrency:{get:()=>t,set(l){q(l),t=l,queueMicrotask(()=>{for(;s<t&&e.size>0;)r()})}}}),_}function q(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}const F={class:"flex gap-5"},O={class:"border border-[#777777] p-5"},Q=["innerHTML"],D=z({__name:"p-limit",setup(t){const e=C(""),s=o=>new Promise(n=>{e.value="".concat(e.value,"<br/>").concat(o),setTimeout(()=>{n(o)},2e3)}),r=async()=>{const o=M(1),n=[o(()=>s("foo")),o(()=>s("bar")),o(()=>s("s"))];await Promise.all(n)};return(o,n)=>{const x=y;return k(),I("div",F,[m("div",null,[n[1]||(n[1]=m("p",null,"p-limit 模拟并发请求发送",-1)),n[2]||(n[2]=m("p",null,"三个请求 一个一个执行",-1)),E(x,{type:"primary",onClick:r},{default:V(()=>n[0]||(n[0]=[B("发送")])),_:1})]),m("div",O,[n[3]||(n[3]=m("p",null,"请求结果打印：",-1)),m("div",{innerHTML:e.value},null,8,Q)])])}}});export{D as default};
