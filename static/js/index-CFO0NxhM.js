/* empty css             *//* empty css                  */import{x as A,aX as y,az as w,r as m,S as B,y as b,z as g,V as I,A as x,P as S,O as V,a6 as D,H as $,L as H,M as P}from"./core-BfEwNXui.js";import{_ as U}from"./main-BKNTB96G.js";import{m as z}from"./ui-B3K06Owz.js";const K=A({__name:"editor",props:{matchList:{default:[]},matchListModifiers:{}},emits:y(["updateMatchList"],["update:matchList"]),setup(C,{expose:f,emit:c}){const r=c,d=w(C,"matchList"),i=m(null),o=m(!1),t=m(null),v=()=>{o.value=!0},l=s=>{o.value=!1,t.value!==null&&(clearTimeout(t.value),t.value=null),t.value=setTimeout(()=>{i.value&&(E(),d.value.forEach(a=>{k(a.matchLabel)})),t.value=null},0)},h=s=>{s.preventDefault()},M=s=>{s.preventDefault()},E=()=>{i.value.innerHTML=""},k=s=>{const a=i.value;if(!a)return;const p=window.getSelection();p?.rangeCount===0&&a.focus();let e=p?.getRangeAt(0);if(!e||!a.contains(e.startContainer)){a.focus();const u=document.createRange();u.selectNodeContents(a),u.collapse(!1),e=u}const n=document.createElement("div");n.className="matchItem",n.contentEditable="false",n.innerHTML=`${s} <span>x</span>`,n.dataset.character=s,n.querySelector("span")?.addEventListener("click",u=>{u.stopPropagation();const R=n.dataset.character,N=d.value.findIndex(T=>T.matchLabel===R);N!==-1&&d.value.splice(N,1),r("updateMatchList")}),e.deleteContents();const _=document.createTextNode("​");e.insertNode(_),e.setStartAfter(_),e.setEndAfter(_),e.insertNode(n),e.setStartAfter(n),e.setEndAfter(n);const L=document.createTextNode("​");e.insertNode(L),e.setStartAfter(L),e.setEndAfter(L),p?.removeAllRanges(),p?.addRange(e)};return B(()=>{t.value!==null&&clearTimeout(t.value)}),f({insertMatch:k,clearValue:E}),(s,a)=>(g(),b("div",{ref_key:"inputBoxRef",ref:i,contenteditable:"true",id:"editor-box",placeholder:"请插入",class:"dark:!border-dark-border","on:beforeInput":M,onPaste:a[0]||(a[0]=I(()=>{},["prevent"])),onCompositionstart:v,onCompositionend:l,onKeydown:h},null,544))}}),q=U(K,[["__scopeId","data-v-cb66bb5c"]]),F={class:"h-full"},O={class:"w-1/2 p-5"},X={class:"mb-5"},Y=A({__name:"index",setup(C){const f=["香蕉","西瓜","葡萄","荔枝","橘子"],c=m([]),r=m(),d=o=>{c.value.push({matchLabel:o}),r.value.insertMatch(o)},i=()=>{r.value.clearValue(),c.value.forEach(o=>{r.value.insertMatch(o.matchLabel)})};return(o,t)=>{const v=z;return g(),b("div",F,[t[1]||(t[1]=x("h2",{class:"title"},"contenteditable div 应用",-1)),x("div",O,[x("div",X,[(g(),b(V,null,D(f,(l,h)=>S(v,{onClick:M=>d(l),key:h},{default:$(()=>[H(P(l),1)]),_:2},1032,["onClick"])),64))]),S(q,{ref_key:"editorRef",ref:r,matchList:c.value,"onUpdate:matchList":t[0]||(t[0]=l=>c.value=l),onUpdateMatchList:i},null,8,["matchList"])])])}}});export{Y as default};
