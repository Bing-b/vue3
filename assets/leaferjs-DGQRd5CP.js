import{$n as e,At as t,Bt as n,Ht as r,Ot as i,S as a,Vt as o,_n as s,an as c,ct as l,hn as u,qn as d,wt as f,x as p,xt as m}from"./index-Ug8tEEVv.js";/* empty css            *//* empty css            */var h;(function(e){e[e.No=0]=`No`,e[e.Yes=1]=`Yes`,e[e.NoAndSkip=2]=`NoAndSkip`,e[e.YesAndSkip=3]=`YesAndSkip`})(h||={});var g={};function _(e){return e===void 0}function v(e){return e==null}function y(e){return typeof e==`string`}var{isFinite:b}=Number;function x(e){return typeof e==`number`}var{isArray:S}=Array;function C(e){return e&&typeof e==`object`}function ee(e){return JSON.stringify(e)===`{}`}var w={default:(e,t)=>(te(t,e),te(e,t),e),assign(e,t,n){let r;Object.keys(t).forEach(i=>{if(r=t[i],r?.constructor===Object&&e[i]?.constructor===Object)return te(e[i],t[i],n&&n[i]);n&&i in n?n[i]?.constructor===Object&&te(e[i]={},t[i],n[i]):e[i]=t[i]})},copyAttrs:(e,t,n)=>(n.forEach(n=>{_(t[n])||(e[n]=t[n])}),e),clone:e=>JSON.parse(JSON.stringify(e)),toMap(e){let t={};for(let n=0,r=e.length;n<r;n++)t[e[n]]=!0;return t},stintSet(e,t,n){n||=void 0,e[t]!==n&&(e[t]=n)}},{assign:te}=w,ne=class{get __useNaturalRatio(){return!0}get __isLinePath(){let{path:e}=this;return e&&e.length===6&&e[0]===1}get __usePathBox(){return this.__pathInputed}get __blendMode(){if(this.eraser&&this.eraser!==`path`)return`destination-out`;let{blendMode:e}=this;return e===`pass-through`?null:e}constructor(e){this.__leaf=e}__get(e){if(this.__input){let t=this.__input[e];if(!_(t))return t}return this[e]}__getData(){let e={tag:this.__leaf.tag},{__input:t}=this,n;for(let r in this)r[0]!==`_`&&(n=t?t[r]:void 0,e[r]=_(n)?this[r]:n);return e}__setInput(e,t){this.__input||={},this.__input[e]=t}__getInput(e){if(this.__input){let t=this.__input[e];if(!_(t))return t}if(e!==`path`||this.__pathInputed)return this[`_`+e]}__removeInput(e){this.__input&&!_(this.__input[e])&&(this.__input[e]=void 0)}__getInputData(e,t){let n={};if(e)if(S(e))for(let t of e)n[t]=this.__getInput(t);else for(let t in e)n[t]=this.__getInput(t);else{let e,t,{__input:r}=this;for(let i in n.tag=this.__leaf.tag,this)if(i[0]!==`_`&&(e=this[`_`+i],!_(e))){if(i===`path`&&!this.__pathInputed)continue;t=r?r[i]:void 0,n[i]=_(t)?e:t}}if(t&&t.matrix){let{a:e,b:t,c:r,d:i,e:a,f:o}=this.__leaf.__localMatrix;n.matrix={a:e,b:t,c:r,d:i,e:a,f:o}}return n}__setMiddle(e,t){this.__middle||={},this.__middle[e]=t}__getMiddle(e){return this.__middle&&this.__middle[e]}__checkSingle(){let e=this;if(e.blendMode===`pass-through`){let t=this.__leaf;e.opacity<1&&(t.isBranch||e.__hasMultiPaint)||t.__hasEraser||e.eraser||e.filter?e.__single=!0:e.__single&&=!1}else e.__single=!0}__removeNaturalSize(){this.__naturalWidth=this.__naturalHeight=void 0}destroy(){this.__input=this.__middle=null}},{floor:re,max:ie}=Math,T={toURL(e,t){let n=encodeURIComponent(e);return t===`text`?n=`data:text/plain;charset=utf-8,`+n:t===`svg`&&(n=`data:image/svg+xml,`+n),n},image:{hitCanvasSize:100,maxCacheSize:4096e3,maxPatternSize:8847360,crossOrigin:`anonymous`,isLarge:(e,t,n,r)=>e.width*e.height*(t?t*n:1)>(r||ae.maxCacheSize),isSuperLarge:(e,t,n)=>ae.isLarge(e,t,n,ae.maxPatternSize),getRealURL(e){let{prefix:t,suffix:n}=T.image;return!n||e.startsWith(`data:`)||e.startsWith(`blob:`)||(e+=(e.includes(`?`)?`&`:`?`)+n),t&&e[0]===`/`&&(e=t+e),e},resize(e,t,n,r,i,a,o,s,c){let l=T.origin.createCanvas(ie(re(t+(r||0)),1),ie(re(n+(i||0)),1)),u=l.getContext(`2d`);if(s&&(u.globalAlpha=s),u.imageSmoothingEnabled=!1!==o,a){let r=t/a.width,i=n/a.height;u.setTransform(r,0,0,i,-a.x*r,-a.y*i),u.drawImage(e,0,0,e.width,e.height)}else u.drawImage(e,0,0,t,n);return l},setPatternTransform(e,t,n){try{t&&e.setTransform&&(e.setTransform(t),t=void 0)}catch{}n&&w.stintSet(n,`transform`,t)}}},{image:ae}=T,oe={RUNTIME:`runtime`,LEAF:`leaf`,TASK:`task`,CNAVAS:`canvas`,IMAGE:`image`,types:{},create(e){let{types:t}=se;return t[e]?t[e]++:(t[e]=1,0)}},se=oe,ce,le,ue,{max:de}=Math,fe=[0,0,0,0],pe={zero:[...fe],tempFour:fe,set:(e,t,n,r,i)=>(n===void 0&&(n=r=i=t),e[0]=t,e[1]=n,e[2]=r,e[3]=i,e),setTemp:(e,t,n,r)=>me(fe,e,t,n,r),toTempAB(e,t,n){ue=n?x(e)?t:e:[],x(e)?(ce=ge(e),le=t):x(t)?(ce=e,le=ge(t)):(ce=e,le=t),ce.length!==4&&(ce=he(ce)),le.length!==4&&(le=he(le))},get(e,t){let n;if(!x(e))switch(e.length){case 4:n=_(t)?e:[...e];break;case 2:n=[e[0],e[1],e[0],e[1]];break;case 3:n=[e[0],e[1],e[2],e[1]];break;case 1:e=e[0];break;default:e=0}if(n||=[e,e,e,e],!_(t))for(let e=0;e<4;e++)n[e]>t&&(n[e]=t);return n},max:(e,t,n)=>x(e)&&x(t)?de(e,t):(_e(e,t,n),me(ue,de(ce[0],le[0]),de(ce[1],le[1]),de(ce[2],le[2]),de(ce[3],le[3]))),add:(e,t,n)=>x(e)&&x(t)?e+t:(_e(e,t,n),me(ue,ce[0]+le[0],ce[1]+le[1],ce[2]+le[2],ce[3]+le[3])),swapAndScale(e,t,n,r){if(x(e))return t===n?e*t:[e*n,e*t];let i=r?e:[],[a,o,s,c]=e.length===4?e:he(e);return me(i,s*n,c*t,a*n,o*t)}},{set:me,get:he,setTemp:ge,toTempAB:_e}=pe,{round:ve,pow:ye,max:be,floor:xe,PI:Se}=Math,Ce={within:(e,t,n)=>(C(t)&&(n=t.max,t=t.min),!_(t)&&e<t&&(e=t),!_(n)&&e>n&&(e=n),e),fourNumber:pe.get,formatRotation:(e,t)=>(e%=360,t?e<0&&(e+=360):(e>180&&(e-=360),e<-180&&(e+=360)),Ce.float(e)),getGapRotation(e,t,n=0){let r=e+n;if(t>1){let e=Math.abs(r%t);(e<1||e>t-1)&&(r=Math.round(r/t)*t)}return r-n},float(e,t){let n=_(t)?0xe8d4a51000:ye(10,t);return(e=ve(e*n)/n)===-0?0:e},sign:e=>e<0?-1:1,getScaleData(e,t,n,r){if(r||={},t){let e=(x(t)?t:t.width||0)/n.width,i=(x(t)?t:t.height||0)/n.height;r.scaleX=e||i||1,r.scaleY=i||e||1}else e&&Ce.assignScale(r,e);return r},assignScale(e,t){x(t)?e.scaleX=e.scaleY=t:(e.scaleX=t.x,e.scaleY=t.y)},getFloorScale:(e,t=1)=>be(xe(e),t)/e,randInt:we,randColor:e=>`rgba(${we(255)},${we(255)},${we(255)},${e||1})`};function we(e){return Math.round(Math.random()*e)}var E=Se/180,Te=2*Se,Ee=Se/2;function De(){return{x:0,y:0}}function Oe(){return{x:0,y:0,width:0,height:0}}function ke(){return{a:1,b:0,c:0,d:1,e:0,f:0}}var{sin:Ae,cos:je,acos:Me,sqrt:Ne}=Math,{float:Pe}=Ce,Fe={};function Ie(){return Object.assign(Object.assign(Object.assign({},{a:1,b:0,c:0,d:1,e:0,f:0}),{x:0,y:0,width:0,height:0}),{scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0})}var D={defaultMatrix:{a:1,b:0,c:0,d:1,e:0,f:0},defaultWorld:Ie(),tempMatrix:{},set(e,t=1,n=0,r=0,i=1,a=0,o=0){e.a=t,e.b=n,e.c=r,e.d=i,e.e=a,e.f=o},get:ke,getWorld:Ie,copy(e,t){e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f},translate(e,t,n){e.e+=t,e.f+=n},translateInner(e,t,n,r){e.e+=e.a*t+e.c*n,e.f+=e.b*t+e.d*n,r&&(e.e-=t,e.f-=n)},scale(e,t,n=t){e.a*=t,e.b*=t,e.c*=n,e.d*=n},pixelScale(e,t,n){n||=e,n.a=e.a*t,n.b=e.b*t,n.c=e.c*t,n.d=e.d*t,n.e=e.e*t,n.f=e.f*t},scaleOfOuter(e,t,n,r){O.toInnerPoint(e,t,Fe),O.scaleOfInner(e,Fe,n,r)},scaleOfInner(e,t,n,r=n){O.translateInner(e,t.x,t.y),O.scale(e,n,r),O.translateInner(e,-t.x,-t.y)},rotate(e,t){let{a:n,b:r,c:i,d:a}=e,o=je(t*=E),s=Ae(t);e.a=n*o-r*s,e.b=n*s+r*o,e.c=i*o-a*s,e.d=i*s+a*o},rotateOfOuter(e,t,n){O.toInnerPoint(e,t,Fe),O.rotateOfInner(e,Fe,n)},rotateOfInner(e,t,n){O.translateInner(e,t.x,t.y),O.rotate(e,n),O.translateInner(e,-t.x,-t.y)},skew(e,t,n){let{a:r,b:i,c:a,d:o}=e;n&&(n*=E,e.a=r+a*n,e.b=i+o*n),t&&(t*=E,e.c=a+r*t,e.d=o+i*t)},skewOfOuter(e,t,n,r){O.toInnerPoint(e,t,Fe),O.skewOfInner(e,Fe,n,r)},skewOfInner(e,t,n,r=0){O.translateInner(e,t.x,t.y),O.skew(e,n,r),O.translateInner(e,-t.x,-t.y)},multiply(e,t){let{a:n,b:r,c:i,d:a,e:o,f:s}=e;e.a=t.a*n+t.b*i,e.b=t.a*r+t.b*a,e.c=t.c*n+t.d*i,e.d=t.c*r+t.d*a,e.e=t.e*n+t.f*i+o,e.f=t.e*r+t.f*a+s},multiplyParent(e,t,n,r,i){let{e:a,f:o}=e;if(n||=e,_(r)&&(r=e.a!==1||e.b||e.c||e.d!==1),r){let{a:r,b:a,c:o,d:s}=e;n.a=r*t.a+a*t.c,n.b=r*t.b+a*t.d,n.c=o*t.a+s*t.c,n.d=o*t.b+s*t.d,i&&(n.scaleX=t.scaleX*i.scaleX,n.scaleY=t.scaleY*i.scaleY)}else n.a=t.a,n.b=t.b,n.c=t.c,n.d=t.d,i&&(n.scaleX=t.scaleX,n.scaleY=t.scaleY);n.e=a*t.a+o*t.c+t.e,n.f=a*t.b+o*t.d+t.f},divide(e,t){O.multiply(e,O.tempInvert(t))},divideParent(e,t){O.multiplyParent(e,O.tempInvert(t))},tempInvert(e){let{tempMatrix:t}=O;return O.copy(t,e),O.invert(t),t},invert(e){let{a:t,b:n,c:r,d:i,e:a,f:o}=e;if(n||r){let s=1/(t*i-n*r);e.a=i*s,e.b=-n*s,e.c=-r*s,e.d=t*s,e.e=-(a*i-o*r)*s,e.f=-(o*t-a*n)*s}else if(t===1&&i===1)e.e=-a,e.f=-o;else{let n=1/(t*i);e.a=i*n,e.d=t*n,e.e=-a*i*n,e.f=-o*t*n}},toOuterPoint(e,t,n,r){let{x:i,y:a}=t;n||=t,n.x=i*e.a+a*e.c,n.y=i*e.b+a*e.d,r||(n.x+=e.e,n.y+=e.f)},toInnerPoint(e,t,n,r){let{a:i,b:a,c:o,d:s}=e,c=1/(i*s-a*o),{x:l,y:u}=t;if(n||=t,n.x=(l*s-u*o)*c,n.y=(u*i-l*a)*c,!r){let{e:t,f:r}=e;n.x-=(t*s-r*o)*c,n.y-=(r*i-t*a)*c}},setLayout(e,t,n,r,i){let{x:a,y:o,scaleX:s,scaleY:c}=t;if(_(i)&&(i=t.rotation||t.skewX||t.skewY),i){let{rotation:n,skewX:r,skewY:i}=t,a=n*E,o=je(a),l=Ae(a);if(r||i){let t=r*E,n=i*E;e.a=(o+n*-l)*s,e.b=(l+n*o)*s,e.c=(t*o-l)*c,e.d=(o+t*l)*c}else e.a=o*s,e.b=l*s,e.c=-l*c,e.d=o*c}else e.a=s,e.b=0,e.c=0,e.d=c;e.e=a,e.f=o,(n||=r)&&O.translateInner(e,-n.x,-n.y,!r)},getLayout(e,t,n,r){let{a:i,b:a,c:o,d:s,e:c,f:l}=e,u,d,f,p,m,h=c,g=l;if(a||o){let e=i*s-a*o;if(o&&!r){u=Ne(i*i+a*a),d=e/u;let t=i/u;f=a>0?Me(t):-Me(t)}else{d=Ne(o*o+s*s),u=e/d;let t=o/d;f=Ee-(s>0?Me(-t):-Me(t))}let t=Pe(je(f)),n=Ae(f);u=Pe(u),d=Pe(d),p=t?Pe((o/d+n)/t/E,9):0,m=t?Pe((a/u-n)/t/E,9):0,f=Pe(f/E)}else u=i,d=s,f=p=m=0;return(t=n||t)&&(h+=t.x*i+t.y*o,g+=t.x*a+t.y*s,n||(h-=t.x,g-=t.y)),{x:h,y:g,scaleX:u,scaleY:d,rotation:f,skewX:p,skewY:m}},withScale(e,t,n=t){let r=e;if(!t||!n){let{a:r,b:i,c:a,d:o}=e;i||a?n=(r*o-i*a)/(t=Ne(r*r+i*i)):(t=r,n=o)}return r.scaleX=t,r.scaleY=n,r},reset(e){O.set(e)}},O=D,{toInnerPoint:Le,toOuterPoint:Re}=D,{sin:ze,cos:Be,abs:Ve,sqrt:He,atan2:Ue,min:We,round:Ge}=Math,k={defaultPoint:{x:0,y:0},tempPoint:{},tempRadiusPoint:{},set(e,t=0,n=0){e.x=t,e.y=n},setRadius(e,t,n){e.radiusX=t,e.radiusY=_(n)?t:n},copy(e,t){e.x=t.x,e.y=t.y},copyFrom(e,t,n){e.x=t,e.y=n},round(e,t){e.x=t?Ge(e.x-.5)+.5:Ge(e.x),e.y=t?Ge(e.y-.5)+.5:Ge(e.y)},move(e,t,n){C(t)?(e.x+=t.x,e.y+=t.y):(e.x+=t,e.y+=n)},scale(e,t,n=t){e.x&&(e.x*=t),e.y&&(e.y*=n)},scaleOf(e,t,n,r=n){e.x+=(e.x-t.x)*(n-1),e.y+=(e.y-t.y)*(r-1)},rotate(e,t,n){n||=Ke.defaultPoint;let r=Be(t*=E),i=ze(t),a=e.x-n.x,o=e.y-n.y;e.x=n.x+a*r-o*i,e.y=n.y+a*i+o*r},tempToInnerOf(e,t){let{tempPoint:n}=Ke;return Je(n,e),Le(t,n,n),n},tempToOuterOf(e,t){let{tempPoint:n}=Ke;return Je(n,e),Re(t,n,n),n},tempToInnerRadiusPointOf(e,t){let{tempRadiusPoint:n}=Ke;return Je(n,e),Ke.toInnerRadiusPointOf(e,t,n),n},toInnerRadiusPointOf(e,t,n){n||=e,Le(t,e,n),n.radiusX=Math.abs(e.radiusX/t.scaleX),n.radiusY=Math.abs(e.radiusY/t.scaleY)},toInnerOf(e,t,n){Le(t,e,n)},toOuterOf(e,t,n){Re(t,e,n)},getCenter:(e,t)=>({x:e.x+(t.x-e.x)/2,y:e.y+(t.y-e.y)/2}),getCenterX:(e,t)=>e+(t-e)/2,getCenterY:(e,t)=>e+(t-e)/2,getDistance:(e,t)=>qe(e.x,e.y,t.x,t.y),getDistanceFrom(e,t,n,r){let i=Ve(n-e),a=Ve(r-t);return He(i*i+a*a)},getMinDistanceFrom:(e,t,n,r,i,a)=>We(qe(e,t,n,r),qe(n,r,i,a)),getAngle:(e,t)=>Ye(e,t)/E,getRotation:(e,t,n,r)=>(r||=t,Ke.getRadianFrom(e.x,e.y,t.x,t.y,n.x,n.y,r.x,r.y)/E),getRadianFrom(e,t,n,r,i,a,o,s){_(o)&&(o=n,s=r);let c=e-n,l=t-r,u=i-o,d=a-s;return Math.atan2(c*d-l*u,c*u+l*d)},getAtan2:(e,t)=>Ue(t.y-e.y,t.x-e.x),getDistancePoint(e,t,n,r){let i=Ye(e,t);return(t=r?t:{}).x=e.x+Be(i)*n,t.y=e.y+ze(i)*n,t},toNumberPoints(e){let t=e;return C(e[0])&&(t=[],e.forEach(e=>t.push(e.x,e.y))),t},reset(e){Ke.reset(e)}},Ke=k,{getDistanceFrom:qe,copy:Je,getAtan2:Ye}=Ke;new class e{constructor(e,t){this.set(e,t)}set(e,t){return C(e)?k.copy(this,e):k.set(this,e,t),this}get(){let{x:e,y:t}=this;return{x:e,y:t}}clone(){return new e(this)}move(e,t){return k.move(this,e,t),this}scale(e,t){return k.scale(this,e,t),this}scaleOf(e,t,n){return k.scaleOf(this,e,t,n),this}rotate(e,t){return k.rotate(this,e,t),this}rotateOf(e,t){return k.rotate(this,t,e),this}getRotation(e,t,n){return k.getRotation(this,e,t,n)}toInnerOf(e,t){return k.toInnerOf(this,e,t),this}toOuterOf(e,t){return k.toOuterOf(this,e,t),this}getCenter(t){return new e(k.getCenter(this,t))}getDistance(e){return k.getDistance(this,e)}getDistancePoint(t,n,r){return new e(k.getDistancePoint(this,t,n,r))}getAngle(e){return k.getAngle(this,e)}getAtan2(e){return k.getAtan2(this,e)}reset(){return k.reset(this),this}};var Xe=class e{constructor(e,t,n,r,i,a){this.set(e,t,n,r,i,a)}set(e,t,n,r,i,a){return C(e)?D.copy(this,e):D.set(this,e,t,n,r,i,a),this}setWith(e){return D.copy(this,e),this.scaleX=e.scaleX,this.scaleY=e.scaleY,this}get(){let{a:e,b:t,c:n,d:r,e:i,f:a}=this;return{a:e,b:t,c:n,d:r,e:i,f:a}}clone(){return new e(this)}translate(e,t){return D.translate(this,e,t),this}translateInner(e,t){return D.translateInner(this,e,t),this}scale(e,t){return D.scale(this,e,t),this}scaleWith(e,t){return D.scale(this,e,t),this.scaleX*=e,this.scaleY*=t||e,this}pixelScale(e){return D.pixelScale(this,e),this}scaleOfOuter(e,t,n){return D.scaleOfOuter(this,e,t,n),this}scaleOfInner(e,t,n){return D.scaleOfInner(this,e,t,n),this}rotate(e){return D.rotate(this,e),this}rotateOfOuter(e,t){return D.rotateOfOuter(this,e,t),this}rotateOfInner(e,t){return D.rotateOfInner(this,e,t),this}skew(e,t){return D.skew(this,e,t),this}skewOfOuter(e,t,n){return D.skewOfOuter(this,e,t,n),this}skewOfInner(e,t,n){return D.skewOfInner(this,e,t,n),this}multiply(e){return D.multiply(this,e),this}multiplyParent(e){return D.multiplyParent(this,e),this}divide(e){return D.divide(this,e),this}divideParent(e){return D.divideParent(this,e),this}invert(){return D.invert(this),this}invertWith(){return D.invert(this),this.scaleX=1/this.scaleX,this.scaleY=1/this.scaleY,this}toOuterPoint(e,t,n){D.toOuterPoint(this,e,t,n)}toInnerPoint(e,t,n){D.toInnerPoint(this,e,t,n)}setLayout(e,t,n){return D.setLayout(this,e,t,n),this}getLayout(e,t,n){return D.getLayout(this,e,t,n)}withScale(e,t){return D.withScale(this,e,t)}reset(){D.reset(this)}};new Xe;var Ze={tempPointBounds:{},setPoint(e,t,n){e.minX=e.maxX=t,e.minY=e.maxY=n},addPoint(e,t,n){e.minX=t<e.minX?t:e.minX,e.minY=n<e.minY?n:e.minY,e.maxX=t>e.maxX?t:e.maxX,e.maxY=n>e.maxY?n:e.maxY},addBounds(e,t,n,r,i){Qe(e,t,n),Qe(e,t+r,n+i)},copy(e,t){e.minX=t.minX,e.minY=t.minY,e.maxX=t.maxX,e.maxY=t.maxY},addPointBounds(e,t){e.minX=t.minX<e.minX?t.minX:e.minX,e.minY=t.minY<e.minY?t.minY:e.minY,e.maxX=t.maxX>e.maxX?t.maxX:e.maxX,e.maxY=t.maxY>e.maxY?t.maxY:e.maxY},toBounds(e,t){t.x=e.minX,t.y=e.minY,t.width=e.maxX-e.minX,t.height=e.maxY-e.minY}},{addPoint:Qe}=Ze,$e,et;(function(e){e[e.top=0]=`top`,e[e.right=1]=`right`,e[e.bottom=2]=`bottom`,e[e.left=3]=`left`})($e||={}),function(e){e[e.topLeft=0]=`topLeft`,e[e.top=1]=`top`,e[e.topRight=2]=`topRight`,e[e.right=3]=`right`,e[e.bottomRight=4]=`bottomRight`,e[e.bottom=5]=`bottom`,e[e.bottomLeft=6]=`bottomLeft`,e[e.left=7]=`left`,e[e.center=8]=`center`,e[e[`top-left`]=0]=`top-left`,e[e[`top-right`]=2]=`top-right`,e[e[`bottom-right`]=4]=`bottom-right`,e[e[`bottom-left`]=6]=`bottom-left`}(et||={});var tt=[{x:0,y:0},{x:.5,y:0},{x:1,y:0},{x:1,y:.5},{x:1,y:1},{x:.5,y:1},{x:0,y:1},{x:0,y:.5},{x:.5,y:.5}];tt.forEach(e=>e.type=`percent`);var nt={directionData:tt,tempPoint:{},get:rt,toPoint(e,t,n,r,i,a){let o=rt(e);n.x=o.x,n.y=o.y,o.type===`percent`&&(n.x*=t.width,n.y*=t.height,i&&(a||(n.x-=i.x,n.y-=i.y),o.x&&(n.x-=o.x===1?i.width:o.x===.5?o.x*i.width:0),o.y&&(n.y-=o.y===1?i.height:o.y===.5?o.y*i.height:0))),r||(n.x+=t.x,n.y+=t.y)},getPoint:(e,t,n)=>(n||={},nt.toPoint(e,t,n,!0),n)};function rt(e){return y(e)?tt[et[e]]:e}var{toPoint:it}=nt,at={toPoint(e,t,n,r,i,a){it(e,n,r,i,t,a)}},{tempPointBounds:ot,setPoint:st,addPoint:ct,toBounds:lt}=Ze,{toOuterPoint:ut}=D,{float:dt,fourNumber:ft}=Ce,{floor:pt,ceil:mt}=Math,ht,gt,_t,vt,yt={},bt={},xt={},A={tempBounds:xt,set(e,t=0,n=0,r=0,i=0){e.x=t,e.y=n,e.width=r,e.height=i},copy(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},copyAndSpread(e,t,n,r,i){let{x:a,y:o,width:s,height:c}=t;if(S(n)){let t=ft(n);r?j.set(e,a+t[3],o+t[0],s-t[1]-t[3],c-t[2]-t[0]):j.set(e,a-t[3],o-t[0],s+t[1]+t[3],c+t[2]+t[0])}else r&&(n=-n),j.set(e,a-n,o-n,s+2*n,c+2*n);i&&(i===`width`?(e.y=o,e.height=c):(e.x=a,e.width=s))},minX:e=>e.width>0?e.x:e.x+e.width,minY:e=>e.height>0?e.y:e.y+e.height,maxX:e=>e.width>0?e.x+e.width:e.x,maxY:e=>e.height>0?e.y+e.height:e.y,move(e,t,n){e.x+=t,e.y+=n},scroll(e,t){e.x+=t.scrollX,e.y+=t.scrollY},getByMove:(e,t,n)=>(e=Object.assign({},e),j.move(e,t,n),e),toOffsetOutBounds(e,t,n){t?Ct(t,e):t=e,n||=e,t.offsetX=j.maxX(n),t.offsetY=j.maxY(n),j.move(t,-t.offsetX,-t.offsetY)},scale(e,t,n=t,r){r||k.scale(e,t,n),e.width*=t,e.height*=n},scaleOf(e,t,n,r=n){k.scaleOf(e,t,n,r),e.width*=n,e.height*=r},tempToOuterOf:(e,t)=>(j.copy(xt,e),j.toOuterOf(xt,t),xt),getOuterOf:(e,t)=>(e=Object.assign({},e),j.toOuterOf(e,t),e),toOuterOf(e,t,n){if(n||=e,t.b===0&&t.c===0){let{a:r,d:i,e:a,f:o}=t;r>0?(n.width=e.width*r,n.x=a+e.x*r):(n.width=e.width*-r,n.x=a+e.x*r-n.width),i>0?(n.height=e.height*i,n.y=o+e.y*i):(n.height=e.height*-i,n.y=o+e.y*i-n.height)}else yt.x=e.x,yt.y=e.y,ut(t,yt,bt),st(ot,bt.x,bt.y),yt.x=e.x+e.width,ut(t,yt,bt),ct(ot,bt.x,bt.y),yt.y=e.y+e.height,ut(t,yt,bt),ct(ot,bt.x,bt.y),yt.x=e.x,ut(t,yt,bt),ct(ot,bt.x,bt.y),lt(ot,n)},toInnerOf(e,t,n){n||=e,j.move(n,-t.e,-t.f),j.scale(n,1/t.a,1/t.d)},getFitMatrix(e,t,n=1){let r=Math.min(n,j.getFitScale(e,t));return new Xe(r,0,0,r,-t.x*r,-t.y*r)},getFitScale(e,t,n){let r=e.width/t.width,i=e.height/t.height;return n?Math.max(r,i):Math.min(r,i)},put(e,t,n=`center`,r=1,i=!0,a){a||=t,y(r)&&(r=j.getFitScale(e,t,r===`cover`)),xt.width=i?t.width*=r:t.width*r,xt.height=i?t.height*=r:t.height*r,at.toPoint(n,xt,e,a,!0,!0)},getSpread(e,t,n){let r={};return j.copyAndSpread(r,e,t,!1,n),r},spread(e,t,n){j.copyAndSpread(e,e,t,!1,n)},shrink(e,t,n){j.copyAndSpread(e,e,t,!0,n)},ceil(e){let{x:t,y:n}=e;e.x=pt(e.x),e.y=pt(e.y),e.width=t>e.x?mt(e.width+t-e.x):mt(e.width),e.height=n>e.y?mt(e.height+n-e.y):mt(e.height)},unsign(e){e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height)},float(e,t){e.x=dt(e.x,t),e.y=dt(e.y,t),e.width=dt(e.width,t),e.height=dt(e.height,t)},add(e,t,n){ht=e.x+e.width,gt=e.y+e.height,_t=t.x,vt=t.y,n||(_t+=t.width,vt+=t.height),ht=ht>_t?ht:_t,gt=gt>vt?gt:vt,e.x=e.x<t.x?e.x:t.x,e.y=e.y<t.y?e.y:t.y,e.width=ht-e.x,e.height=gt-e.y},addList(e,t){j.setListWithFn(e,t,void 0,!0)},setList(e,t,n=!1){j.setListWithFn(e,t,void 0,n)},addListWithFn(e,t,n){j.setListWithFn(e,t,n,!0)},setListWithFn(e,t,n,r=!1){let i,a=!0;for(let o=0,s=t.length;o<s;o++)i=n?n(t[o],o):t[o],i&&(i.width||i.height)&&(a?(a=!1,r||Ct(e,i)):St(e,i));a&&j.reset(e)},setPoints(e,t){t.forEach((e,t)=>t===0?st(ot,e.x,e.y):ct(ot,e.x,e.y)),lt(ot,e)},setPoint(e,t){j.set(e,t.x,t.y)},addPoint(e,t){St(e,t,!0)},getPoints(e){let{x:t,y:n,width:r,height:i}=e;return[{x:t,y:n},{x:t+r,y:n},{x:t+r,y:n+i},{x:t,y:n+i}]},hitRadiusPoint:(e,t,n)=>(n&&(t=k.tempToInnerRadiusPointOf(t,n)),t.x>=e.x-t.radiusX&&t.x<=e.x+e.width+t.radiusX&&t.y>=e.y-t.radiusY&&t.y<=e.y+e.height+t.radiusY),hitPoint:(e,t,n)=>(n&&(t=k.tempToInnerOf(t,n)),t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height),hit:(e,t,n)=>(n&&(t=j.tempToOuterOf(t,n)),!(e.y+e.height<t.y||t.y+t.height<e.y||e.x+e.width<t.x||t.x+t.width<e.x)),includes:(e,t,n)=>(n&&(t=j.tempToOuterOf(t,n)),e.x<=t.x&&e.y<=t.y&&e.x+e.width>=t.x+t.width&&e.y+e.height>=t.y+t.height),getIntersectData(e,t,n){if(n&&(t=j.tempToOuterOf(t,n)),!j.hit(e,t))return{x:0,y:0,width:0,height:0};let{x:r,y:i,width:a,height:o}=t;return ht=r+a,gt=i+o,_t=e.x+e.width,vt=e.y+e.height,r=r>e.x?r:e.x,i=i>e.y?i:e.y,ht=ht<_t?ht:_t,gt=gt<vt?gt:vt,a=ht-r,o=gt-i,{x:r,y:i,width:a,height:o}},intersect(e,t,n){j.copy(e,j.getIntersectData(e,t,n))},isSame:(e,t)=>e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height,isEmpty:e=>e.x===0&&e.y===0&&e.width===0&&e.height===0,reset(e){j.set(e)}},j=A,{add:St,copy:Ct}=j,wt=class e{get minX(){return A.minX(this)}get minY(){return A.minY(this)}get maxX(){return A.maxX(this)}get maxY(){return A.maxY(this)}constructor(e,t,n,r){this.set(e,t,n,r)}set(e,t,n,r){return C(e)?A.copy(this,e):A.set(this,e,t,n,r),this}get(){let{x:e,y:t,width:n,height:r}=this;return{x:e,y:t,width:n,height:r}}clone(){return new e(this)}move(e,t){return A.move(this,e,t),this}scale(e,t,n){return A.scale(this,e,t,n),this}scaleOf(e,t,n){return A.scaleOf(this,e,t,n),this}toOuterOf(e,t){return A.toOuterOf(this,e,t),this}toInnerOf(e,t){return A.toInnerOf(this,e,t),this}getFitMatrix(e,t){return A.getFitMatrix(this,e,t)}put(e,t,n){A.put(this,e,t,n)}spread(e,t){return A.spread(this,e,t),this}shrink(e,t){return A.shrink(this,e,t),this}ceil(){return A.ceil(this),this}unsign(){return A.unsign(this),this}float(e){return A.float(this,e),this}add(e){return A.add(this,e),this}addList(e){return A.setList(this,e,!0),this}setList(e){return A.setList(this,e),this}addListWithFn(e,t){return A.setListWithFn(this,e,t,!0),this}setListWithFn(e,t){return A.setListWithFn(this,e,t),this}setPoint(e){return A.setPoint(this,e),this}setPoints(e){return A.setPoints(this,e),this}addPoint(e){return A.addPoint(this,e),this}getPoints(){return A.getPoints(this)}hitPoint(e,t){return A.hitPoint(this,e,t)}hitRadiusPoint(e,t){return A.hitRadiusPoint(this,e,t)}hit(e,t){return A.hit(this,e,t)}includes(e,t){return A.includes(this,e,t)}intersect(e,t){return A.intersect(this,e,t),this}getIntersect(t,n){return new e(A.getIntersectData(this,t,n))}isSame(e){return A.isSame(this,e)}isEmpty(){return A.isEmpty(this)}reset(){A.reset(this)}},Tt=new wt,Et=class{constructor(e,t,n,r,i,a){C(e)?this.copy(e):this.set(e,t,n,r,i,a)}set(e=0,t=0,n=0,r=0,i=0,a=0){this.top=e,this.right=t,this.bottom=n,this.left=r,this.width=i,this.height=a}copy(e){let{top:t,right:n,bottom:r,left:i,width:a,height:o}=e;this.set(t,n,r,i,a,o)}getBoundsFrom(e){let{top:t,right:n,bottom:r,left:i,width:a,height:o}=this;return new wt(i,t,a||e.width-i-n,o||e.height-t-r)}},Dt={0:1,1:1,2:1,3:1,4:1,5:1,6:1,7:1,8:1,9:1,".":1,e:1,E:1},{randColor:Ot}=Ce,M=class e{constructor(e){this.repeatMap={},this.name=e}static get(t){return new e(t)}static set filter(e){this.filterList=kt(e)}static set exclude(e){this.excludeList=kt(e)}static drawRepaint(e,t){let n=Ot();e.fillWorld(t,n.replace(`1)`,`.1)`)),e.strokeWorld(t,n)}static drawBounds(t,n,r){let i=e.showBounds===`hit`,a=t.__nowWorld,o=Ot();i&&(n.setWorld(a),t.__drawHitPath(n),n.fillStyle=o.replace(`1)`,`.2)`),n.fill()),n.resetTransform(),n.setStroke(o,2),i?n.stroke():n.strokeWorld(a,o)}log(...e){if(At.enable){if(At.filterList.length&&At.filterList.every(e=>e!==this.name)||At.excludeList.length&&At.excludeList.some(e=>e===this.name))return;console.log(`%c`+this.name,`color:#21ae62`,...e)}}tip(...e){At.enable&&this.warn(...e)}warn(...e){At.showWarn&&console.warn(this.name,...e)}repeat(e,...t){this.repeatMap[e]||(this.warn(`repeat:`+e,...t),this.repeatMap[e]=!0)}error(...e){try{throw Error()}catch(t){console.error(this.name,...e,t)}}};function kt(e){return e?y(e)&&(e=[e]):e=[],e}M.filterList=[],M.excludeList=[],M.showWarn=!0;var At=M,jt=M.get(`RunTime`),Mt={currentId:0,currentName:``,idMap:{},nameMap:{},nameToIdMap:{},start(e,t){let n=oe.create(oe.RUNTIME);return Nt.currentId=Nt.idMap[n]=t?performance.now():Date.now(),Nt.currentName=Nt.nameMap[n]=e,Nt.nameToIdMap[e]=n,n},end(e,t){let n=Nt.idMap[e],r=Nt.nameMap[e],i=t?(performance.now()-n)/1e3:Date.now()-n;Nt.idMap[e]=Nt.nameMap[e]=Nt.nameToIdMap[r]=void 0,jt.log(r,i,`ms`)},endOfName(e,t){let n=Nt.nameToIdMap[e];_(n)||Nt.end(n,t)}},Nt=Mt,Pt=[],Ft={list:{},add(e,...t){this.list[e]=!0,Pt.push(...t)},has(e,t){let n=this.list[e];return!n&&t&&this.need(e),n},need(e){console.error(`please install and import plugin: `+(e.includes(`-x`)?``:`@leafer-in/`)+e)}};setTimeout(()=>Pt.forEach(e=>Ft.has(e,!0)));var N={editor:e=>Ft.need(`editor`)},It=M.get(`UICreator`),Lt={list:{},register(e){let{__tag:t}=e.prototype;Rt[t]&&It.repeat(t),Rt[t]=e},get(e,t,n,r,i,a){Rt[e]||It.error(`not register `+e);let o=new Rt[e](t);return _(n)||(o.x=n,r&&(o.y=r),i&&(o.width=i),a&&(o.height=a)),o}},{list:Rt}=Lt,zt=M.get(`EventCreator`),Bt={nameList:{},register(e){let t;Object.keys(e).forEach(n=>{t=e[n],y(t)&&(Vt[t]&&zt.repeat(t),Vt[t]=e)})},changeName(e,t){let n=Vt[e];if(n){let r=Object.keys(n).find(t=>n[t]===e);r&&(n[r]=t,Vt[t]=n)}},has(e){return!!this.nameList[e]},get:(e,...t)=>new Vt[e](...t)},{nameList:Vt}=Bt,Ht=class{constructor(){this.list=[]}add(e){e.manager=this,this.list.push(e)}get(e){let t,{list:n}=this;for(let r=0,i=n.length;r<i;r++)if(t=n[r],t.recycled&&t.isSameSize(e))return t.recycled=!1,t.manager||=this,t;let r=N.canvas(e);return this.add(r),r}recycle(e){e.recycled=!0}clearRecycled(){let e,t=[];for(let n=0,r=this.list.length;n<r;n++)e=this.list[n],e.recycled?e.destroy():t.push(e);this.list=t}clear(){this.list.forEach(e=>{e.destroy()}),this.list.length=0}destroy(){this.clear()}};function P(e,t,n,r){var i,a=arguments.length,o=a<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function Ut(e,t,n,r){return new(n||=Promise)(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})}function F(e){return(t,n)=>{e||=n;let r={get(){return this.context[e]},set(t){this.context[e]=t}};n===`strokeCap`&&(r.set=function(t){this.context[e]=t===`none`?`butt`:t}),Object.defineProperty(t,n,r)}}var Wt=[];function I(){return(e,t)=>{Wt.push(t)}}var Gt=[],L=class{set blendMode(e){e===`normal`&&(e=`source-over`),this.context.globalCompositeOperation=e}get blendMode(){return this.context.globalCompositeOperation}set dashPattern(e){this.context.setLineDash(e||Gt)}get dashPattern(){return this.context.getLineDash()}__bindContext(){let e;Wt.forEach(t=>{e=this.context[t],e&&(this[t]=e.bind(this.context))}),this.textBaseline=`alphabetic`}setTransform(e,t,n,r,i,a){}resetTransform(){}getTransform(){}save(){}restore(){}transform(e,t,n,r,i,a){C(e)?this.context.transform(e.a,e.b,e.c,e.d,e.e,e.f):this.context.transform(e,t,n,r,i,a)}translate(e,t){}scale(e,t){}rotate(e){}fill(e,t){}stroke(e){}clip(e,t){}fillRect(e,t,n,r){}strokeRect(e,t,n,r){}clearRect(e,t,n,r){}drawImage(e,t,n,r,i,a,o,s,c){switch(arguments.length){case 9:if(t<0){let e=-t/r*s;r+=t,t=0,a+=e,s-=e}if(n<0){let e=-n/i*c;i+=n,n=0,o+=e,c-=e}this.context.drawImage(e,t,n,r,i,a,o,s,c);break;case 5:this.context.drawImage(e,t,n,r,i);break;case 3:this.context.drawImage(e,t,n)}}beginPath(){}moveTo(e,t){}lineTo(e,t){}bezierCurveTo(e,t,n,r,i,a){}quadraticCurveTo(e,t,n,r){}closePath(){}arc(e,t,n,r,i,a){}arcTo(e,t,n,r,i){}ellipse(e,t,n,r,i,a,o,s){}rect(e,t,n,r){}roundRect(e,t,n,r,i){}createConicGradient(e,t,n){}createLinearGradient(e,t,n,r){}createPattern(e,t){}createRadialGradient(e,t,n,r,i,a){}fillText(e,t,n,r){}measureText(e){}strokeText(e,t,n,r){}destroy(){this.context=null}};P([F(`imageSmoothingEnabled`)],L.prototype,`smooth`,void 0),P([F(`imageSmoothingQuality`)],L.prototype,`smoothLevel`,void 0),P([F(`globalAlpha`)],L.prototype,`opacity`,void 0),P([F()],L.prototype,`fillStyle`,void 0),P([F()],L.prototype,`strokeStyle`,void 0),P([F(`lineWidth`)],L.prototype,`strokeWidth`,void 0),P([F(`lineCap`)],L.prototype,`strokeCap`,void 0),P([F(`lineJoin`)],L.prototype,`strokeJoin`,void 0),P([F(`lineDashOffset`)],L.prototype,`dashOffset`,void 0),P([F()],L.prototype,`miterLimit`,void 0),P([F()],L.prototype,`shadowBlur`,void 0),P([F()],L.prototype,`shadowColor`,void 0),P([F()],L.prototype,`shadowOffsetX`,void 0),P([F()],L.prototype,`shadowOffsetY`,void 0),P([F()],L.prototype,`filter`,void 0),P([F()],L.prototype,`font`,void 0),P([F()],L.prototype,`fontKerning`,void 0),P([F()],L.prototype,`fontStretch`,void 0),P([F()],L.prototype,`fontVariantCaps`,void 0),P([F()],L.prototype,`textAlign`,void 0),P([F()],L.prototype,`textBaseline`,void 0),P([F()],L.prototype,`textRendering`,void 0),P([F()],L.prototype,`wordSpacing`,void 0),P([F()],L.prototype,`letterSpacing`,void 0),P([F()],L.prototype,`direction`,void 0),P([I()],L.prototype,`setTransform`,null),P([I()],L.prototype,`resetTransform`,null),P([I()],L.prototype,`getTransform`,null),P([I()],L.prototype,`save`,null),P([I()],L.prototype,`restore`,null),P([I()],L.prototype,`translate`,null),P([I()],L.prototype,`scale`,null),P([I()],L.prototype,`rotate`,null),P([I()],L.prototype,`fill`,null),P([I()],L.prototype,`stroke`,null),P([I()],L.prototype,`clip`,null),P([I()],L.prototype,`fillRect`,null),P([I()],L.prototype,`strokeRect`,null),P([I()],L.prototype,`clearRect`,null),P([I()],L.prototype,`beginPath`,null),P([I()],L.prototype,`moveTo`,null),P([I()],L.prototype,`lineTo`,null),P([I()],L.prototype,`bezierCurveTo`,null),P([I()],L.prototype,`quadraticCurveTo`,null),P([I()],L.prototype,`closePath`,null),P([I()],L.prototype,`arc`,null),P([I()],L.prototype,`arcTo`,null),P([I()],L.prototype,`ellipse`,null),P([I()],L.prototype,`rect`,null),P([I()],L.prototype,`roundRect`,null),P([I()],L.prototype,`createConicGradient`,null),P([I()],L.prototype,`createLinearGradient`,null),P([I()],L.prototype,`createPattern`,null),P([I()],L.prototype,`createRadialGradient`,null),P([I()],L.prototype,`fillText`,null),P([I()],L.prototype,`measureText`,null),P([I()],L.prototype,`strokeText`,null);var{copy:Kt,multiplyParent:qt,pixelScale:Jt}=D,{round:Yt}=Math,R=new wt,Xt=new wt,Zt={width:1,height:1,pixelRatio:1},Qt=[`width`,`height`,`pixelRatio`],$t=class extends L{get width(){return this.size.width}get height(){return this.size.height}get pixelRatio(){return this.size.pixelRatio}get pixelWidth(){return this.width*this.pixelRatio||0}get pixelHeight(){return this.height*this.pixelRatio||0}get pixelSnap(){return this.config.pixelSnap}set pixelSnap(e){this.config.pixelSnap=e}get allowBackgroundColor(){return this.view&&this.parentView}constructor(e,t){super(),this.size={},this.worldTransform={},e||=Zt,this.manager=t,this.innerId=oe.create(oe.CNAVAS);let{width:n,height:r,pixelRatio:i}=e;this.autoLayout=!n||!r,this.size.pixelRatio=i||T.devicePixelRatio,this.config=e,this.init()}init(){}__createContext(){let{view:e}=this,{contextSettings:t}=this.config;this.context=t?e.getContext(`2d`,t):e.getContext(`2d`),this.__bindContext()}export(e,t){}toBlob(e,t){}toDataURL(e,t){}saveAs(e,t){}resize(e,t=!0){if(this.isSameSize(e))return;let n;this.context&&!this.unreal&&t&&this.width&&(n=this.getSameCanvas(),n.copyWorld(this));let r=this.size;w.copyAttrs(r,e,Qt),Qt.forEach(e=>r[e]||(r[e]=1)),this.bounds=new wt(0,0,this.width,this.height),this.updateViewSize(),this.updateClientBounds(),this.context&&(this.smooth=this.config.smooth,!this.unreal&&n&&(this.clearWorld(n.bounds),this.copyWorld(n),n.recycle()))}updateViewSize(){}updateClientBounds(){}getClientBounds(e){return e&&this.updateClientBounds(),this.clientBounds||this.bounds}startAutoLayout(e,t){}stopAutoLayout(){}setCursor(e){}setWorld(e,t){let{pixelRatio:n,pixelSnap:r}=this,i=this.worldTransform;t&&qt(e,t,i),Jt(e,n,i),r&&!e.ignorePixelSnap&&(e.half&&e.half*n%2?(i.e=Yt(i.e-.5)+.5,i.f=Yt(i.f-.5)+.5):(i.e=Yt(i.e),i.f=Yt(i.f))),this.setTransform(i.a,i.b,i.c,i.d,i.e,i.f)}useWorldTransform(e){e&&(this.worldTransform=e);let t=this.worldTransform;t&&this.setTransform(t.a,t.b,t.c,t.d,t.e,t.f)}setStroke(e,t,n,r){t&&(this.strokeWidth=t),e&&(this.strokeStyle=e),n&&this.setStrokeOptions(n,r)}setStrokeOptions(e,t){let{strokeCap:n,strokeJoin:r,dashPattern:i,dashOffset:a,miterLimit:o}=e;t&&(t.strokeCap&&(n=t.strokeCap),t.strokeJoin&&(r=t.strokeJoin),_(t.dashPattern)||(i=t.dashPattern),_(t.dashOffset)||(a=t.dashOffset),t.miterLimit&&(o=t.miterLimit)),this.strokeCap=n,this.strokeJoin=r,this.dashPattern=i,this.dashOffset=a,this.miterLimit=o}saveBlendMode(e){this.savedBlendMode=this.blendMode,this.blendMode=e}restoreBlendMode(){this.blendMode=this.savedBlendMode}hitFill(e,t){return!0}hitStroke(e,t){return!0}hitPixel(e,t,n=1){return!0}setWorldShadow(e,t,n,r){let{pixelRatio:i}=this;this.shadowOffsetX=e*i,this.shadowOffsetY=t*i,this.shadowBlur=n*i,this.shadowColor=r||`black`}setWorldBlur(e){let{pixelRatio:t}=this;this.filter=`blur(${e*t}px)`}copyWorld(e,t,n,r,i=!0){r&&(this.blendMode=r),t?(this.setTempPixelBounds(t,i),n?(this.setTempPixelBounds2(n,i),n=Xt):n=R,this.drawImage(e.view,R.x,R.y,R.width,R.height,n.x,n.y,n.width,n.height)):this.drawImage(e.view,0,0),r&&(this.blendMode=`source-over`)}copyWorldToInner(e,t,n,r,i=!0){t.b||t.c?(this.save(),this.resetTransform(),this.copyWorld(e,t,A.tempToOuterOf(n,t),r,i),this.restore()):(r&&(this.blendMode=r),this.setTempPixelBounds(t,i),this.drawImage(e.view,R.x,R.y,R.width,R.height,n.x,n.y,n.width,n.height),r&&(this.blendMode=`source-over`))}copyWorldByReset(e,t,n,r,i,a=!0){this.resetTransform(),this.copyWorld(e,t,n,r,a),i||this.useWorldTransform()}useGrayscaleAlpha(e){let t,n;this.setTempPixelBounds(e,!0,!0);let{context:r}=this,i=r.getImageData(R.x,R.y,R.width,R.height),{data:a}=i;for(let e=0,r=a.length;e<r;e+=4)n=.299*a[e]+.587*a[e+1]+.114*a[e+2],(t=a[e+3])&&(a[e+3]=t===255?n:n/255*t);r.putImageData(i,R.x,R.y)}useMask(e,t,n){this.copyWorld(e,t,n,`destination-in`)}useEraser(e,t,n){this.copyWorld(e,t,n,`destination-out`)}fillWorld(e,t,n,r){n&&(this.blendMode=n),this.fillStyle=t,this.setTempPixelBounds(e,r),this.fillRect(R.x,R.y,R.width,R.height),n&&(this.blendMode=`source-over`)}strokeWorld(e,t,n,r){n&&(this.blendMode=n),this.strokeStyle=t,this.setTempPixelBounds(e,r),this.strokeRect(R.x,R.y,R.width,R.height),n&&(this.blendMode=`source-over`)}clipWorld(e,t=!0){this.beginPath(),this.setTempPixelBounds(e,t),this.rect(R.x,R.y,R.width,R.height),this.clip()}clipUI(e){e.windingRule?this.clip(e.windingRule):this.clip()}clearWorld(e,t=!0){this.setTempPixelBounds(e,t),this.clearRect(R.x,R.y,R.width,R.height)}clear(){let{pixelRatio:e}=this;this.clearRect(0,0,this.width*e+2,this.height*e+2)}setTempPixelBounds(e,t,n){this.copyToPixelBounds(R,e,t,n)}setTempPixelBounds2(e,t,n){this.copyToPixelBounds(Xt,e,t,n)}copyToPixelBounds(e,t,n,r){e.set(t),r&&e.intersect(this.bounds),e.scale(this.pixelRatio),n&&e.ceil()}isSameSize(e){return this.width===e.width&&this.height===e.height&&(!e.pixelRatio||this.pixelRatio===e.pixelRatio)}getSameCanvas(e,t){let{size:n,pixelSnap:r}=this,i=this.manager?this.manager.get(n):N.canvas(Object.assign({},n));return i.save(),e&&(Kt(i.worldTransform,this.worldTransform),i.useWorldTransform()),t&&(i.smooth=this.smooth),i.pixelSnap!==r&&(i.pixelSnap=r),i}recycle(e){this.recycled||(this.restore(),e?this.clearWorld(e):this.clear(),this.manager?this.manager.recycle(this):this.destroy())}updateRender(e){}unrealCanvas(){}destroy(){this.manager=this.view=this.parentView=null}},en={creator:{},parse(e,t){},convertToCanvasData(e,t){}},tn={N:21,D:22,X:23,G:24,F:25,O:26,P:27,U:28},nn=Object.assign({M:1,m:10,L:2,l:20,H:3,h:30,V:4,v:40,C:5,c:50,S:6,s:60,Q:7,q:70,T:8,t:80,A:9,a:90,Z:11,z:11,R:12},tn),rn={M:3,m:3,L:3,l:3,H:2,h:2,V:2,v:2,C:7,c:7,S:5,s:5,Q:5,q:5,T:3,t:3,A:8,a:8,Z:1,z:1,N:5,D:9,X:6,G:9,F:5,O:7,P:4,U:6},an={m:10,l:20,H:3,h:30,V:4,v:40,c:50,S:6,s:60,q:70,T:8,t:80,A:9,a:90},on=Object.assign(Object.assign({},an),tn),sn=nn,cn={};for(let e in sn)cn[sn[e]]=e;var ln={};for(let e in sn)ln[sn[e]]=rn[e];var un={drawRoundRect(e,t,n,r,i,a){let o=Ce.fourNumber(a,Math.min(r/2,i/2)),s=t+r,c=n+i;o[0]?e.moveTo(t+o[0],n):e.moveTo(t,n),o[1]?e.arcTo(s,n,s,c,o[1]):e.lineTo(s,n),o[2]?e.arcTo(s,c,t,c,o[2]):e.lineTo(s,c),o[3]?e.arcTo(t,c,t,n,o[3]):e.lineTo(t,c),o[0]?e.arcTo(t,n,s,n,o[0]):e.lineTo(t,n)}},{sin:dn,cos:fn,hypot:pn,atan2:mn,ceil:hn,abs:gn,PI:_n,sqrt:vn,pow:yn}=Math,{setPoint:bn,addPoint:xn}=Ze,{set:Sn,toNumberPoints:Cn}=k,{M:wn,L:Tn,C:En,Q:Dn,Z:On}=nn,kn={},An={points(e,t,n,r){let i=Cn(t);if(e.push(wn,i[0],i[1]),n&&i.length>5){let t,a,o,s,c,l,u,d,f,p,m,h,g,_=i.length,v=!0===n?.5:n;r&&(i=[i[_-2],i[_-1],...i,i[0],i[1],i[2],i[3]],_=i.length);for(let n=2;n<_-2;n+=2)t=i[n-2],a=i[n-1],o=i[n],s=i[n+1],c=i[n+2],l=i[n+3],m=vn(yn(o-t,2)+yn(s-a,2)),h=vn(yn(c-o,2)+yn(l-s,2)),(m||h)&&(g=m+h,m=v*m/g,h=v*h/g,c-=t,l-=a,u=o-m*c,d=s-m*l,n===2?r||e.push(Dn,u,d,o,s):e.push(En,f,p,u,d,o,s),f=o+h*c,p=s+h*l);r||e.push(Dn,f,p,i[_-2],i[_-1])}else for(let t=2,n=i.length;t<n;t+=2)e.push(Tn,i[t],i[t+1]);r&&e.push(On)},rect(e,t,n,r,i){en.creator.path=e,en.creator.moveTo(t,n).lineTo(t+r,n).lineTo(t+r,n+i).lineTo(t,n+i).lineTo(t,n)},roundRect(e,t,n,r,i,a){en.creator.path=[],un.drawRoundRect(en.creator,t,n,r,i,a),e.push(...en.convertToCanvasData(en.creator.path,!0))},arcTo(e,t,n,r,i,a,o,s,c,l,u){let d=r-t,f=i-n,p=a-r,m=o-i,h=mn(f,d),g=mn(m,p),_=pn(d,f),v=pn(p,m),y=g-h;if(y<0&&(y+=Te),_<1e-12||v<1e-12||y<1e-12||gn(y-_n)<1e-12)return e&&e.push(Tn,r,i),c&&(bn(c,t,n),xn(c,r,i)),u&&Sn(u,t,n),void(l&&Sn(l,r,i));let b=d*m-p*f<0,x=b?-1:1,S=s/fn(y/2),C=r+S*fn(h+y/2+Ee*x),ee=i+S*dn(h+y/2+Ee*x);return h-=Ee*x,g-=Ee*x,Nn(e,C,ee,s,s,0,h/E,g/E,b,c,l,u)},arc:(e,t,n,r,i,a,o,s,c,l)=>Nn(e,t,n,r,r,0,i,a,o,s,c,l),ellipse(e,t,n,r,i,a,o,s,c,l,u,d){let f=a*E,p=dn(f),m=fn(f),h=o*E,g=s*E;h>_n&&(h-=Te),g<0&&(g+=Te);let _=g-h;_<0?_+=Te:_>Te&&(_-=Te),c&&(_-=Te);let v=hn(gn(_/Ee)),y=_/v,b=dn(y/4),x=8/3*b*b/dn(y/2);g=h+y;let S,C,ee,w,te,ne,re,ie,T=fn(h),ae=dn(h),oe=ee=m*r*T-p*i*ae,se=w=p*r*T+m*i*ae,ce=t+ee,le=n+w;e&&e.push(e.length?Tn:wn,ce,le),l&&bn(l,ce,le),d&&Sn(d,ce,le);for(let a=0;a<v;a++)S=fn(g),C=dn(g),ee=m*r*S-p*i*C,w=p*r*S+m*i*C,te=t+oe-x*(m*r*ae+p*i*T),ne=n+se-x*(p*r*ae-m*i*T),re=t+ee+x*(m*r*C+p*i*S),ie=n+w+x*(p*r*C-m*i*S),e&&e.push(En,te,ne,re,ie,t+ee,n+w),l&&Mn(t+oe,n+se,te,ne,re,ie,t+ee,n+w,l,!0),oe=ee,se=w,T=S,ae=C,h=g,g+=y;u&&Sn(u,t+ee,n+w)},quadraticCurveTo(e,t,n,r,i,a,o){e.push(En,(t+2*r)/3,(n+2*i)/3,(a+2*r)/3,(o+2*i)/3,a,o)},toTwoPointBoundsByQuadraticCurve(e,t,n,r,i,a,o,s){Mn(e,t,(e+2*n)/3,(t+2*r)/3,(i+2*n)/3,(a+2*r)/3,i,a,o,s)},toTwoPointBounds(e,t,n,r,i,a,o,s,c,l){let u=[],d,f,p,m,h,g,_,v,y=e,b=n,x=i,S=o;for(let e=0;e<2;++e)if(e==1&&(y=t,b=r,x=a,S=s),d=-3*y+9*b-9*x+3*S,f=6*y-12*b+6*x,p=3*b-3*y,Math.abs(d)<1e-12){if(Math.abs(f)<1e-12)continue;m=-p/f,0<m&&m<1&&u.push(m)}else _=f*f-4*p*d,v=Math.sqrt(_),_<0||(h=(-f+v)/(2*d),0<h&&h<1&&u.push(h),g=(-f-v)/(2*d),0<g&&g<1&&u.push(g));l?xn(c,e,t):bn(c,e,t),xn(c,o,s);for(let l=0,d=u.length;l<d;l++)jn(u[l],e,t,n,r,i,a,o,s,kn),xn(c,kn.x,kn.y)},getPointAndSet(e,t,n,r,i,a,o,s,c,l){let u=1-e,d=u*u*u,f=3*u*u*e,p=3*u*e*e,m=e*e*e;l.x=d*t+f*r+p*a+m*s,l.y=d*n+f*i+p*o+m*c},getPoint(e,t,n,r,i,a,o,s,c){let l={};return jn(e,t,n,r,i,a,o,s,c,l),l},getDerivative(e,t,n,r,i){let a=1-e;return 3*a*a*(n-t)+6*a*e*(r-n)+3*e*e*(i-r)}},{getPointAndSet:jn,toTwoPointBounds:Mn,ellipse:Nn}=An,{sin:Pn,cos:Fn,sqrt:In,atan2:Ln}=Math,{ellipse:Rn}=An,zn={ellipticalArc(e,t,n,r,i,a,o,s,c,l,u){let d=(c-t)/2,f=(l-n)/2,p=a*E,m=Pn(p),h=Fn(p),g=-h*d-m*f,_=-h*f+m*d,v=r*r,y=i*i,b=_*_,x=g*g,S=v*y-v*b-y*x,C=0;if(S<0){let e=In(1-S/(v*y));r*=e,i*=e}else C=(o===s?-1:1)*In(S/(v*b+y*x));let ee=C*r*_/i,w=-C*i*g/r,te=Ln((_-w)/i,(g-ee)/r),ne=Ln((-_-w)/i,(-g-ee)/r),re=ne-te;s===0&&re>0?re-=Te:s===1&&re<0&&(re+=Te);let ie=t+d+h*ee-m*w,ae=n+f+m*ee+h*w,oe=re<0?1:0;u||T.ellipseToCurve?Rn(e,ie,ae,r,i,a,te/E,ne/E,oe):r!==i||a?e.push(nn.G,ie,ae,r,i,a,te/E,ne/E,oe):e.push(nn.O,ie,ae,r,te/E,ne/E,oe)}},{M:Bn,m:Vn,L:Hn,l:Un,H:Wn,h:Gn,V:Kn,v:qn,C:Jn,c:Yn,S:Xn,s:Zn,Q:Qn,q:$n,T:er,t:tr,A:nr,a:rr,Z:ir,z:ar,N:or,D:sr,X:cr,G:lr,F:ur,O:dr,P:fr,U:pr}=nn,{rect:mr,roundRect:hr,arcTo:gr,arc:_r,ellipse:vr,quadraticCurveTo:yr}=An,{ellipticalArc:br}=zn,xr=M.get(`PathConvert`),Sr={},Cr={current:{dot:0},stringify(e,t){let n,r,i,a=0,o=e.length,s=``;for(;a<o;){r=e[a],n=ln[r],s+=r===i?` `:cn[r];for(let r=1;r<n;r++)s+=Ce.float(e[a+r],t),r===n-1||(s+=` `);i=r,a+=n}return s},parse(e,t){let n,r,i,a=``,o=[],s=t?on:an;for(let t=0,c=e.length;t<c;t++)r=e[t],Dt[r]?(r===`.`&&(wr.dot&&(Tr(o,a),a=``),wr.dot++),a===`0`&&r!==`.`&&(Tr(o,a),a=``),a+=r):nn[r]?(a&&=(Tr(o,a),``),wr.name=nn[r],wr.length=rn[r],wr.index=0,Tr(o,wr.name),!n&&s[r]&&(n=!0)):r===`-`||r===`+`?i===`e`||i===`E`?a+=r:(a&&Tr(o,a),a=r):a&&=(Tr(o,a),``),i=r;return a&&Tr(o,a),n?Cr.toCanvasData(o,t):o},toCanvasData(e,t){let n,r,i,a,o,s=0,c=0,l=0,u=0,d=0,f=e.length,p=[];for(;d<f;){switch(i=e[d],i){case Vn:e[d+1]+=s,e[d+2]+=c;case Bn:s=e[d+1],c=e[d+2],p.push(Bn,s,c),d+=3;break;case Gn:e[d+1]+=s;case Wn:s=e[d+1],p.push(Hn,s,c),d+=2;break;case qn:e[d+1]+=c;case Kn:c=e[d+1],p.push(Hn,s,c),d+=2;break;case Un:e[d+1]+=s,e[d+2]+=c;case Hn:s=e[d+1],c=e[d+2],p.push(Hn,s,c),d+=3;break;case Zn:e[d+1]+=s,e[d+2]+=c,e[d+3]+=s,e[d+4]+=c,i=Xn;case Xn:o=a===Jn||a===Xn,l=o?2*s-n:e[d+1],u=o?2*c-r:e[d+2],n=e[d+1],r=e[d+2],s=e[d+3],c=e[d+4],p.push(Jn,l,u,n,r,s,c),d+=5;break;case Yn:e[d+1]+=s,e[d+2]+=c,e[d+3]+=s,e[d+4]+=c,e[d+5]+=s,e[d+6]+=c,i=Jn;case Jn:n=e[d+3],r=e[d+4],s=e[d+5],c=e[d+6],p.push(Jn,e[d+1],e[d+2],n,r,s,c),d+=7;break;case tr:e[d+1]+=s,e[d+2]+=c,i=er;case er:o=a===Qn||a===er,n=o?2*s-n:e[d+1],r=o?2*c-r:e[d+2],t?yr(p,s,c,n,r,e[d+1],e[d+2]):p.push(Qn,n,r,e[d+1],e[d+2]),s=e[d+1],c=e[d+2],d+=3;break;case $n:e[d+1]+=s,e[d+2]+=c,e[d+3]+=s,e[d+4]+=c,i=Qn;case Qn:n=e[d+1],r=e[d+2],t?yr(p,s,c,n,r,e[d+3],e[d+4]):p.push(Qn,n,r,e[d+3],e[d+4]),s=e[d+3],c=e[d+4],d+=5;break;case rr:e[d+6]+=s,e[d+7]+=c;case nr:br(p,s,c,e[d+1],e[d+2],e[d+3],e[d+4],e[d+5],e[d+6],e[d+7],t),s=e[d+6],c=e[d+7],d+=8;break;case ar:case ir:p.push(ir),d++;break;case or:s=e[d+1],c=e[d+2],t?mr(p,s,c,e[d+3],e[d+4]):Er(p,e,d,5),d+=5;break;case sr:s=e[d+1],c=e[d+2],t?hr(p,s,c,e[d+3],e[d+4],[e[d+5],e[d+6],e[d+7],e[d+8]]):Er(p,e,d,9),d+=9;break;case cr:s=e[d+1],c=e[d+2],t?hr(p,s,c,e[d+3],e[d+4],e[d+5]):Er(p,e,d,6),d+=6;break;case lr:vr(t?p:Er(p,e,d,9),e[d+1],e[d+2],e[d+3],e[d+4],e[d+5],e[d+6],e[d+7],e[d+8],null,Sr),s=Sr.x,c=Sr.y,d+=9;break;case ur:t?vr(p,e[d+1],e[d+2],e[d+3],e[d+4],0,0,360,!1):Er(p,e,d,5),s=e[d+1]+e[d+3],c=e[d+2],d+=5;break;case dr:_r(t?p:Er(p,e,d,7),e[d+1],e[d+2],e[d+3],e[d+4],e[d+5],e[d+6],null,Sr),s=Sr.x,c=Sr.y,d+=7;break;case fr:t?_r(p,e[d+1],e[d+2],e[d+3],0,360,!1):Er(p,e,d,4),s=e[d+1]+e[d+3],c=e[d+2],d+=4;break;case pr:gr(t?p:Er(p,e,d,6),s,c,e[d+1],e[d+2],e[d+3],e[d+4],e[d+5],null,Sr),s=Sr.x,c=Sr.y,d+=6;break;default:return xr.error(`command: ${i} [index:${d}]`,e),p}a=i}return p},objectToCanvasData(e){let t=[];return e.forEach(e=>{switch(e.name){case`M`:t.push(Bn,e.x,e.y);break;case`L`:t.push(Hn,e.x,e.y);break;case`C`:t.push(Jn,e.x1,e.y1,e.x2,e.y2,e.x,e.y);break;case`Q`:t.push(Qn,e.x1,e.y1,e.x,e.y);break;case`Z`:t.push(ir)}}),t},copyData(e,t,n,r){for(let i=n,a=n+r;i<a;i++)e.push(t[i])},pushData(e,t){wr.index===wr.length&&(wr.index=1,e.push(wr.name)),e.push(Number(t)),wr.index++,wr.dot=0}},{current:wr,pushData:Tr,copyData:Er}=Cr,{M:Dr,L:Or,C:kr,Q:Ar,Z:jr,N:Mr,D:Nr,X:Pr,G:Fr,F:Ir,O:Lr,P:Rr,U:zr}=nn,{getMinDistanceFrom:Br,getRadianFrom:Vr}=k,{tan:Hr,min:Ur,abs:Wr}=Math,Gr={},Kr={beginPath(e){e.length=0},moveTo(e,t,n){e.push(Dr,t,n)},lineTo(e,t,n){e.push(Or,t,n)},bezierCurveTo(e,t,n,r,i,a,o){e.push(kr,t,n,r,i,a,o)},quadraticCurveTo(e,t,n,r,i){e.push(Ar,t,n,r,i)},closePath(e){e.push(jr)},rect(e,t,n,r,i){e.push(Mr,t,n,r,i)},roundRect(e,t,n,r,i,a){if(x(a))e.push(Pr,t,n,r,i,a);else{let o=Ce.fourNumber(a);o?e.push(Nr,t,n,r,i,...o):e.push(Mr,t,n,r,i)}},ellipse(e,t,n,r,i,a,o,s,c){v(a)?e.push(Ir,t,n,r,i):(v(o)&&(o=0),v(s)&&(s=360),e.push(Fr,t,n,r,i,a,o,s,c?1:0))},arc(e,t,n,r,i,a,o){v(i)?e.push(Rr,t,n,r):(v(a)&&(a=360),e.push(Lr,t,n,r,i,a,o?1:0))},arcTo(e,t,n,r,i,a,o,s){if(!_(o)){let e=Br(o,s,t,n,r,i);a=Ur(a,Ur(e/2,e/2*Wr(Hr(Vr(o,s,t,n,r,i)/2))))}e.push(zr,t,n,r,i,a)},drawEllipse(e,t,n,r,i,a,o,s,c){An.ellipse(null,t,n,r,i,v(a)?0:a,v(o)?0:o,v(s)?360:s,c,null,null,Gr),e.push(Dr,Gr.x,Gr.y),qr(e,t,n,r,i,a,o,s,c)},drawArc(e,t,n,r,i,a,o){An.arc(null,t,n,r,v(i)?0:i,v(a)?360:a,o,null,null,Gr),e.push(Dr,Gr.x,Gr.y),Jr(e,t,n,r,i,a,o)},drawPoints(e,t,n,r){An.points(e,t,n,r)}},{ellipse:qr,arc:Jr}=Kr,{moveTo:Yr,lineTo:Xr,quadraticCurveTo:Zr,bezierCurveTo:Qr,closePath:$r,beginPath:ei,rect:ti,roundRect:ni,ellipse:ri,arc:ii,arcTo:ai,drawEllipse:oi,drawArc:si,drawPoints:ci}=Kr,li=class{set path(e){this.__path=e}get path(){return this.__path}constructor(e){this.set(e)}set(e){return this.__path=e?y(e)?en.parse(e):e:[],this}beginPath(){return ei(this.__path),this.paint(),this}moveTo(e,t){return Yr(this.__path,e,t),this.paint(),this}lineTo(e,t){return Xr(this.__path,e,t),this.paint(),this}bezierCurveTo(e,t,n,r,i,a){return Qr(this.__path,e,t,n,r,i,a),this.paint(),this}quadraticCurveTo(e,t,n,r){return Zr(this.__path,e,t,n,r),this.paint(),this}closePath(){return $r(this.__path),this.paint(),this}rect(e,t,n,r){return ti(this.__path,e,t,n,r),this.paint(),this}roundRect(e,t,n,r,i){return ni(this.__path,e,t,n,r,i),this.paint(),this}ellipse(e,t,n,r,i,a,o,s){return ri(this.__path,e,t,n,r,i,a,o,s),this.paint(),this}arc(e,t,n,r,i,a){return ii(this.__path,e,t,n,r,i,a),this.paint(),this}arcTo(e,t,n,r,i){return ai(this.__path,e,t,n,r,i),this.paint(),this}drawEllipse(e,t,n,r,i,a,o,s){return oi(this.__path,e,t,n,r,i,a,o,s),this.paint(),this}drawArc(e,t,n,r,i,a){return si(this.__path,e,t,n,r,i,a),this.paint(),this}drawPoints(e,t,n){return ci(this.__path,e,t,n),this.paint(),this}clearPath(){return this.beginPath()}paint(){}},{M:ui,L:di,C:fi,Q:pi,Z:mi,N:hi,D:gi,X:_i,G:vi,F:yi,O:bi,P:xi,U:Si}=nn,Ci=M.get(`PathDrawer`),wi={drawPathByData(e,t){if(!t)return;let n,r=0,i=t.length;for(;r<i;)switch(n=t[r],n){case ui:e.moveTo(t[r+1],t[r+2]),r+=3;break;case di:e.lineTo(t[r+1],t[r+2]),r+=3;break;case fi:e.bezierCurveTo(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5],t[r+6]),r+=7;break;case pi:e.quadraticCurveTo(t[r+1],t[r+2],t[r+3],t[r+4]),r+=5;break;case mi:e.closePath(),r+=1;break;case hi:e.rect(t[r+1],t[r+2],t[r+3],t[r+4]),r+=5;break;case gi:e.roundRect(t[r+1],t[r+2],t[r+3],t[r+4],[t[r+5],t[r+6],t[r+7],t[r+8]]),r+=9;break;case _i:e.roundRect(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]),r+=6;break;case vi:e.ellipse(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]*E,t[r+6]*E,t[r+7]*E,t[r+8]),r+=9;break;case yi:e.ellipse(t[r+1],t[r+2],t[r+3],t[r+4],0,0,Te,!1),r+=5;break;case bi:e.arc(t[r+1],t[r+2],t[r+3],t[r+4]*E,t[r+5]*E,t[r+6]),r+=7;break;case xi:e.arc(t[r+1],t[r+2],t[r+3],0,Te,!1),r+=4;break;case Si:e.arcTo(t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]),r+=6;break;default:Ci.error(`command: ${n} [index:${r}]`,t);return}}},{M:Ti,L:Ei,C:Di,Q:Oi,Z:ki,N:Ai,D:ji,X:Mi,G:Ni,F:Pi,O:Fi,P:Ii,U:Li}=nn,{toTwoPointBounds:Ri,toTwoPointBoundsByQuadraticCurve:zi,arcTo:Bi,arc:Vi,ellipse:Hi}=An,{addPointBounds:Ui,copy:Wi,addPoint:Gi,setPoint:Ki,addBounds:qi,toBounds:Ji}=Ze,Yi=M.get(`PathBounds`),Xi,Zi,Qi,$i={},ea={},ta={},na={toBounds(e,t){na.toTwoPointBounds(e,ea),Ji(ea,t)},toTwoPointBounds(e,t){if(!e||!e.length)return Ki(t,0,0);let n,r,i,a,o,s=0,c=0,l=0,u=e.length;for(;s<u;)switch(o=e[s],s===0&&(o===ki||o===Di||o===Oi?Ki(t,c,l):Ki(t,e[s+1],e[s+2])),o){case Ti:case Ei:c=e[s+1],l=e[s+2],Gi(t,c,l),s+=3;break;case Di:i=e[s+5],a=e[s+6],Ri(c,l,e[s+1],e[s+2],e[s+3],e[s+4],i,a,$i),Ui(t,$i),c=i,l=a,s+=7;break;case Oi:n=e[s+1],r=e[s+2],i=e[s+3],a=e[s+4],zi(c,l,n,r,i,a,$i),Ui(t,$i),c=i,l=a,s+=5;break;case ki:s+=1;break;case Ai:c=e[s+1],l=e[s+2],qi(t,c,l,e[s+3],e[s+4]),s+=5;break;case ji:case Mi:c=e[s+1],l=e[s+2],qi(t,c,l,e[s+3],e[s+4]),s+=o===ji?9:6;break;case Ni:Hi(null,e[s+1],e[s+2],e[s+3],e[s+4],e[s+5],e[s+6],e[s+7],e[s+8],$i,ta),s===0?Wi(t,$i):Ui(t,$i),c=ta.x,l=ta.y,s+=9;break;case Pi:c=e[s+1],l=e[s+2],Zi=e[s+3],Qi=e[s+4],qi(t,c-Zi,l-Qi,2*Zi,2*Qi),c+=Zi,s+=5;break;case Fi:Vi(null,e[s+1],e[s+2],e[s+3],e[s+4],e[s+5],e[s+6],$i,ta),s===0?Wi(t,$i):Ui(t,$i),c=ta.x,l=ta.y,s+=7;break;case Ii:c=e[s+1],l=e[s+2],Xi=e[s+3],qi(t,c-Xi,l-Xi,2*Xi,2*Xi),c+=Xi,s+=4;break;case Li:Bi(null,c,l,e[s+1],e[s+2],e[s+3],e[s+4],e[s+5],$i,ta),s===0?Wi(t,$i):Ui(t,$i),c=ta.x,l=ta.y,s+=6;break;default:Yi.error(`command: ${o} [index:${s}]`,e);return}}},{M:ra,L:ia,Z:aa}=nn,{getCenterX:oa,getCenterY:sa}=k,{arcTo:ca}=Kr,la={smooth(e,t,n){let r,i,a,o=0,s=0,c=0,l=0,u=0,d=0,f=0,p=0,m=0,h=e.length,g=[];for(;o<h;){switch(r=e[o],r){case ra:l=p=e[o+1],u=m=e[o+2],o+=3,e[o]===ia?(d=e[o+1],f=e[o+2],g.push(ra,oa(l,d),sa(u,f))):g.push(ra,l,u);break;case ia:switch(s=e[o+1],c=e[o+2],o+=3,e[o]){case ia:ca(g,s,c,e[o+1],e[o+2],t,p,m);break;case aa:ca(g,s,c,l,u,t,p,m);break;default:g.push(ia,s,c)}p=s,m=c;break;case aa:i!==aa&&(ca(g,l,u,d,f,t,p,m),g.push(aa)),o+=1;break;default:a=ln[r];for(let t=0;t<a;t++)g.push(e[o+t]);o+=a}i=r}return r!==aa&&(g[1]=l,g[2]=u),g}};function ua(e){return new li(e)}var da=ua();en.creator=ua(),en.parse=Cr.parse,en.convertToCanvasData=Cr.toCanvasData;var{drawRoundRect:fa}=un;function pa(e){(function(e){e&&!e.roundRect&&(e.roundRect=function(e,t,n,r,i){fa(this,e,t,n,r,i)})})(e)}var ma={alphaPixelTypes:[`png`,`webp`,`svg`],upperCaseTypeMap:{},mineType:e=>!e||e.startsWith(`image`)?e:(e===`jpg`&&(e=`jpeg`),`image/`+e),fileType(e){let t=e.split(`.`);return t[t.length-1]},isOpaqueImage(e){let t=ha.fileType(e);return[`jpg`,`jpeg`].some(e=>e===t)},getExportOptions(e){switch(typeof e){case`object`:return e;case`number`:return{quality:e};case`boolean`:return{blob:e};default:return{}}}},ha=ma;ha.alphaPixelTypes.forEach(e=>ha.upperCaseTypeMap[e]=e.toUpperCase());var ga=M.get(`TaskProcessor`),_a=class{constructor(e){this.parallel=!0,this.time=1,this.id=oe.create(oe.TASK),this.task=e}run(){return Ut(this,void 0,void 0,function*(){try{if(this.isComplete)return;if(this.canUse&&!this.canUse())return this.cancel();this.task&&this.parent.running&&(yield this.task())}catch(e){ga.error(e)}})}complete(){this.isComplete=!0,this.parent=this.task=this.canUse=null}cancel(){this.isCancel=!0,this.complete()}},va=class{get total(){return this.list.length+this.delayNumber}get finishedIndex(){return this.isComplete?0:this.index+this.parallelSuccessNumber}get remain(){return this.isComplete?this.total:this.total-this.finishedIndex}get percent(){let{total:e}=this,t=0,n=0;for(let r=0;r<e;r++)r<=this.finishedIndex?(n+=this.list[r].time,r===this.finishedIndex&&(t=n)):t+=this.list[r].time;return this.isComplete?1:n/t}constructor(e){this.config={parallel:6},this.list=[],this.running=!1,this.isComplete=!0,this.index=0,this.delayNumber=0,e&&w.assign(this.config,e),this.empty()}add(e,t,n){let r,i,a,o,s=new _a(e);return s.parent=this,x(t)?o=t:t&&(i=t.parallel,r=t.start,a=t.time,o=t.delay,n||=t.canUse),a&&(s.time=a),!1===i&&(s.parallel=!1),n&&(s.canUse=n),_(o)?this.push(s,r):(this.delayNumber++,setTimeout(()=>{this.delayNumber&&(this.delayNumber--,this.push(s,r))},o)),this.isComplete=!1,s}push(e,t){this.list.push(e),!1===t||this.timer||(this.timer=setTimeout(()=>this.start()))}empty(){this.index=0,this.parallelSuccessNumber=0,this.list=[],this.parallelList=[],this.delayNumber=0}start(){this.running||(this.running=!0,this.isComplete=!1,this.run())}pause(){clearTimeout(this.timer),this.timer=null,this.running=!1}resume(){this.start()}skip(){this.index++,this.resume()}stop(){this.isComplete=!0,this.list.forEach(e=>{e.isComplete||e.cancel()}),this.pause(),this.empty()}run(){this.running&&(this.setParallelList(),this.parallelList.length>1?this.runParallelTasks():this.remain?this.runTask():this.onComplete())}runTask(){let e=this.list[this.index];e?e.run().then(()=>{this.onTask(e),this.index++,e.isCancel?this.runTask():this.nextTask()}).catch(e=>{this.onError(e)}):this.timer=setTimeout(()=>this.nextTask())}runParallelTasks(){this.parallelList.forEach(e=>this.runParallelTask(e))}runParallelTask(e){e.run().then(()=>{this.onTask(e),this.fillParallelTask()}).catch(e=>{this.onParallelError(e)})}nextTask(){this.total===this.finishedIndex?this.onComplete():this.timer=setTimeout(()=>this.run())}setParallelList(){let e,{config:t,list:n,index:r}=this;this.parallelList=[],this.parallelSuccessNumber=0;let i=r+t.parallel;if(i>n.length&&(i=n.length),t.parallel>1)for(let t=r;t<i&&(e=n[t],e.parallel);t++)this.parallelList.push(e)}fillParallelTask(){let e,t=this.parallelList;this.parallelSuccessNumber++,t.pop();let n=t.length,r=this.finishedIndex+n;if(t.length){if(!this.running)return;r<this.total&&(e=this.list[r],e&&e.parallel&&(t.push(e),this.runParallelTask(e)))}else this.index+=this.parallelSuccessNumber,this.parallelSuccessNumber=0,this.nextTask()}onComplete(){this.stop(),this.config.onComplete&&this.config.onComplete()}onTask(e){e.complete(),this.config.onTask&&this.config.onTask()}onParallelError(e){this.parallelList.forEach(e=>{e.parallel=!1}),this.parallelList.length=0,this.parallelSuccessNumber=0,this.onError(e)}onError(e){this.pause(),this.config.onError&&this.config.onError(e)}destroy(){this.stop()}},ya=M.get(`Resource`),ba={tasker:new va,map:{},get isComplete(){return xa.tasker.isComplete},set(e,t){xa.map[e]&&ya.repeat(e),xa.map[e]=t},get:e=>xa.map[e],remove(e){let t=xa.map[e];t&&(t.destroy&&t.destroy(),delete xa.map[e])},loadImage(e,t){return new Promise((n,r)=>{let i=this.setImage(e,e,t);i.load(()=>n(i),e=>r(e))})},setImage(e,t,n){let r;return y(t)?r={url:t}:t.url||(r={url:e,view:t}),r&&(n&&(r.format=n),t=N.image(r)),xa.set(e,t),t},destroy(){xa.map={}}},xa=ba,Sa={maxRecycled:10,recycledList:[],patternTasker:new va,get(e){let t=ba.get(e.url);return t||ba.set(e.url,t=N.image(e)),t.use++,t},recycle(e){e.use--,setTimeout(()=>{e.use||Ca.recycledList.push(e)})},clearRecycled(){let e=Ca.recycledList;e.length>Ca.maxRecycled&&(e.forEach(e=>!e.use&&e.url&&ba.remove(e.url)),e.length=0)},hasAlphaPixel:e=>ma.alphaPixelTypes.some(t=>Ca.isFormat(t,e)),isFormat(e,t){if(t.format)return t.format===e;let{url:n}=t;if(n.startsWith(`data:`)){if(n.startsWith(`data:`+ma.mineType(e)))return!0}else if(n.includes(`.`+e)||n.includes(`.`+ma.upperCaseTypeMap[e])||e===`png`&&!n.includes(`.`))return!0;return!1},destroy(){Ca.recycledList=[]}},Ca=Sa,{IMAGE:wa,create:Ta}=oe,Ea=class{get url(){return this.config.url}get completed(){return this.ready||!!this.error}constructor(e){if(this.use=0,this.waitComplete=[],this.innerId=Ta(wa),this.config=e||={url:``},e.view){let{view:t}=e;this.setView(t.config?t.view:t)}Sa.isFormat(`svg`,e)&&(this.isSVG=!0),Sa.hasAlphaPixel(e)&&(this.hasAlphaPixel=!0)}load(e,t){if(!this.loading){this.loading=!0;let{crossOrigin:e}=this.config;ba.tasker.add(()=>Ut(this,void 0,void 0,function*(){return yield T.origin.loadImage(this.url,_(e)?T.image.crossOrigin:e,this).then(e=>this.setView(e)).catch(e=>{this.error=e,this.onComplete(!1)})}))}return this.waitComplete.push(e,t),this.waitComplete.length-2}unload(e,t){let n=this.waitComplete;if(t){let t=n[e+1];t&&t({type:`stop`})}n[e]=n[e+1]=void 0}setView(e){this.ready=!0,this.width=e.naturalWidth||e.width,this.height=e.naturalHeight||e.height,this.view=e,this.onComplete(!0)}onComplete(e){let t;this.waitComplete.forEach((n,r)=>{t=r%2,n&&(e?t||n(this):t&&n(this.error))}),this.waitComplete.length=0,this.loading=!1}getFull(e){return this.view}getCanvas(e,t,n,r,i,a,o){if(e||=this.width,t||=this.height,this.cache){let{params:e,data:t}=this.cache;for(let n in e)if(e[n]!==arguments[n]){t=null;break}if(t)return t}let s=T.image.resize(this.view,e,t,i,a,void 0,o,n,r);return this.cache=this.use>1?{data:s,params:arguments}:null,s}getPattern(e,t,n,r){let i=T.canvas.createPattern(e,t);return T.image.setPatternTransform(i,n,r),i}destroy(){this.config={url:``},this.cache=null,this.waitComplete.length=0}};function Da(e,t,n,r){r||(n.configurable=n.enumerable=!0),Object.defineProperty(e,t,n)}function Oa(e,t){return Object.getOwnPropertyDescriptor(e,t)}function ka(e,t){let n=`_`+e;return{get(){return this[n]??t},set(e){this[n]=e}}}function z(e,t){return(n,r)=>ja(n,r,e,t&&t(r))}function Aa(e){return e}function ja(e,t,n,r){Da(e,t,Object.assign({get(){return this.__getAttr(t)},set(e){this.__setAttr(t,e)}},r||{})),io(e,t,n)}function Ma(e){return z(e)}function Na(e,t){return z(e,e=>({set(n){this.__setAttr(e,n,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange())}}))}function Pa(e,t){return z(e,e=>({set(n){this.__setAttr(e,n,t)&&(this.__layout.matrixChanged||this.__layout.matrixChange(),this.__scrollWorld||={})}}))}function Fa(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&(this.__hasAutoLayout=!!(this.origin||this.around||this.flow),this.__local||this.__layout.createLocal(),za(this))}}))}function Ia(e,t){return z(e,e=>({set(n){this.__setAttr(e,n,t)&&(this.__layout.scaleChanged||this.__layout.scaleChange())}}))}function La(e,t){return z(e,e=>({set(n){this.__setAttr(e,n,t)&&(this.__layout.rotationChanged||this.__layout.rotationChange())}}))}function B(e,t){return z(e,e=>({set(n){this.__setAttr(e,n,t)&&za(this)}}))}function Ra(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&(za(this),this.__.__removeNaturalSize())}}))}function za(e){e.__layout.boxChanged||e.__layout.boxChange(),e.__hasAutoLayout&&(e.__layout.matrixChanged||e.__layout.matrixChange())}function Ba(e){return z(e,e=>({set(t){let n=this.__;n.__pathInputed!==2&&(n.__pathInputed=t?1:0),t||(n.__pathForRender=void 0),this.__setAttr(e,t),za(this)}}))}var Va=B;function Ha(e,t){return z(e,e=>({set(n){this.__setAttr(e,n)&&(Ua(this),t&&(this.__.__useStroke=!0))}}))}function Ua(e){e.__layout.strokeChanged||e.__layout.strokeChange(),e.__.__useArrow&&za(e)}var Wa=Ha;function Ga(e){return z(e,e=>({set(t){this.__setAttr(e,t),this.__layout.renderChanged||this.__layout.renderChange()}}))}function Ka(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&(this.__layout.surfaceChanged||this.__layout.surfaceChange())}}))}function qa(e){return z(e,e=>({set(t){if(this.__setAttr(e,t)){let e=this.__;w.stintSet(e,`__useDim`,e.dim||e.bright||e.dimskip),this.__layout.surfaceChange()}}}))}function Ja(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&(this.__layout.opacityChanged||this.__layout.opacityChange()),this.mask&&Xa(this)}}))}function Ya(e){return z(e,e=>({set(t){let n=this.visible;if(!0===n&&t===0){if(this.animationOut)return this.__runAnimation(`out`,()=>Za(this,e,t,n))}else n===0&&!0===t&&this.animation&&this.__runAnimation(`in`);Za(this,e,t,n),this.mask&&Xa(this)}}))}function Xa(e){let{parent:t}=e;if(t){let{__hasMask:e}=t;t.__updateMask(),e!==t.__hasMask&&t.forceUpdate()}}function Za(e,t,n,r){e.__setAttr(t,n)&&(e.__layout.opacityChanged||e.__layout.opacityChange(),r!==0&&n!==0||za(e))}function Qa(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&(this.__layout.surfaceChange(),this.waitParent(()=>{this.parent.__layout.childrenSortChange()}))}}))}function $a(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&(this.__layout.boxChanged||this.__layout.boxChange(),this.waitParent(()=>{this.parent.__updateMask(t)}))}}))}function eo(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&this.waitParent(()=>{this.parent.__updateEraser(t)})}}))}function to(e){return z(e,e=>({set(t){this.__setAttr(e,t)&&(this.__layout.hitCanvasChanged=!0,M.showBounds===`hit`&&this.__layout.surfaceChange(),this.leafer&&this.leafer.updateCursor())}}))}function no(e){return z(e,e=>({set(t){this.__setAttr(e,t),this.leafer&&this.leafer.updateCursor()}}))}function ro(e){return(t,n)=>{Da(t,`__DataProcessor`,{get:()=>e})}}function io(e,t,n){let r=e.__DataProcessor.prototype,i=`_`+t,a=function(e){return`set`+e.charAt(0).toUpperCase()+e.slice(1)}(t),o=ka(t,n);if(_(n))o.get=function(){return this[i]};else if(typeof n==`function`)o.get=function(){return this[i]??n(this.__leaf)};else if(C(n)){let e=ee(n);o.get=function(){return this[i]??(this[i]=e?{}:w.clone(n))}}let s=e.isBranchLeaf;t===`width`?o.get=function(){let e=this[i];if(e==null){let e=this,t=e.__naturalWidth,r=e.__leaf;return!n||r.pathInputed?r.boxBounds.width:t?e._height&&e.__useNaturalRatio?e._height*t/e.__naturalHeight:t:s&&r.children.length?r.boxBounds.width:n}return e}:t===`height`&&(o.get=function(){let e=this[i];if(e==null){let e=this,t=e.__naturalHeight,r=e.__leaf;return!n||r.pathInputed?r.boxBounds.height:t?e._width&&e.__useNaturalRatio?e._width*t/e.__naturalWidth:t:s&&r.children.length?r.boxBounds.height:n}return e});let c,l=r;for(;!c&&l;)c=Oa(l,t),l=l.__proto__;c&&c.set&&(o.set=c.set),r[a]&&(o.set=r[a],delete r[a]),Da(r,t,o)}var ao=new M(`rewrite`),oo=[],so=[`destroy`,`constructor`];function co(e){return(t,n)=>{oo.push({name:t.constructor.name+`.`+n,run:()=>{t[n]=e}})}}function lo(){return e=>{uo()}}function uo(e){oo.length&&=(oo.forEach(t=>{e&&ao.error(t.name,`Class@rewriteAble()`),t.run()}),0)}function fo(e,t){return n=>{var r;(e.prototype?(r=e.prototype,Object.getOwnPropertyNames(r)):Object.keys(e)).forEach(r=>{so.includes(r)||t&&t.includes(r)||(e.prototype?Oa(e.prototype,r).writable&&(n.prototype[r]=e.prototype[r]):n.prototype[r]=e[r])})}}function po(){return e=>{Lt.register(e)}}function mo(){return e=>{Bt.register(e)}}setTimeout(()=>uo(!0));var{copy:ho,toInnerPoint:go,toOuterPoint:_o,scaleOfOuter:vo,rotateOfOuter:yo,skewOfOuter:bo,multiplyParent:xo,divideParent:So,getLayout:Co}=D,V={},{round:wo}=Math,To={updateAllMatrix(e,t,n){if(t&&e.__hasAutoLayout&&e.__layout.matrixChanged&&(n=!0),Do(e,t,n),e.isBranch){let{children:r}=e;for(let e=0,i=r.length;e<i;e++)Eo(r[e],t,n)}},updateMatrix(e,t,n){let r=e.__layout;t?n&&(r.waitAutoLayout=!0,e.__hasAutoLayout&&(r.matrixChanged=!1)):r.waitAutoLayout&&=!1,r.matrixChanged&&e.__updateLocalMatrix(),r.waitAutoLayout||e.__updateWorldMatrix()},updateBounds(e){let t=e.__layout;t.boundsChanged&&e.__updateLocalBounds(),t.waitAutoLayout||e.__updateWorldBounds()},updateAllWorldOpacity(e){if(e.__updateWorldOpacity(),e.isBranch){let{children:t}=e;for(let e=0,n=t.length;e<n;e++)Oo(t[e])}},updateChange(e){let t=e.__layout;t.stateStyleChanged&&e.updateState(),t.opacityChanged&&Oo(e),e.__updateChange()},updateAllChange(e){if(Ao(e),e.isBranch){let{children:t}=e;for(let e=0,n=t.length;e<n;e++)ko(t[e])}},worldHittable(e){for(;e;){if(!e.__.hittable)return!1;e=e.parent}return!0},draggable:e=>(e.draggable||e.editable)&&e.hitSelf&&!e.locked,copyCanvasByWorld(e,t,n,r,i,a){r||=e.__nowWorld,e.__worldFlipped||T.fullImageShadow?t.copyWorldByReset(n,r,e.__nowWorld,i,a):t.copyWorldToInner(n,r,e.__layout.renderBounds,i)},moveWorld(e,t,n=0,r,i){let a=C(t)?Object.assign({},t):{x:t,y:n};r?_o(e.localTransform,a,a,!0):e.parent&&go(e.parent.scrollWorldTransform,a,a,!0),H.moveLocal(e,a.x,a.y,i)},moveLocal(e,t,n=0,r){C(t)&&(n=t.y,t=t.x),t+=e.x,n+=e.y,e.leafer&&e.leafer.config.pointSnap&&(t=wo(t),n=wo(n)),r?e.animate({x:t,y:n},r):(e.x=t,e.y=n)},zoomOfWorld(e,t,n,r,i,a){H.zoomOfLocal(e,jo(e,t),n,r,i,a)},zoomOfLocal(e,t,n,r=n,i,a){let o=e.__localMatrix;if(x(r)||(r&&(a=r),r=n),ho(V,o),vo(V,t,n,r),H.hasHighPosition(e))H.setTransform(e,V,i,a);else{let t=e.x+V.e-o.e,s=e.y+V.f-o.f;a&&!i?e.animate({x:t,y:s,scaleX:e.scaleX*n,scaleY:e.scaleY*r},a):(e.x=t,e.y=s,e.scaleResize(n,r,!0!==i))}},rotateOfWorld(e,t,n,r){H.rotateOfLocal(e,jo(e,t),n,r)},rotateOfLocal(e,t,n,r){let i=e.__localMatrix;ho(V,i),yo(V,t,n),H.hasHighPosition(e)?H.setTransform(e,V,!1,r):e.set({x:e.x+V.e-i.e,y:e.y+V.f-i.f,rotation:Ce.formatRotation(e.rotation+n)},r)},skewOfWorld(e,t,n,r,i,a){H.skewOfLocal(e,jo(e,t),n,r,i,a)},skewOfLocal(e,t,n,r=0,i,a){ho(V,e.__localMatrix),bo(V,t,n,r),H.setTransform(e,V,i,a)},transformWorld(e,t,n,r){ho(V,e.worldTransform),xo(V,t),e.parent&&So(V,e.parent.scrollWorldTransform),H.setTransform(e,V,n,r)},transform(e,t,n,r){ho(V,e.localTransform),xo(V,t),H.setTransform(e,V,n,r)},setTransform(e,t,n,r){let i=e.__,a=i.origin&&H.getInnerOrigin(e,i.origin),o=Co(t,a,i.around&&H.getInnerOrigin(e,i.around));if(H.hasOffset(e)&&(o.x-=i.offsetX,o.y-=i.offsetY),n){let t=o.scaleX/e.scaleX,n=o.scaleY/e.scaleY;if(delete o.scaleX,delete o.scaleY,a){A.scale(e.boxBounds,Math.abs(t),Math.abs(n));let r=H.getInnerOrigin(e,i.origin);k.move(o,a.x-r.x,a.y-r.y)}e.set(o),e.scaleResize(t,n,!1)}else e.set(o,r)},getFlipTransform(e,t){let n={a:1,b:0,c:0,d:1,e:0,f:0},r=t===`x`?1:-1;return vo(n,H.getLocalOrigin(e,`center`),-1*r,1*r),n},getLocalOrigin:(e,t)=>k.tempToOuterOf(H.getInnerOrigin(e,t),e.localTransform),getInnerOrigin(e,t){let n={};return nt.toPoint(t,e.boxBounds,n),n},getRelativeWorld:(e,t,n)=>(ho(V,e.worldTransform),So(V,t.scrollWorldTransform),n?V:Object.assign({},V)),drop(e,t,n,r){e.setTransform(H.getRelativeWorld(e,t,!0),r),t.add(e,n)},hasHighPosition:e=>e.origin||e.around||H.hasOffset(e),hasOffset:e=>e.offsetX||e.offsetY,hasParent(e,t){if(!t)return!1;for(;e;){if(t===e)return!0;e=e.parent}},animateMove(e,t,n=.3){if(t.x||t.y)if(Math.abs(t.x)<1&&Math.abs(t.y)<1)e.move(t);else{let r=t.x*n,i=t.y*n;t.x-=r,t.y-=i,e.move(r,i),T.requestRender(()=>H.animateMove(e,t,n))}}},H=To,{updateAllMatrix:Eo,updateMatrix:Do,updateAllWorldOpacity:Oo,updateAllChange:ko,updateChange:Ao}=H;function jo(e,t){return e.updateLayout(),e.parent?k.tempToInnerOf(t,e.parent.scrollWorldTransform):t}var Mo={worldBounds:e=>e.__world,localBoxBounds:e=>e.__.eraser||e.__.visible===0?null:e.__local||e.__layout,localStrokeBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localStrokeBounds,localRenderBounds:e=>e.__.eraser||e.__.visible===0?null:e.__layout.localRenderBounds,maskLocalBoxBounds:(e,t)=>Po(e,t)&&e.__localBoxBounds,maskLocalStrokeBounds:(e,t)=>Po(e,t)&&e.__layout.localStrokeBounds,maskLocalRenderBounds:(e,t)=>Po(e,t)&&e.__layout.localRenderBounds,excludeRenderBounds:(e,t)=>!(!t.bounds||t.bounds.hit(e.__world,t.matrix))||!(!t.hideBounds||!t.hideBounds.includes(e.__world,t.matrix))},No;function Po(e,t){return t||(No=0),e.__.mask&&(No=1),No<0?null:(No&&=-1,!0)}var{updateBounds:Fo}=To,Io={sort:(e,t)=>e.__.zIndex===t.__.zIndex?e.__tempNumber-t.__tempNumber:e.__.zIndex-t.__.zIndex,pushAllChildBranch(e,t){if(e.__tempNumber=1,e.__.__childBranchNumber){let{children:n}=e;for(let r=0,i=n.length;r<i;r++)(e=n[r]).isBranch&&(e.__tempNumber=1,t.add(e),Lo(e,t))}},pushAllParent(e,t){let{keys:n}=t;if(n)for(;e.parent&&_(n[e.parent.innerId]);)t.add(e.parent),e=e.parent;else for(;e.parent;)t.add(e.parent),e=e.parent},pushAllBranchStack(e,t){let n=t.length,{children:r}=e;for(let e=0,n=r.length;e<n;e++)r[e].isBranch&&t.push(r[e]);for(let e=n,r=t.length;e<r;e++)Ro(t[e],t)},updateBounds(e,t){let n=[e];Ro(e,n),zo(n,t)},updateBoundsByBranchStack(e,t){let n,r;for(let i=e.length-1;i>-1;i--){n=e[i],r=n.children;for(let e=0,t=r.length;e<t;e++)Fo(r[e]);t&&t===n||Fo(n)}}},{pushAllChildBranch:Lo,pushAllBranchStack:Ro,updateBoundsByBranchStack:zo}=Io,Bo={run(e){if(e&&e.length){let t=e.length;for(let n=0;n<t;n++)e[n]();e.length===t?e.length=0:e.splice(0,t)}}},{getRelativeWorld:Vo,updateBounds:Ho}=To,{toOuterOf:Uo,getPoints:Wo,copy:Go}=A,Ko=`_localContentBounds`,qo=`_worldContentBounds`,Jo=`_worldBoxBounds`,Yo=`_worldStrokeBounds`,Xo=class{get contentBounds(){return this._contentBounds||this.boxBounds}set contentBounds(e){this._contentBounds=e}get strokeBounds(){return this._strokeBounds||this.boxBounds}get renderBounds(){return this._renderBounds||this.boxBounds}set renderBounds(e){this._renderBounds=e}get localContentBounds(){return Uo(this.contentBounds,this.leaf.__localMatrix,this[Ko]||(this[Ko]={})),this[Ko]}get localStrokeBounds(){return this._localStrokeBounds||this}get localRenderBounds(){return this._localRenderBounds||this}get worldContentBounds(){return Uo(this.contentBounds,this.leaf.__world,this[qo]||(this[qo]={})),this[qo]}get worldBoxBounds(){return Uo(this.boxBounds,this.leaf.__world,this[Jo]||(this[Jo]={})),this[Jo]}get worldStrokeBounds(){return Uo(this.strokeBounds,this.leaf.__world,this[Yo]||(this[Yo]={})),this[Yo]}get a(){return 1}get b(){return 0}get c(){return 0}get d(){return 1}get e(){return this.leaf.__.x}get f(){return this.leaf.__.y}get x(){return this.e+this.boxBounds.x}get y(){return this.f+this.boxBounds.y}get width(){return this.boxBounds.width}get height(){return this.boxBounds.height}constructor(e){this.leaf=e,this.leaf.__local&&(this._localRenderBounds=this._localStrokeBounds=this.leaf.__local),e.__world&&(this.boxBounds={x:0,y:0,width:0,height:0},this.boxChange(),this.matrixChange())}createLocal(){let e=this.leaf.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0};this._localStrokeBounds||=e,this._localRenderBounds||=e}update(){let{leaf:e}=this,{leafer:t}=e;if(e.isApp)return Ho(e);if(t)t.ready?t.watcher.changed&&t.layouter.layout():t.start();else{let t=e;for(;t.parent&&!t.parent.leafer;)t=t.parent;let n=t;if(n.__fullLayouting)return;n.__fullLayouting=!0,T.layout(n),delete n.__fullLayouting}}getTransform(e=`world`){this.update();let{leaf:t}=this;switch(e){case`world`:return t.__world;case`local`:return t.__localMatrix;case`inner`:return D.defaultMatrix;case`page`:e=t.zoomLayer;default:return Vo(t,e)}}getBounds(e,t=`world`){switch(this.update(),t){case`world`:return this.getWorldBounds(e);case`local`:return this.getLocalBounds(e);case`inner`:return this.getInnerBounds(e);case`page`:t=this.leaf.zoomLayer;default:return new wt(this.getInnerBounds(e)).toOuterOf(this.getTransform(t))}}getInnerBounds(e=`box`){switch(e){case`render`:return this.renderBounds;case`content`:if(this.contentBounds)return this.contentBounds;case`box`:return this.boxBounds;case`stroke`:return this.strokeBounds}}getLocalBounds(e=`box`){switch(e){case`render`:return this.localRenderBounds;case`stroke`:return this.localStrokeBounds;case`content`:if(this.contentBounds)return this.localContentBounds;case`box`:return this.leaf.__localBoxBounds}}getWorldBounds(e=`box`){switch(e){case`render`:return this.leaf.__world;case`stroke`:return this.worldStrokeBounds;case`content`:if(this.contentBounds)return this.worldContentBounds;case`box`:return this.worldBoxBounds}}getLayoutBounds(e,t=`world`,n){let{leaf:r}=this,i,a,o,s=this.getInnerBounds(e);switch(t){case`world`:i=r.getWorldPoint(s),a=r.__world;break;case`local`:let{scaleX:e,scaleY:n,rotation:c,skewX:l,skewY:u}=r.__;o={scaleX:e,scaleY:n,rotation:c,skewX:l,skewY:u},i=r.getLocalPointByInner(s);break;case`inner`:i=s,a=D.defaultMatrix;break;case`page`:t=r.zoomLayer;default:i=r.getWorldPoint(s,t),a=Vo(r,t,!0)}if(o||=D.getLayout(a),Go(o,s),k.copy(o,i),n){let{scaleX:e,scaleY:t}=o,n=Math.abs(e),r=Math.abs(t);n===1&&r===1||(o.scaleX/=n,o.scaleY/=r,o.width*=n,o.height*=r)}return o}getLayoutPoints(e,t=`world`){let{leaf:n}=this,r=Wo(this.getInnerBounds(e)),i;switch(t){case`world`:i=null;break;case`local`:i=n.parent;break;case`inner`:break;case`page`:t=n.zoomLayer;default:i=t}return _(i)||r.forEach(e=>n.innerToWorld(e,null,!1,i)),r}shrinkContent(){let{x:e,y:t,width:n,height:r}=this.boxBounds;this._contentBounds={x:e,y:t,width:n,height:r}}spreadStroke(){let{x:e,y:t,width:n,height:r}=this.strokeBounds;this._strokeBounds={x:e,y:t,width:n,height:r},this._localStrokeBounds={x:e,y:t,width:n,height:r},this.renderSpread||this.spreadRenderCancel()}spreadRender(){let{x:e,y:t,width:n,height:r}=this.renderBounds;this._renderBounds={x:e,y:t,width:n,height:r},this._localRenderBounds={x:e,y:t,width:n,height:r}}shrinkContentCancel(){this._contentBounds=void 0}spreadStrokeCancel(){let e=this.renderBounds===this.strokeBounds;this._strokeBounds=this.boxBounds,this._localStrokeBounds=this.leaf.__localBoxBounds,e&&this.spreadRenderCancel()}spreadRenderCancel(){this._renderBounds=this._strokeBounds,this._localRenderBounds=this._localStrokeBounds}boxChange(){this.boxChanged=!0,this.localBoxChanged?this.boundsChanged||=!0:this.localBoxChange(),this.hitCanvasChanged=!0}localBoxChange(){this.localBoxChanged=!0,this.boundsChanged=!0}strokeChange(){this.strokeChanged=!0,this.strokeSpread||=1,this.boundsChanged=!0,this.hitCanvasChanged=!0}renderChange(){this.renderChanged=!0,this.renderSpread||=1,this.boundsChanged=!0}scaleChange(){this.scaleChanged=!0,this._scaleOrRotationChange()}rotationChange(){this.rotationChanged=!0,this.affectRotation=!0,this._scaleOrRotationChange()}_scaleOrRotationChange(){this.affectScaleOrRotation=!0,this.matrixChange(),this.leaf.__local||this.createLocal()}matrixChange(){this.matrixChanged=!0,this.localBoxChanged?this.boundsChanged||=!0:this.localBoxChange()}surfaceChange(){this.surfaceChanged=!0}opacityChange(){this.opacityChanged=!0,this.surfaceChanged||this.surfaceChange()}childrenSortChange(){this.childrenSortChanged||(this.childrenSortChanged=this.affectChildrenSort=!0,this.leaf.forceUpdate(`surface`))}destroy(){}},Zo=class{constructor(e,t){this.bubbles=!1,this.type=e,t&&(this.target=t)}stopDefault(){this.isStopDefault=!0,this.origin&&T.event.stopDefault(this.origin)}stopNow(){this.isStopNow=!0,this.isStop=!0,this.origin&&T.event.stopNow(this.origin)}stop(){this.isStop=!0,this.origin&&T.event.stop(this.origin)}},Qo=class extends Zo{constructor(e,t,n){super(e,t),this.parent=n,this.child=t}};Qo.ADD=`child.add`,Qo.REMOVE=`child.remove`,Qo.CREATED=`created`,Qo.MOUNTED=`mounted`,Qo.UNMOUNTED=`unmounted`,Qo.DESTROY=`destroy`;var $o=`property.scroll`,es=class extends Zo{constructor(e,t,n,r,i){super(e,t),this.attrName=n,this.oldValue=r,this.newValue=i}};es.CHANGE=`property.change`,es.LEAFER_CHANGE=`property.leafer_change`,es.SCROLL=$o;var ts={scrollX:$o,scrollY:$o},ns=class extends Zo{constructor(e,t){super(e),Object.assign(this,t)}};ns.LOAD=`image.load`,ns.LOADED=`image.loaded`,ns.ERROR=`image.error`;var rs=class extends Zo{static checkHas(e,t,n){n===`on`?t===ss?e.__hasWorldEvent=!0:e.__hasLocalEvent=!0:(e.__hasLocalEvent=e.hasEvent(is)||e.hasEvent(as)||e.hasEvent(os),e.__hasWorldEvent=e.hasEvent(ss))}static emitLocal(e){if(e.leaferIsReady){let{resized:t}=e.__layout;t!==`local`&&(e.emit(is,e),t===`inner`&&e.emit(as,e)),e.emit(os,e)}}static emitWorld(e){e.leaferIsReady&&e.emit(ss,this)}};rs.RESIZE=`bounds.resize`,rs.INNER=`bounds.inner`,rs.LOCAL=`bounds.local`,rs.WORLD=`bounds.world`;var{RESIZE:is,INNER:as,LOCAL:os,WORLD:ss}=rs,cs={};[is,as,os,ss].forEach(e=>cs[e]=1);var ls=class e extends Zo{get bigger(){if(!this.old)return!0;let{width:e,height:t}=this.old;return this.width>=e&&this.height>=t}get smaller(){return!this.bigger}get samePixelRatio(){return!this.old||this.pixelRatio===this.old.pixelRatio}constructor(t,n){C(t)?(super(e.RESIZE),Object.assign(this,t)):super(t),this.old=n}static isResizing(e){return this.resizingKeys&&!_(this.resizingKeys[e.innerId])}};ls.RESIZE=`resize`;var us=class extends Zo{constructor(e,t){super(e),this.data=t}};us.REQUEST=`watch.request`,us.DATA=`watch.data`;var U=class extends Zo{constructor(e,t,n){super(e),t&&(this.data=t,this.times=n)}};U.REQUEST=`layout.request`,U.START=`layout.start`,U.BEFORE=`layout.before`,U.LAYOUT=`layout`,U.AFTER=`layout.after`,U.AGAIN=`layout.again`,U.END=`layout.end`;var W=class extends Zo{constructor(e,t,n,r){super(e),t&&(this.times=t),n&&(this.renderBounds=n,this.renderOptions=r)}};W.REQUEST=`render.request`,W.CHILD_START=`render.child_start`,W.CHILD_END=`render.child_end`,W.START=`render.start`,W.BEFORE=`render.before`,W.RENDER=`render`,W.AFTER=`render.after`,W.AGAIN=`render.again`,W.END=`render.end`,W.NEXT=`render.next`;var G=class extends Zo{};G.START=`leafer.start`,G.BEFORE_READY=`leafer.before_ready`,G.READY=`leafer.ready`,G.AFTER_READY=`leafer.after_ready`,G.VIEW_READY=`leafer.view_ready`,G.VIEW_COMPLETED=`leafer.view_completed`,G.STOP=`leafer.stop`,G.RESTART=`leafer.restart`,G.END=`leafer.end`,G.UPDATE_MODE=`leafer.update_mode`,G.TRANSFORM=`leafer.transform`,G.MOVE=`leafer.move`,G.SCALE=`leafer.scale`,G.ROTATE=`leafer.rotate`,G.SKEW=`leafer.skew`;var{MOVE:ds,SCALE:fs,ROTATE:ps,SKEW:ms}=G,hs={x:ds,y:ds,scaleX:fs,scaleY:fs,rotation:ps,skewX:ms,skewY:ms},gs={},_s=class{set event(e){this.on(e)}on(e,t,n){if(!t){let t;if(S(e))e.forEach(e=>this.on(e[0],e[1],e[2]));else for(let n in e)S(t=e[n])?this.on(n,t[0],t[1]):this.on(n,t);return}let r,i,a;n&&(n===`once`?i=!0:typeof n==`boolean`?r=n:(r=n.capture,i=n.once));let o=vs(this,r,!0),s=y(e)?e.split(` `):e,c=i?{listener:t,once:i}:{listener:t};s.forEach(e=>{e&&(a=o[e],a?a.findIndex(e=>e.listener===t)===-1&&a.push(c):o[e]=[c],cs[e]&&rs.checkHas(this,e,`on`))})}off(e,t,n){if(e){let r=y(e)?e.split(` `):e;if(t){let e,i,a;n&&(e=typeof n==`boolean`?n:n!==`once`&&n.capture);let o=vs(this,e);r.forEach(e=>{e&&(i=o[e],i&&(a=i.findIndex(e=>e.listener===t),a>-1&&i.splice(a,1),i.length||delete o[e],cs[e]&&rs.checkHas(this,e,`off`)))})}else{let{__bubbleMap:e,__captureMap:t}=this;r.forEach(n=>{e&&delete e[n],t&&delete t[n]})}}else this.__bubbleMap=this.__captureMap=void 0}on_(e,t,n,r){return t?this.on(e,n?t=t.bind(n):t,r):S(e)&&e.forEach(e=>this.on(e[0],e[2]?e[1]=e[1].bind(e[2]):e[1],e[3])),{type:e,current:this,listener:t,options:r}}off_(e){if(!e)return;let t=S(e)?e:[e];t.forEach(e=>{e&&(e.listener?e.current.off(e.type,e.listener,e.options):S(e.type)&&e.type.forEach(t=>e.current.off(t[0],t[1],t[3])))}),t.length=0}once(e,t,n,r){if(!t)return S(e)&&e.forEach(e=>this.once(e[0],e[1],e[2],e[3]));C(n)?t=t.bind(n):r=n,this.on(e,t,{once:!0,capture:r})}emit(e,t,n){!t&&Bt.has(e)&&(t=Bt.get(e,{type:e,target:this,current:this}));let r=vs(this,n)[e];if(r){let i;for(let a=0,o=r.length;a<o&&!((i=r[a])&&(i.listener(t),i.once&&(this.off(e,i.listener,n),a--,o--),t&&t.isStopNow));a++);}this.syncEventer&&this.syncEventer.emitEvent(t,n)}emitEvent(e,t){e.current=this,this.emit(e.type,e,t)}hasEvent(e,t){if(this.syncEventer&&this.syncEventer.hasEvent(e,t))return!0;let{__bubbleMap:n,__captureMap:r}=this,i=n&&n[e],a=r&&r[e];return!!(_(t)?i||a:t?a:i)}destroy(){this.__captureMap=this.__bubbleMap=this.syncEventer=null}};function vs(e,t,n){if(t){let{__captureMap:t}=e;return t||(n?e.__captureMap={}:gs)}{let{__bubbleMap:t}=e;return t||(n?e.__bubbleMap={}:gs)}}var{on:ys,on_:bs,off:xs,off_:Ss,once:Cs,emit:ws,emitEvent:Ts,hasEvent:Es,destroy:Ds}=_s.prototype,Os={on:ys,on_:bs,off:xs,off_:Ss,once:Cs,emit:ws,emitEvent:Ts,hasEvent:Es,destroyEventer:Ds},ks=M.get(`setAttr`),As={__setAttr(e,t,n){if(this.leaferIsCreated){let r=this.__.__getInput(e);if(!n||b(t)||_(t)||(ks.warn(this.innerName,e,t),t=void 0),C(t)||r!==t){if(this.__realSetAttr(e,t),this.isLeafer){this.emitEvent(new es(es.LEAFER_CHANGE,this,e,r,t));let n=hs[e];n&&(this.emitEvent(new G(n,this)),this.emitEvent(new G(G.TRANSFORM,this)))}this.emitPropertyEvent(es.CHANGE,e,r,t);let n=ts[e];return n&&this.emitPropertyEvent(n,e,r,t),!0}return!1}return this.__realSetAttr(e,t),!0},emitPropertyEvent(e,t,n,r){let i=new es(e,this,t,n,r);this.isLeafer||this.hasEvent(e)&&this.emitEvent(i),this.leafer.emitEvent(i)},__realSetAttr(e,t){let n=this.__;n[e]=t,this.__proxyData&&this.setProxyAttr(e,t),n.normalStyle&&(this.lockNormalStyle||_(n.normalStyle[e])||(n.normalStyle[e]=t))},__getAttr(e){return this.__proxyData?this.getProxyAttr(e):this.__.__get(e)}},{setLayout:js,multiplyParent:Ms,translateInner:Ns,defaultWorld:Ps}=D,{toPoint:Fs,tempPoint:Is}=nt,Ls={__updateWorldMatrix(){let{parent:e,__layout:t,__world:n,__scrollWorld:r,__:i}=this;Ms(this.__local||t,e?e.__scrollWorld||e.__world:Ps,n,!!t.affectScaleOrRotation,i),r&&Ns(Object.assign(r,n),i.scrollX,i.scrollY)},__updateLocalMatrix(){if(this.__local){let e=this.__layout,t=this.__local,n=this.__;e.affectScaleOrRotation&&(e.scaleChanged&&(e.resized||=`scale`)||e.rotationChanged)&&(js(t,n,null,null,e.affectRotation),e.scaleChanged=e.rotationChanged=void 0),t.e=n.x+n.offsetX,t.f=n.y+n.offsetY,(n.around||n.origin)&&(Fs(n.around||n.origin,e.boxBounds,Is),Ns(t,-Is.x,-Is.y,!n.around))}this.__layout.matrixChanged=void 0}},{updateMatrix:Rs,updateAllMatrix:zs}=To,{updateBounds:Bs}=Io,{toOuterOf:Vs,copyAndSpread:Hs,copy:Us}=A,{toBounds:Ws}=na,Gs={__updateWorldBounds(){let{__layout:e,__world:t}=this;Vs(e.renderBounds,t,t),e.resized&&=(e.resized===`inner`&&this.__onUpdateSize(),this.__hasLocalEvent&&rs.emitLocal(this),void 0),this.__hasWorldEvent&&rs.emitWorld(this)},__updateLocalBounds(){let e=this.__layout;e.boxChanged&&(this.__.__pathInputed||this.__updatePath(),this.__updateRenderPath(),this.__updateBoxBounds(),e.resized=`inner`),e.localBoxChanged&&(this.__local&&this.__updateLocalBoxBounds(),e.localBoxChanged=void 0,e.strokeSpread&&(e.strokeChanged=!0),e.renderSpread&&(e.renderChanged=!0),this.parent&&this.parent.__layout.boxChange()),e.boxChanged=void 0,e.strokeChanged&&(e.strokeSpread=this.__updateStrokeSpread(),e.strokeSpread?(e.strokeBounds===e.boxBounds&&e.spreadStroke(),this.__updateStrokeBounds(),this.__updateLocalStrokeBounds()):e.spreadStrokeCancel(),e.strokeChanged=void 0,(e.renderSpread||e.strokeSpread!==e.strokeBoxSpread)&&(e.renderChanged=!0),this.parent&&this.parent.__layout.strokeChange(),e.resized=`inner`),e.renderChanged&&(e.renderSpread=this.__updateRenderSpread(),e.renderSpread?(e.renderBounds!==e.boxBounds&&e.renderBounds!==e.strokeBounds||e.spreadRender(),this.__updateRenderBounds(),this.__updateLocalRenderBounds()):e.spreadRenderCancel(),e.renderChanged=void 0,this.parent&&this.parent.__layout.renderChange()),e.resized||=`local`,e.boundsChanged=void 0},__updateLocalBoxBounds(){this.__hasMotionPath&&this.__updateMotionPath(),this.__hasAutoLayout&&this.__updateAutoLayout(),Vs(this.__layout.boxBounds,this.__local,this.__local)},__updateLocalStrokeBounds(){Vs(this.__layout.strokeBounds,this.__localMatrix,this.__layout.localStrokeBounds)},__updateLocalRenderBounds(){Vs(this.__layout.renderBounds,this.__localMatrix,this.__layout.localRenderBounds)},__updateBoxBounds(e,t){let n=this.__layout.boxBounds,r=this.__;r.__usePathBox?Ws(r.path,n):(n.x=0,n.y=0,n.width=r.width,n.height=r.height)},__updateAutoLayout(){this.__layout.matrixChanged=!0,this.isBranch?(this.__extraUpdate(),this.__.flow?(this.__layout.boxChanged&&this.__updateFlowLayout(),zs(this),Bs(this,this),this.__.__autoSide&&this.__updateBoxBounds(!0)):(zs(this),Bs(this,this))):Rs(this)},__updateNaturalSize(){let{__:e,__layout:t}=this;e.__naturalWidth=t.boxBounds.width,e.__naturalHeight=t.boxBounds.height},__updateStrokeBounds(e){let t=this.__layout;Hs(t.strokeBounds,t.boxBounds,t.strokeBoxSpread)},__updateRenderBounds(e){let t=this.__layout,{renderSpread:n}=t;x(n)&&n<=0?Us(t.renderBounds,t.strokeBounds):Hs(t.renderBounds,t.boxBounds,n)}},Ks={__render(e,t){if(t.shape)return this.__renderShape(e,t);if(this.__worldOpacity){let n=this.__;if(n.bright&&!t.topRendering)return t.topList.add(this);if(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),e.opacity=t.dimOpacity&&!n.dimskip?n.opacity*t.dimOpacity:n.opacity,this.__.__single){if(n.eraser===`path`)return this.__renderEraser(e,t);let r=e.getSameCanvas(!0,!0);this.__draw(r,t,e),To.copyCanvasByWorld(this,e,r,this.__nowWorld,n.__blendMode,!0),r.recycle(this.__nowWorld)}else this.__draw(e,t);M.showBounds&&M.drawBounds(this,e,t)}},__renderShape(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawShape(e,t))},__clip(e,t){this.__worldOpacity&&(e.setWorld(this.__nowWorld=this.__getNowWorld(t)),this.__drawRenderPath(e),e.clipUI(this))},__updateWorldOpacity(){this.__worldOpacity=this.__.visible?this.parent?this.parent.__worldOpacity*this.__.opacity:this.__.opacity:0,this.__layout.opacityChanged&&(this.__layout.opacityChanged=!1)}},{excludeRenderBounds:qs}=Mo,Js={__updateChange(){let{__layout:e}=this;e.childrenSortChanged&&=(this.__updateSortChildren(),!1),this.__.__checkSingle()},__render(e,t){if(this.__nowWorld=this.__getNowWorld(t),this.__worldOpacity){let n=this.__;if(n.__useDim)if(n.dim)t.dimOpacity=!0===n.dim?.2:n.dim;else{if(n.bright&&!t.topRendering)return t.topList.add(this);n.dimskip&&t.dimOpacity&&(t.dimOpacity=0)}if(n.__single&&!this.isBranchLeaf){if(n.eraser===`path`)return this.__renderEraser(e,t);let r=e.getSameCanvas(!1,!0);this.__renderBranch(r,t);let i=this.__nowWorld;e.opacity=t.dimOpacity?n.opacity*t.dimOpacity:n.opacity,e.copyWorldByReset(r,i,i,n.__blendMode,!0),r.recycle(i)}else this.__renderBranch(e,t)}},__renderBranch(e,t){if(this.__hasMask)this.__renderMask(e,t);else{let{children:n}=this;for(let r=0,i=n.length;r<i;r++)qs(n[r],t)||n[r].__render(e,t)}},__clip(e,t){if(this.__worldOpacity){let{children:n}=this;for(let r=0,i=n.length;r<i;r++)qs(n[r],t)||n[r].__clip(e,t)}}},Ys={},{LEAF:Xs,create:Zs}=oe,{stintSet:Qs}=w,{toInnerPoint:$s,toOuterPoint:ec,multiplyParent:tc}=D,{toOuterOf:nc}=A,{copy:rc,move:ic}=k,{moveLocal:ac,zoomOfLocal:oc,rotateOfLocal:sc,skewOfLocal:cc,moveWorld:lc,zoomOfWorld:uc,rotateOfWorld:dc,skewOfWorld:fc,transform:pc,transformWorld:mc,setTransform:hc,getFlipTransform:gc,getLocalOrigin:_c,getRelativeWorld:vc,drop:yc}=To,bc=class{get tag(){return this.__tag}set tag(e){}get __tag(){return`Leaf`}get innerName(){return this.__.name||this.tag+this.innerId}get __DataProcessor(){return ne}get __LayoutProcessor(){return Xo}get leaferIsCreated(){return this.leafer&&this.leafer.created}get leaferIsReady(){return this.leafer&&this.leafer.ready}get isLeafer(){return!1}get isBranch(){return!1}get isBranchLeaf(){return!1}get __localMatrix(){return this.__local||this.__layout}get __localBoxBounds(){return this.__local||this.__layout}get worldTransform(){return this.__layout.getTransform(`world`)}get localTransform(){return this.__layout.getTransform(`local`)}get scrollWorldTransform(){return this.updateLayout(),this.__scrollWorld||this.__world}get boxBounds(){return this.getBounds(`box`,`inner`)}get renderBounds(){return this.getBounds(`render`,`inner`)}get worldBoxBounds(){return this.getBounds(`box`)}get worldStrokeBounds(){return this.getBounds(`stroke`)}get worldRenderBounds(){return this.getBounds(`render`)}get worldOpacity(){return this.updateLayout(),this.__worldOpacity}get __worldFlipped(){return this.__world.scaleX<0||this.__world.scaleY<0}get __onlyHitMask(){return this.__hasMask&&!this.__.hitChildren}get __ignoreHitWorld(){return(this.__hasMask||this.__hasEraser)&&this.__.hitChildren}get __inLazyBounds(){return this.leaferIsCreated&&this.leafer.lazyBounds.hit(this.__world)}get pathInputed(){return this.__.__pathInputed}set event(e){this.on(e)}constructor(e){this.innerId=Zs(Xs),this.reset(e),this.__bubbleMap&&this.__emitLifeEvent(Qo.CREATED)}reset(e){this.leafer&&this.leafer.forceRender(this.__world),e!==0&&(this.__world={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0,scaleX:1,scaleY:1},e!==null&&(this.__local={a:1,b:0,c:0,d:1,e:0,f:0,x:0,y:0,width:0,height:0})),this.__worldOpacity=1,this.__=new this.__DataProcessor(this),this.__layout=new this.__LayoutProcessor(this),this.__level&&this.resetCustom(),e&&(e.__&&(e=e.toJSON()),e.children?this.set(e):Object.assign(this,e))}resetCustom(){this.__hasMask=this.__hasEraser=null,this.forceUpdate()}waitParent(e,t){t&&(e=e.bind(t)),this.parent?e():this.on(Qo.ADD,e,`once`)}waitLeafer(e,t){t&&(e=e.bind(t)),this.leafer?e():this.on(Qo.MOUNTED,e,`once`)}nextRender(e,t,n){this.leafer?this.leafer.nextRender(e,t,n):this.waitLeafer(()=>this.leafer.nextRender(e,t,n))}removeNextRender(e){this.nextRender(e,null,`off`)}__bindLeafer(e){if(this.isLeafer&&e!==null&&(e=this),this.leafer&&!e&&this.leafer.leafs--,this.leafer=e,e?(e.leafs++,this.__level=this.parent?this.parent.__level+1:1,this.animation&&this.__runAnimation(`in`),this.__bubbleMap&&this.__emitLifeEvent(Qo.MOUNTED)):this.__emitLifeEvent(Qo.UNMOUNTED),this.isBranch){let{children:t}=this;for(let n=0,r=t.length;n<r;n++)t[n].__bindLeafer(e)}}set(e,t){}get(e){}setAttr(e,t){this[e]=t}getAttr(e){return this[e]}getComputedAttr(e){return this.__[e]}toJSON(e){return e&&this.__layout.update(),this.__.__getInputData(null,e)}toString(e){return JSON.stringify(this.toJSON(e))}toSVG(){}__SVG(e){}toHTML(){}__setAttr(e,t){return!0}__getAttr(e){}setProxyAttr(e,t){}getProxyAttr(e){}find(e,t){}findTag(e){}findOne(e,t){}findId(e){}focus(e){}updateState(){}updateLayout(){this.__layout.update()}forceUpdate(e){_(e)?e=`width`:e===`surface`&&(e=`blendMode`);let t=this.__.__getInput(e);this.__[e]=_(t)?null:void 0,this[e]=t}forceRender(e,t){this.forceUpdate(`surface`)}__extraUpdate(){this.leaferIsReady&&this.leafer.layouter.addExtra(this)}__updateWorldMatrix(){}__updateLocalMatrix(){}__updateWorldBounds(){}__updateLocalBounds(){}__updateLocalBoxBounds(){}__updateLocalStrokeBounds(){}__updateLocalRenderBounds(){}__updateBoxBounds(e,t){}__updateContentBounds(){}__updateStrokeBounds(e){}__updateRenderBounds(e){}__updateAutoLayout(){}__updateFlowLayout(){}__updateNaturalSize(){}__updateStrokeSpread(){return 0}__updateRenderSpread(){return 0}__onUpdateSize(){}__updateEraser(e){this.__hasEraser=!!e||this.children.some(e=>e.__.eraser)}__renderEraser(e,t){e.save(),this.__clip(e,t);let{renderBounds:n}=this.__layout;e.clearRect(n.x,n.y,n.width,n.height),e.restore()}__updateMask(e){this.__hasMask=this.children.some(e=>e.__.mask&&e.__.visible&&e.__.opacity)}__renderMask(e,t){}__getNowWorld(e){if(e.matrix){this.__cameraWorld||={};let t=this.__cameraWorld,n=this.__world;return tc(n,e.matrix,t,void 0,n),nc(this.__layout.renderBounds,t,t),Qs(t,`half`,n.half),Qs(t,`ignorePixelSnap`,n.ignorePixelSnap),t}return this.__world}getClampRenderScale(){let{scaleX:e}=this.__nowWorld||this.__world;return e<0&&(e=-e),e>1?e:1}getRenderScaleData(e,t){let{scaleX:n,scaleY:r}=Sa.patternLocked?this.__world:this.__nowWorld;return e&&(n<0&&(n=-n),r<0&&(r=-r)),(!0===t||t===`zoom-in`&&n>1&&r>1)&&(n=r=1),Ys.scaleX=n,Ys.scaleY=r,Ys}getTransform(e){return this.__layout.getTransform(e||`local`)}getBounds(e,t){return this.__layout.getBounds(e,t)}getLayoutBounds(e,t,n){return this.__layout.getLayoutBounds(e,t,n)}getLayoutPoints(e,t){return this.__layout.getLayoutPoints(e,t)}getWorldBounds(e,t,n){let r=t?vc(this,t):this.worldTransform,i=n?e:{};return nc(e,r,i),i}worldToLocal(e,t,n,r){this.parent?this.parent.worldToInner(e,t,n,r):t&&rc(t,e)}localToWorld(e,t,n,r){this.parent?this.parent.innerToWorld(e,t,n,r):t&&rc(t,e)}worldToInner(e,t,n,r){r&&(r.innerToWorld(e,t,n),e=t||e),$s(this.scrollWorldTransform,e,t,n)}innerToWorld(e,t,n,r){ec(this.scrollWorldTransform,e,t,n),r&&r.worldToInner(t||e,null,n)}getBoxPoint(e,t,n,r){return this.getBoxPointByInner(this.getInnerPoint(e,t,n,r),null,null,!0)}getBoxPointByInner(e,t,n,r){let i=r?e:Object.assign({},e),{x:a,y:o}=this.boxBounds;return ic(i,-a,-o),i}getInnerPoint(e,t,n,r){let i=r?e:{};return this.worldToInner(e,i,n,t),i}getInnerPointByBox(e,t,n,r){let i=r?e:Object.assign({},e),{x:a,y:o}=this.boxBounds;return ic(i,a,o),i}getInnerPointByLocal(e,t,n,r){return this.getInnerPoint(e,this.parent,n,r)}getLocalPoint(e,t,n,r){let i=r?e:{};return this.worldToLocal(e,i,n,t),i}getLocalPointByInner(e,t,n,r){return this.getWorldPoint(e,this.parent,n,r)}getPagePoint(e,t,n,r){return(this.leafer?this.leafer.zoomLayer:this).getInnerPoint(e,t,n,r)}getWorldPoint(e,t,n,r){let i=r?e:{};return this.innerToWorld(e,i,n,t),i}getWorldPointByBox(e,t,n,r){return this.getWorldPoint(this.getInnerPointByBox(e,null,null,r),t,n,!0)}getWorldPointByLocal(e,t,n,r){let i=r?e:{};return this.localToWorld(e,i,n,t),i}getWorldPointByPage(e,t,n,r){return(this.leafer?this.leafer.zoomLayer:this).getWorldPoint(e,t,n,r)}setTransform(e,t,n){hc(this,e,t,n)}transform(e,t,n){pc(this,e,t,n)}move(e,t,n){ac(this,e,t,n)}moveInner(e,t,n){lc(this,e,t,!0,n)}scaleOf(e,t,n,r,i){oc(this,_c(this,e),t,n,r,i)}rotateOf(e,t,n){sc(this,_c(this,e),t,n)}skewOf(e,t,n,r,i){cc(this,_c(this,e),t,n,r,i)}transformWorld(e,t,n){mc(this,e,t,n)}moveWorld(e,t,n){lc(this,e,t,!1,n)}scaleOfWorld(e,t,n,r,i){uc(this,e,t,n,r,i)}rotateOfWorld(e,t){dc(this,e,t)}skewOfWorld(e,t,n,r,i){fc(this,e,t,n,r,i)}flip(e,t){pc(this,gc(this,e),!1,t)}scaleResize(e,t=e,n){this.scaleX*=e,this.scaleY*=t}__scaleResize(e,t){}resizeWidth(e){}resizeHeight(e){}hit(e,t){return!0}__hitWorld(e){return!0}__hit(e){return!0}__hitFill(e){return!0}__hitStroke(e,t){return!0}__hitPixel(e){return!0}__drawHitPath(e){}__updateHitCanvas(){}__render(e,t){}__drawFast(e,t){}__draw(e,t,n){}__clip(e,t){}__renderShape(e,t){}__drawShape(e,t){}__updateWorldOpacity(){}__updateChange(){}__drawPath(e){}__drawRenderPath(e){}__updatePath(){}__updateRenderPath(){}getMotionPathData(){return Ft.need(`path`)}getMotionPoint(e){return Ft.need(`path`)}getMotionTotal(){return 0}__updateMotionPath(){}__runAnimation(e,t){}__updateSortChildren(){}add(e,t){}remove(e,t){this.parent&&this.parent.remove(this,t)}dropTo(e,t,n){yc(this,e,t,n)}on(e,t,n){}off(e,t,n){}on_(e,t,n,r){}off_(e){}once(e,t,n,r){}emit(e,t,n){}emitEvent(e,t){}hasEvent(e,t){return!1}static changeAttr(e,t,n){n?this.addAttr(e,t,n):io(this.prototype,e,t)}static addAttr(e,t,n,r){n||=B,n(t,r)(this.prototype,e)}__emitLifeEvent(e){this.hasEvent(e)&&this.emitEvent(new Qo(e,this,this.parent))}destroy(){this.destroyed||=(this.parent&&this.remove(),this.children&&this.clear(),this.__emitLifeEvent(Qo.DESTROY),this.__.destroy(),this.__layout.destroy(),this.destroyEventer(),!0)}};bc=P([fo(As),fo(Ls),fo(Gs),fo(Os),fo(Ks)],bc);var{setListWithFn:xc}=A,{sort:Sc}=Io,{localBoxBounds:Cc,localStrokeBounds:wc,localRenderBounds:Tc,maskLocalBoxBounds:Ec,maskLocalStrokeBounds:Dc,maskLocalRenderBounds:Oc}=Mo,kc=new M(`Branch`),Ac=class extends bc{__updateStrokeSpread(){let{children:e}=this;for(let t=0,n=e.length;t<n;t++)if(e[t].__layout.strokeSpread)return 1;return 0}__updateRenderSpread(){let{children:e}=this;for(let t=0,n=e.length;t<n;t++)if(e[t].__layout.renderSpread)return 1;return 0}__updateBoxBounds(e,t){xc(t||this.__layout.boxBounds,this.children,this.__hasMask?Ec:Cc)}__updateStrokeBounds(e){xc(e||this.__layout.strokeBounds,this.children,this.__hasMask?Dc:wc)}__updateRenderBounds(e){xc(e||this.__layout.renderBounds,this.children,this.__hasMask?Oc:Tc)}__updateSortChildren(){let e,{children:t}=this;if(t.length>1){for(let n=0,r=t.length;n<r;n++)t[n].__tempNumber=n,t[n].__.zIndex&&(e=!0);t.sort(Sc),this.__layout.affectChildrenSort=e}}add(e,t){if(e===this||e.destroyed)return kc.warn(`add self or destroyed`);let n=_(t);if(!e.__){if(S(e))return e.forEach(e=>{this.add(e,t),n||t++});e=Lt.get(e.tag,e)}e.parent&&e.parent.remove(e),e.parent=this,n?this.children.push(e):this.children.splice(t,0,e),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||0)+1);let r=e.__layout;r.boxChanged||r.boxChange(),r.matrixChanged||r.matrixChange(),e.__bubbleMap&&e.__emitLifeEvent(Qo.ADD),this.leafer&&(e.__bindLeafer(this.leafer),this.leafer.created&&this.__emitChildEvent(Qo.ADD,e)),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}addMany(...e){this.add(e)}remove(e,t){e?e.__?e.animationOut?e.__runAnimation(`out`,()=>this.__remove(e,t)):this.__remove(e,t):this.find(e).forEach(e=>this.remove(e,t)):_(e)&&super.remove(null,t)}removeAll(e){let{children:t}=this;t.length&&(this.children=[],this.__preRemove(),this.__.__childBranchNumber=0,t.forEach(t=>{this.__realRemoveChild(t),e&&t.destroy()}))}clear(){this.removeAll(!0)}__remove(e,t){let n=this.children.indexOf(e);n>-1&&(this.children.splice(n,1),e.isBranch&&(this.__.__childBranchNumber=(this.__.__childBranchNumber||1)-1),this.__preRemove(),this.__realRemoveChild(e),t&&e.destroy())}__preRemove(){this.__hasMask&&this.__updateMask(),this.__hasEraser&&this.__updateEraser(),this.__layout.boxChange(),this.__layout.affectChildrenSort&&this.__layout.childrenSortChange()}__realRemoveChild(e){e.__emitLifeEvent(Qo.REMOVE),e.parent=null,this.leafer&&(e.__bindLeafer(null),this.leafer.created&&(this.__emitChildEvent(Qo.REMOVE,e),this.leafer.hitCanvasManager&&this.leafer.hitCanvasManager.clear()))}__emitChildEvent(e,t){let n=new Qo(e,t,this);this.hasEvent(e)&&!this.isLeafer&&this.emitEvent(n),this.leafer.emitEvent(n)}};Ac=P([fo(Js)],Ac);var K=class e{get length(){return this.list.length}constructor(e){this.reset(),e&&(S(e)?this.addList(e):this.add(e))}has(e){return e&&!_(this.keys[e.innerId])}indexAt(e){return this.list[e]}indexOf(e){let t=this.keys[e.innerId];return _(t)?-1:t}add(e){let{list:t,keys:n}=this;_(n[e.innerId])&&(t.push(e),n[e.innerId]=t.length-1)}addAt(e,t=0){let{keys:n}=this;if(_(n[e.innerId])){let{list:r}=this;for(let e=t,i=r.length;e<i;e++)n[r[e].innerId]++;t===0?r.unshift(e):(t>r.length&&(t=r.length),r.splice(t,0,e)),n[e.innerId]=t}}addList(e){for(let t=0;t<e.length;t++)this.add(e[t])}remove(e){let{list:t}=this,n;for(let r=0,i=t.length;r<i;r++)_(n)?t[r].innerId===e.innerId&&(n=r,delete this.keys[e.innerId]):this.keys[t[r].innerId]=r-1;_(n)||t.splice(n,1)}sort(e){let{list:t}=this;e?t.sort((e,t)=>t.__level-e.__level):t.sort((e,t)=>e.__level-t.__level)}forEach(e){this.list.forEach(e)}clone(){let t=new e;return t.list=[...this.list],t.keys=Object.assign({},this.keys),t}update(){this.keys={};let{list:e,keys:t}=this;for(let n=0,r=e.length;n<r;n++)t[e[n].innerId]=n}reset(){this.list=[],this.keys={}}destroy(){this.reset()}},jc=class{get length(){return this._length}constructor(e){this._length=0,this.reset(),e&&(S(e)?this.addList(e):this.add(e))}has(e){return!_(this.keys[e.innerId])}without(e){return _(this.keys[e.innerId])}sort(e){let{levels:t}=this;e?t.sort((e,t)=>t-e):t.sort((e,t)=>e-t)}addList(e){e.forEach(e=>{this.add(e)})}add(e){let{keys:t,levelMap:n}=this;t[e.innerId]||(t[e.innerId]=1,n[e.__level]?n[e.__level].push(e):(n[e.__level]=[e],this.levels.push(e.__level)),this._length++)}forEach(e){let t;this.levels.forEach(n=>{t=this.levelMap[n];for(let n=0,r=t.length;n<r;n++)e(t[n])})}reset(){this.levelMap={},this.keys={},this.levels=[],this._length=0}destroy(){this.levelMap=null}};function q(e,t,n,r){var i,a=arguments.length,o=a<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function Mc(e){return z(e,e=>Aa({set(t){this.__setAttr(e,t),t&&(this.__.__useEffect=!0),this.__layout.renderChanged||this.__layout.renderChange()}}))}function Nc(e){return z(e,e=>Aa({set(t){this.__setAttr(e,t),this.__layout.boxChanged||this.__layout.boxChange(),this.__updateSize()}}))}function Pc(){return(e,t)=>{let n=`_`+t;Da(e,t,{set(e){this.isLeafer&&(this[n]=e)},get(){return this.isApp?this.tree.zoomLayer:this.isLeafer?this[n]||this:this.leafer&&this.leafer.zoomLayer}})}}var Fc={},Ic={hasTransparent:function(e){if(!e||e.length===7||e.length===4)return!1;if(e===`transparent`)return!0;let t=e[0];if(t===`#`)switch(e.length){case 5:return e[4]!==`f`&&e[4]!==`F`;case 9:return e[7]!==`f`&&e[7]!==`F`||e[8]!==`f`&&e[8]!==`F`}else if((t===`r`||t===`h`)&&e[3]===`a`){let t=e.lastIndexOf(`,`);if(t>-1)return parseFloat(e.slice(t+1))<1}return!1}},Lc={number:(e,t)=>C(e)?e.type===`percent`?e.value*t:e.value:e},Rc={},J={},zc={},Bc={},Vc={},Hc={apply(){Ft.need(`filter`)}},Uc={},Wc={setStyleName:()=>Ft.need(`state`),set:()=>Ft.need(`state`)},Gc={list:{},register(e,t){Gc.list[e]=t},get:e=>Gc.list[e]},{parse:Kc,objectToCanvasData:qc}=Cr,{stintSet:Jc}=w,{hasTransparent:Yc}=Ic,Xc={},Zc=M.get(`UIData`),Qc=class extends ne{get scale(){let{scaleX:e,scaleY:t}=this;return e===t?e:{x:e,y:t}}get __strokeWidth(){return this.__getRealStrokeWidth()}get __maxStrokeWidth(){let e=this;return e.__hasMultiStrokeStyle?Math.max(e.__hasMultiStrokeStyle,e.strokeWidth):e.strokeWidth}get __hasMultiPaint(){let e=this;return e.fill&&this.__useStroke||e.__isFills&&e.fill.length>1||e.__isStrokes&&e.stroke.length>1||e.__useEffect}get __clipAfterFill(){let e=this;return e.cornerRadius||e.innerShadow||e.__pathInputed}get __hasSurface(){return this.fill||this.stroke}get __autoWidth(){return!this._width}get __autoHeight(){return!this._height}get __autoSide(){return!this._width||!this._height}get __autoSize(){return!this._width&&!this._height}setVisible(e){this._visible=e;let{leafer:t}=this.__leaf;t&&(t.watcher.hasVisible=!0)}setWidth(e){e<0?(this._width=-e,this.__leaf.scaleX*=-1,Zc.warn(`width < 0, instead -scaleX `,this)):this._width=e}setHeight(e){e<0?(this._height=-e,this.__leaf.scaleY*=-1,Zc.warn(`height < 0, instead -scaleY`,this)):this._height=e}setFill(e){this.__naturalWidth&&this.__removeNaturalSize(),y(e)||!e?(Jc(this,`__isTransparentFill`,Yc(e)),this.__isFills&&this.__removePaint(`fill`,!0),this._fill=e):C(e)&&this.__setPaint(`fill`,e)}setStroke(e){y(e)||!e?(Jc(this,`__isTransparentStroke`,Yc(e)),this.__isStrokes&&this.__removePaint(`stroke`,!0),this._stroke=e):C(e)&&this.__setPaint(`stroke`,e)}setPath(e){let t=y(e);t||e&&C(e[0])?(this.__setInput(`path`,e),this._path=t?Kc(e):qc(e)):(this.__input&&this.__removeInput(`path`),this._path=e)}setShadow(e){$c(this,`shadow`,e)}setInnerShadow(e){$c(this,`innerShadow`,e)}setFilter(e){$c(this,`filter`,e)}__computePaint(){let{fill:e,stroke:t}=this.__input;e&&J.compute(`fill`,this.__leaf),t&&J.compute(`stroke`,this.__leaf),this.__needComputePaint=void 0}__getRealStrokeWidth(e){let{strokeWidth:t,strokeWidthFixed:n}=this;if(e&&(e.strokeWidth&&(t=e.strokeWidth),_(e.strokeWidthFixed)||(n=e.strokeWidthFixed)),n){let e=this.__leaf.getClampRenderScale();return e>1?t/e:t}return t}__setPaint(e,t){this.__setInput(e,t);let n=this.__leaf.__layout;n.boxChanged||n.boxChange(),S(t)&&!t.length?this.__removePaint(e):e===`fill`?(this.__isFills=!0,this._fill||=Xc):(this.__isStrokes=!0,this._stroke||=Xc)}__removePaint(e,t){t&&this.__removeInput(e),zc.recycleImage(e,this),e===`fill`?(Jc(this,`__isAlphaPixelFill`,void 0),this._fill=this.__isFills=void 0):(Jc(this,`__isAlphaPixelStroke`,void 0),Jc(this,`__hasMultiStrokeStyle`,void 0),this._stroke=this.__isStrokes=void 0)}};function $c(e,t,n){e.__setInput(t,n),S(n)?(n.some(e=>!1===e.visible)&&(n=n.filter(e=>!1!==e.visible)),n.length||(n=void 0)):n=n&&!1!==n.visible?[n]:void 0,e[`_`+t]=n}var el=class extends Qc{},tl=class extends el{get __boxStroke(){return!this.__pathInputed}get __drawAfterFill(){return this.__single||this.__clipAfterFill}get __clipAfterFill(){let e=this;return e.overflow!==`show`&&e.__leaf.children.length&&(e.__leaf.isOverflow||super.__clipAfterFill)}},nl=class extends el{__getInputData(e,t){let n=super.__getInputData(e,t);return Qt.forEach(e=>delete n[e]),n}},rl=class extends tl{},il=class extends Qc{get __usePathBox(){return this.points||this.__pathInputed}},al=class extends Qc{get __boxStroke(){return!this.__pathInputed}},ol=class extends Qc{get __boxStroke(){return!this.__pathInputed}},sl=class extends il{},cl=class extends Qc{},ll=class extends Qc{get __pathInputed(){return 2}},ul=class extends el{},dl={thin:100,"extra-light":200,light:300,normal:400,medium:500,"semi-bold":600,bold:700,"extra-bold":800,black:900},fl=class extends Qc{get __useNaturalRatio(){return!1}setFontWeight(e){y(e)?(this.__setInput(`fontWeight`,e),e=dl[e]||400):this.__input&&this.__removeInput(`fontWeight`),this._fontWeight=e}setBoxStyle(e){let t=this.__leaf,n=t.__box;if(e){let{boxStyle:r}=this;if(n)for(let e in r)n[e]=void 0;else n=t.__box=Lt.get(`Rect`,0);let i=t.__layout,a=n.__layout;r||(n.parent=t,n.__world=t.__world,a.boxBounds=i.boxBounds),n.set(e),a.strokeChanged&&i.strokeChange()}else n&&(t.__box=n.parent=null,n.destroy());this._boxStyle=e}},pl=class extends al{setUrl(e){this.__setImageFill(e),this._url=e}__setImageFill(e){this.fill=e?{type:`image`,mode:`stretch`,url:e}:void 0}__getData(){let e=super.__getData();return e.url&&delete e.fill,e}__getInputData(e,t){let n=super.__getInputData(e,t);return n.url&&delete n.fill,n}},ml=class extends al{get __isCanvas(){return!0}get __drawAfterFill(){return!0}__getInputData(e,t){let n=super.__getInputData(e,t);return n.url=this.__leaf.canvas.toDataURL(`image/png`),n}},{max:hl,add:gl}=pe,_l={__updateStrokeSpread(){let e=0,t=0,n=this.__,{strokeAlign:r,__maxStrokeWidth:i}=n,a=this.__box;if((n.stroke||n.hitStroke===`all`)&&i&&r!==`inside`&&(t=e=r===`center`?i/2:i,!n.__boxStroke)){let t=n.__isLinePath?0:10*e,r=n.strokeCap===`none`?0:i;e+=Math.max(t,r)}return n.__useArrow&&(e+=5*i),a&&(e=hl(e,a.__layout.strokeSpread=a.__updateStrokeSpread()),t=Math.max(t,a.__layout.strokeBoxSpread)),this.__layout.strokeBoxSpread=t,e},__updateRenderSpread(){let e=0,{shadow:t,innerShadow:n,blur:r,backgroundBlur:i,filter:a,renderSpread:o}=this.__,{strokeSpread:s}=this.__layout,c=this.__box;t&&(e=Vc.getShadowRenderSpread(this,t)),r&&(e=hl(e,r)),a&&(e=gl(e,Hc.getSpread(a))),o&&(e=gl(e,o)),s&&(e=gl(e,s));let l=e;return n&&(l=hl(l,Vc.getInnerShadowSpread(this,n))),i&&(l=hl(l,i)),this.__layout.renderShapeSpread=l,c?hl(c.__updateRenderSpread(),e):e}},{stintSet:vl}=w,yl={__updateChange(){let e=this.__;if(e.__useStroke){let t=e.__useStroke=!(!e.stroke||!e.strokeWidth);vl(this.__world,`half`,t&&e.strokeAlign===`center`&&e.strokeWidth%2),vl(e,`__fillAfterStroke`,t&&e.strokeAlign===`outside`&&e.fill&&!e.__isTransparentFill)}if(e.__useEffect){let{shadow:t,fill:n,stroke:r}=e,i=e.innerShadow||e.blur||e.backgroundBlur||e.filter;vl(e,`__isFastShadow`,t&&!i&&t.length<2&&!t[0].spread&&!Vc.isTransformShadow(t[0])&&n&&!e.__isTransparentFill&&!(S(n)&&n.length>1)&&(this.useFastShadow||!r||r&&e.strokeAlign===`inside`)),e.__useEffect=!(!t&&!i)}e.__checkSingle(),vl(e,`__complex`,e.__isFills||e.__isStrokes||e.cornerRadius||e.__useEffect)},__drawFast(e,t){bl(this,e,t)},__draw(e,t,n){let r=this.__;if(r.__complex){r.__needComputePaint&&r.__computePaint();let{fill:i,stroke:a,__drawAfterFill:o,__fillAfterStroke:s,__isFastShadow:c}=r;if(this.__drawRenderPath(e),r.__useEffect&&!c){let c=J.shape(this,e,t);this.__nowWorld=this.__getNowWorld(t);let{shadow:l,innerShadow:u,filter:d}=r;l&&Vc.shadow(this,e,c),s&&(r.__isStrokes?J.strokes(a,this,e,t):J.stroke(a,this,e,t)),i&&(r.__isFills?J.fills(i,this,e,t):J.fill(i,this,e,t)),o&&this.__drawAfterFill(e,t),u&&Vc.innerShadow(this,e,c),a&&!s&&(r.__isStrokes?J.strokes(a,this,e,t):J.stroke(a,this,e,t)),d&&Hc.apply(d,this,this.__nowWorld,e,n,c),c.worldCanvas&&c.worldCanvas.recycle(),c.canvas.recycle()}else{if(s&&(r.__isStrokes?J.strokes(a,this,e,t):J.stroke(a,this,e,t)),c){let t=r.shadow[0],{scaleX:n,scaleY:i}=this.getRenderScaleData(!0,t.scaleFixed);e.save(),e.setWorldShadow(t.x*n,t.y*i,t.blur*n,Ic.string(t.color))}i&&(r.__isFills?J.fills(i,this,e,t):J.fill(i,this,e,t)),c&&e.restore(),o&&this.__drawAfterFill(e,t),a&&!s&&(r.__isStrokes?J.strokes(a,this,e,t):J.stroke(a,this,e,t))}}else r.__pathInputed?bl(this,e,t):this.__drawFast(e,t)},__drawShape(e,t){this.__drawRenderPath(e);let n=this.__,{fill:r,stroke:i}=n;r&&!t.ignoreFill&&(n.__isAlphaPixelFill?J.fills(r,this,e,t):J.fill(`#000000`,this,e,t)),n.__isCanvas&&this.__drawAfterFill(e,t),i&&!t.ignoreStroke&&(n.__isAlphaPixelStroke?J.strokes(i,this,e,t):J.stroke(`#000000`,this,e,t))},__drawAfterFill(e,t){this.__.__clipAfterFill?(e.save(),e.clipUI(this),this.__drawContent(e,t),e.restore()):this.__drawContent(e,t)}};function bl(e,t,n){let{fill:r,stroke:i,__drawAfterFill:a,__fillAfterStroke:o}=e.__;e.__drawRenderPath(t),o&&J.stroke(i,e,t,n),r&&J.fill(r,e,t,n),a&&e.__drawAfterFill(t,n),i&&!o&&J.stroke(i,e,t,n)}var xl={__drawFast(e,t){let{x:n,y:r,width:i,height:a}=this.__layout.boxBounds,{fill:o,stroke:s,__drawAfterFill:c}=this.__;if(o&&(e.fillStyle=o,e.fillRect(n,r,i,a)),c&&this.__drawAfterFill(e,t),s){let{strokeAlign:o,__strokeWidth:c}=this.__;if(!c)return;e.setStroke(s,c,this.__);let l=c/2;switch(o){case`center`:e.strokeRect(0,0,i,a);break;case`inside`:i-=c,a-=c,i<0||a<0?(e.save(),this.__clip(e,t),e.strokeRect(n+l,r+l,i,a),e.restore()):e.strokeRect(n+l,r+l,i,a);break;case`outside`:e.strokeRect(n-l,r-l,i+c,a+c)}}}},Sl,Y=Sl=class extends bc{get app(){return this.leafer&&this.leafer.app}get isFrame(){return!1}set scale(e){Ce.assignScale(this,e)}get scale(){return this.__.scale}get isAutoWidth(){let e=this.__;return e.__autoWidth||e.autoWidth}get isAutoHeight(){let e=this.__;return e.__autoHeight||e.autoHeight}get pen(){let{path:e}=this.__;return da.set(this.path=e||[]),e||this.__drawPathByBox(da),da}reset(e){}set(e,t){e&&Object.assign(this,e)}get(e){return y(e)?this.__.__getInput(e):this.__.__getInputData(e)}createProxyData(){}find(e,t){return Ft.need(`find`)}findTag(e){return this.find({tag:e})}findOne(e,t){return Ft.need(`find`)}findId(e){return this.findOne({id:e})}getPath(e,t){this.__layout.update();let n=t?this.__.__pathForRender:this.__.path;return n||(da.set(n=[]),this.__drawPathByBox(da)),e?Cr.toCanvasData(n,!0):n}getPathString(e,t,n){return Cr.stringify(this.getPath(e,t),n)}load(){this.__.__computePaint()}__onUpdateSize(){if(this.__.__input){let e=this.__;!e.lazy||this.__inLazyBounds||Uc.running?e.__computePaint():e.__needComputePaint=!0}}__updateRenderPath(){let e=this.__;e.path?(e.__pathForRender=e.cornerRadius?la.smooth(e.path,e.cornerRadius,e.cornerSmoothing):e.path,e.__useArrow&&Rc.addArrows(this)):e.__pathForRender&&=void 0}__drawRenderPath(e){e.beginPath(),this.__drawPathByData(e,this.__.__pathForRender)}__drawPath(e){e.beginPath(),this.__drawPathByData(e,this.__.path)}__drawPathByData(e,t){t?wi.drawPathByData(e,t):this.__drawPathByBox(e)}__drawPathByBox(e){let{x:t,y:n,width:r,height:i}=this.__layout.boxBounds;if(this.__.cornerRadius){let{cornerRadius:a}=this.__;e.roundRect(t,n,r,i,x(a)?[a]:a)}else e.rect(t,n,r,i)}drawImagePlaceholder(e,t,n){J.fill(this.__.placeholderColor,this,t,n)}animate(e,t,n,r){return this.set(e),Ft.need(`animate`)}killAnimate(e,t){}export(e,t){return Ft.need(`export`)}syncExport(e,t){return Ft.need(`export`)}clone(e){let t=w.clone(this.toJSON());return e&&Object.assign(t,e),Sl.one(t)}static one(e,t,n,r,i){return Lt.get(e.tag||this.prototype.__tag,e,t,n,r,i)}static registerUI(){po()(this)}static registerData(e){ro(e)(this.prototype)}static setEditConfig(e){}static setEditOuter(e){}static setEditInner(e){}destroy(){this.fill=this.stroke=null,this.__animate&&this.killAnimate(),super.destroy()}};q([ro(Qc)],Y.prototype,`__`,void 0),q([Pc()],Y.prototype,`zoomLayer`,void 0),q([Ma(``)],Y.prototype,`id`,void 0),q([Ma(``)],Y.prototype,`name`,void 0),q([Ma(``)],Y.prototype,`className`,void 0),q([Ka(`pass-through`)],Y.prototype,`blendMode`,void 0),q([Ja(1)],Y.prototype,`opacity`,void 0),q([Ya(!0)],Y.prototype,`visible`,void 0),q([Ka(!1)],Y.prototype,`locked`,void 0),q([qa(!1)],Y.prototype,`dim`,void 0),q([qa(!1)],Y.prototype,`dimskip`,void 0),q([Qa(0)],Y.prototype,`zIndex`,void 0),q([$a(!1)],Y.prototype,`mask`,void 0),q([eo(!1)],Y.prototype,`eraser`,void 0),q([Na(0,!0)],Y.prototype,`x`,void 0),q([Na(0,!0)],Y.prototype,`y`,void 0),q([B(100,!0)],Y.prototype,`width`,void 0),q([B(100,!0)],Y.prototype,`height`,void 0),q([Ia(1,!0)],Y.prototype,`scaleX`,void 0),q([Ia(1,!0)],Y.prototype,`scaleY`,void 0),q([La(0,!0)],Y.prototype,`rotation`,void 0),q([La(0,!0)],Y.prototype,`skewX`,void 0),q([La(0,!0)],Y.prototype,`skewY`,void 0),q([Na(0,!0)],Y.prototype,`offsetX`,void 0),q([Na(0,!0)],Y.prototype,`offsetY`,void 0),q([Pa(0,!0)],Y.prototype,`scrollX`,void 0),q([Pa(0,!0)],Y.prototype,`scrollY`,void 0),q([Fa()],Y.prototype,`origin`,void 0),q([Fa()],Y.prototype,`around`,void 0),q([Ma(!1)],Y.prototype,`lazy`,void 0),q([Ra(1)],Y.prototype,`pixelRatio`,void 0),q([Ga(0)],Y.prototype,`renderSpread`,void 0),q([Ba()],Y.prototype,`path`,void 0),q([Va()],Y.prototype,`windingRule`,void 0),q([Va(!0)],Y.prototype,`closed`,void 0),q([B(0)],Y.prototype,`padding`,void 0),q([B(!1)],Y.prototype,`lockRatio`,void 0),q([B()],Y.prototype,`widthRange`,void 0),q([B()],Y.prototype,`heightRange`,void 0),q([Ma(!1)],Y.prototype,`draggable`,void 0),q([Ma()],Y.prototype,`dragBounds`,void 0),q([Ma(`auto`)],Y.prototype,`dragBoundsType`,void 0),q([Ma(!1)],Y.prototype,`editable`,void 0),q([to(!0)],Y.prototype,`hittable`,void 0),q([to(`path`)],Y.prototype,`hitFill`,void 0),q([Wa(`path`)],Y.prototype,`hitStroke`,void 0),q([to(!1)],Y.prototype,`hitBox`,void 0),q([to(!0)],Y.prototype,`hitChildren`,void 0),q([to(!0)],Y.prototype,`hitSelf`,void 0),q([to()],Y.prototype,`hitRadius`,void 0),q([no(``)],Y.prototype,`cursor`,void 0),q([Ka()],Y.prototype,`fill`,void 0),q([Wa(void 0,!0)],Y.prototype,`stroke`,void 0),q([Wa(`inside`)],Y.prototype,`strokeAlign`,void 0),q([Wa(1,!0)],Y.prototype,`strokeWidth`,void 0),q([Wa(!1)],Y.prototype,`strokeWidthFixed`,void 0),q([Wa(`none`)],Y.prototype,`strokeCap`,void 0),q([Wa(`miter`)],Y.prototype,`strokeJoin`,void 0),q([Wa()],Y.prototype,`dashPattern`,void 0),q([Wa(0)],Y.prototype,`dashOffset`,void 0),q([Wa(10)],Y.prototype,`miterLimit`,void 0),q([Va(0)],Y.prototype,`cornerRadius`,void 0),q([Va()],Y.prototype,`cornerSmoothing`,void 0),q([Mc()],Y.prototype,`shadow`,void 0),q([Mc()],Y.prototype,`innerShadow`,void 0),q([Mc()],Y.prototype,`blur`,void 0),q([Mc()],Y.prototype,`backgroundBlur`,void 0),q([Mc()],Y.prototype,`grayscale`,void 0),q([Mc()],Y.prototype,`filter`,void 0),q([Ka()],Y.prototype,`placeholderColor`,void 0),q([Ma(100)],Y.prototype,`placeholderDelay`,void 0),q([Ma({})],Y.prototype,`data`,void 0),q([co(bc.prototype.reset)],Y.prototype,`reset`,null),Y=Sl=q([fo(_l),fo(yl),lo()],Y);var Cl=class extends Y{get __tag(){return`Group`}get isBranch(){return!0}reset(e){this.__setBranch(),super.reset(e)}__setBranch(){this.children||=[]}set(e,t){if(e)if(e.children){let{children:n}=e;delete e.children,this.children?this.clear():this.__setBranch(),super.set(e,t),n.forEach(e=>this.add(e)),e.children=n}else super.set(e,t)}toJSON(e){let t=super.toJSON(e);return this.childlessJSON||(t.children=this.children.map(t=>t.toJSON(e))),t}pick(e,t){}addAt(e,t){this.add(e,t)}addAfter(e,t){this.add(e,this.children.indexOf(t)+1)}addBefore(e,t){this.add(e,this.children.indexOf(t))}add(e,t){}addMany(...e){}remove(e,t){}removeAll(e){}clear(){}},wl;q([ro(el)],Cl.prototype,`__`,void 0),q([B(0)],Cl.prototype,`width`,void 0),q([B(0)],Cl.prototype,`height`,void 0),Cl=q([fo(Ac),po()],Cl);var Tl=M.get(`Leafer`),El=wl=class extends Cl{get __tag(){return`Leafer`}get isApp(){return!1}get app(){return this.parent||this}get isLeafer(){return!0}get imageReady(){return this.viewReady&&ba.isComplete}get layoutLocked(){return!this.layouter.running}get FPS(){return this.renderer?this.renderer.FPS:60}get cursorPoint(){return this.interaction&&this.interaction.hoverData||{x:this.width/2,y:this.height/2}}get clientBounds(){return this.canvas&&this.canvas.getClientBounds(!0)||Oe()}constructor(e,t){super(t),this.config={start:!0,hittable:!0,smooth:!0,lazySpeard:100},this.leafs=0,this.__eventIds=[],this.__controllers=[],this.__readyWait=[],this.__viewReadyWait=[],this.__viewCompletedWait=[],this.__nextRenderWait=[],this.userConfig=e,e&&(e.view||e.width)&&this.init(e),wl.list.add(this)}init(e,t){if(this.canvas)return;let n,{config:r}=this;this.__setLeafer(this),t&&(this.parentApp=t,this.__bindApp(t),n=t.running),e&&(this.parent=t,this.initType(e.type),this.parent=void 0,w.assign(r,e));let i=this.canvas=N.canvas(r);this.__controllers.push(this.renderer=N.renderer(this,i,r),this.watcher=N.watcher(this,r),this.layouter=N.layouter(this,r)),this.isApp&&this.__setApp(),this.__checkAutoLayout(),this.view=i.view,t||(this.selector=N.selector(this),this.interaction=N.interaction(this,i,this.selector,r),this.interaction&&(this.__controllers.unshift(this.interaction),this.hitCanvasManager=N.hitCanvasManager()),this.canvasManager=new Ht,n=r.start),this.hittable=r.hittable,this.fill=r.fill,this.canvasManager.add(i),this.__listenEvents(),n&&(this.__startTimer=setTimeout(this.start.bind(this))),Bo.run(this.__initWait),this.onInit()}onInit(){}initType(e){}set(e,t){this.waitInit(()=>{super.set(e,t)})}start(){clearTimeout(this.__startTimer),!this.running&&this.canvas&&(this.running=!0,this.ready?this.emitLeafer(G.RESTART):this.emitLeafer(G.START),this.__controllers.forEach(e=>e.start()),this.isApp||this.renderer.render())}stop(){clearTimeout(this.__startTimer),this.running&&this.canvas&&(this.__controllers.forEach(e=>e.stop()),this.running=!1,this.emitLeafer(G.STOP))}unlockLayout(){this.layouter.start(),this.updateLayout()}lockLayout(){this.updateLayout(),this.layouter.stop()}resize(e){let t=w.copyAttrs({},e,Qt);Object.keys(t).forEach(e=>this[e]=t[e])}forceRender(e,t){let{renderer:n}=this;n&&(n.addBlock(e?new wt(e):this.canvas.bounds),this.viewReady&&(t?n.render():n.update()))}requestRender(e=!1){this.renderer&&this.renderer.update(e)}updateCursor(e){let t=this.interaction;t&&(e?t.setCursor(e):t.updateCursor())}updateLazyBounds(){this.lazyBounds=this.canvas.bounds.clone().spread(this.config.lazySpeard)}__doResize(e){let{canvas:t}=this;if(!t||t.isSameSize(e))return;let n=w.copyAttrs({},this.canvas,Qt);t.resize(e),this.updateLazyBounds(),this.__onResize(new ls(e,n))}__onResize(e){this.emitEvent(e),w.copyAttrs(this.__,e,Qt),setTimeout(()=>{this.canvasManager&&this.canvasManager.clearRecycled()},0)}__setApp(){}__bindApp(e){this.selector=e.selector,this.interaction=e.interaction,this.canvasManager=e.canvasManager,this.hitCanvasManager=e.hitCanvasManager}__setLeafer(e){this.leafer=e,this.__level=1}__checkAutoLayout(){let{config:e,parentApp:t}=this;t||(e.width&&e.height||(this.autoLayout=new Et(e)),this.canvas.startAutoLayout(this.autoLayout,this.__onResize.bind(this)))}__setAttr(e,t){return this.canvas&&(Qt.includes(e)?this.__changeCanvasSize(e,t):e===`fill`?this.__changeFill(t):e===`hittable`?this.parent||(this.canvas.hittable=t):e===`zIndex`?(this.canvas.zIndex=t,setTimeout(()=>this.parent&&this.parent.__updateSortChildren())):e===`mode`&&this.emit(G.UPDATE_MODE,{mode:t})),super.__setAttr(e,t)}__getAttr(e){return this.canvas&&Qt.includes(e)?this.canvas[e]:super.__getAttr(e)}__changeCanvasSize(e,t){let{config:n,canvas:r}=this,i=w.copyAttrs({},r,Qt);i[e]=n[e]=t,n.width&&n.height?r.stopAutoLayout():this.__checkAutoLayout(),this.__doResize(i)}__changeFill(e){this.config.fill=e,this.canvas.allowBackgroundColor?this.canvas.backgroundColor=e:this.forceRender()}__onCreated(){this.created=!0}__onReady(){this.ready=!0,this.emitLeafer(G.BEFORE_READY),this.emitLeafer(G.READY),this.emitLeafer(G.AFTER_READY),Bo.run(this.__readyWait)}__onViewReady(){this.viewReady||(this.viewReady=!0,this.emitLeafer(G.VIEW_READY),Bo.run(this.__viewReadyWait))}__onLayoutEnd(){let{grow:e,width:t,height:n}=this.config;if(e){let{width:r,height:i,pixelRatio:a}=this,o=e===`box`?this.worldBoxBounds:this.__world;t||(r=Math.max(1,o.x+o.width)),n||(i=Math.max(1,o.y+o.height)),this.__doResize({width:r,height:i,pixelRatio:a})}this.ready||this.__onReady()}__onNextRender(){if(this.viewReady){Bo.run(this.__nextRenderWait);let{imageReady:e}=this;e&&!this.viewCompleted&&this.__checkViewCompleted(),e||(this.viewCompleted=!1,this.requestRender())}else this.requestRender()}__checkViewCompleted(e=!0){this.nextRender(()=>{this.imageReady&&(e&&this.emitLeafer(G.VIEW_COMPLETED),Bo.run(this.__viewCompletedWait),this.viewCompleted=!0)})}__onWatchData(){this.watcher.childrenChanged&&this.interaction&&this.nextRender(()=>this.interaction.updateCursor())}waitInit(e,t){t&&(e=e.bind(t)),this.__initWait||=[],this.canvas?e():this.__initWait.push(e)}waitReady(e,t){t&&(e=e.bind(t)),this.ready?e():this.__readyWait.push(e)}waitViewReady(e,t){t&&(e=e.bind(t)),this.viewReady?e():this.__viewReadyWait.push(e)}waitViewCompleted(e,t){t&&(e=e.bind(t)),this.__viewCompletedWait.push(e),this.viewCompleted?this.__checkViewCompleted(!1):this.running||this.start()}nextRender(e,t,n){t&&(e=e.bind(t));let r=this.__nextRenderWait;if(n){for(let t=0;t<r.length;t++)if(r[t]===e){r.splice(t,1);break}}else r.push(e);this.requestRender()}zoom(e,t,n,r){return Ft.need(`view`)}getValidMove(e,t,n){return{x:e,y:t}}getValidScale(e){return e}getWorldPointByClient(e,t){return this.interaction&&this.interaction.getLocal(e,t)}getPagePointByClient(e,t){return this.getPagePoint(this.getWorldPointByClient(e,t))}getClientPointByWorld(e){let{x:t,y:n}=this.clientBounds;return{x:t+e.x,y:n+e.y}}updateClientBounds(){this.canvas&&this.canvas.updateClientBounds()}receiveEvent(e){}emitLeafer(e){this.emitEvent(new G(e,this))}__listenEvents(){let e=Mt.start(`FirstCreate `+this.innerName);this.once([[G.START,()=>Mt.end(e)],[U.START,this.updateLazyBounds,this],[W.START,this.__onCreated,this],[W.END,this.__onViewReady,this]]),this.__eventIds.push(this.on_([[us.DATA,this.__onWatchData,this],[U.END,this.__onLayoutEnd,this],[W.NEXT,this.__onNextRender,this]]))}__removeListenEvents(){this.off_(this.__eventIds)}destroy(e){let t=()=>{if(!this.destroyed){wl.list.remove(this);try{this.stop(),this.emitLeafer(G.END),this.__removeListenEvents(),this.__controllers.forEach(e=>!(this.parent&&e===this.interaction)&&e.destroy()),this.__controllers.length=0,this.parent||(this.selector&&this.selector.destroy(),this.hitCanvasManager&&this.hitCanvasManager.destroy(),this.canvasManager&&this.canvasManager.destroy()),this.canvas&&this.canvas.destroy(),this.config.view=this.view=this.parentApp=null,this.userConfig&&(this.userConfig.view=null),super.destroy(),setTimeout(()=>{Sa.clearRecycled()},100)}catch(e){Tl.error(e)}}};e?t():setTimeout(t)}};El.list=new K,q([ro(nl)],El.prototype,`__`,void 0),q([B()],El.prototype,`pixelRatio`,void 0),q([Ma(`normal`)],El.prototype,`mode`,void 0),El=wl=q([po()],El);var Dl=class extends Y{get __tag(){return`Rect`}};q([ro(al)],Dl.prototype,`__`,void 0),Dl=q([fo(xl),lo(),po()],Dl);var{add:Ol,includes:kl,scroll:Al}=A,jl=Dl.prototype,Ml=Cl.prototype,Nl=class extends Cl{get __tag(){return`Box`}get isBranchLeaf(){return!0}constructor(e){super(e),this.__layout.renderChanged||this.__layout.renderChange()}__updateStrokeSpread(){return 0}__updateRectRenderSpread(){return 0}__updateRenderSpread(){return this.__updateRectRenderSpread()||-1}__updateRectBoxBounds(){}__updateBoxBounds(e){if(this.children.length&&!this.pathInputed){let e=this.__;if(e.__autoSide){e.__hasSurface&&this.__extraUpdate(),super.__updateBoxBounds();let{boxBounds:t}=this.__layout;e.__autoSize||(e.__autoWidth?(t.width+=t.x,t.x=0,t.height=e.height,t.y=0):(t.height+=t.y,t.y=0,t.width=e.width,t.x=0)),this.__updateNaturalSize()}else this.__updateRectBoxBounds()}else this.__updateRectBoxBounds()}__updateStrokeBounds(){}__updateRenderBounds(){let e,t;if(this.children.length){let n=this.__,r=this.__layout,{renderBounds:i,boxBounds:a}=r,{overflow:o}=n,s=r.childrenRenderBounds||=Oe();super.__updateRenderBounds(s),(t=o.includes(`scroll`))&&(Ol(s,a),Al(s,n)),this.__updateRectRenderBounds(),e=!kl(a,s),e&&o===`show`&&Ol(i,s)}else this.__updateRectRenderBounds();w.stintSet(this,`isOverflow`,e),this.__checkScroll(t)}__updateRectRenderBounds(){}__checkScroll(e){}__updateRectChange(){}__updateChange(){super.__updateChange(),this.__updateRectChange()}__renderRect(e,t){}__renderGroup(e,t){}__render(e,t){this.__.__drawAfterFill?this.__renderRect(e,t):(this.__renderRect(e,t),this.children.length&&this.__renderGroup(e,t)),this.hasScroller&&this.scroller.__render(e,t)}__drawContent(e,t){this.__renderGroup(e,t),(this.__.__useStroke||this.__.__useEffect)&&(e.setWorld(this.__nowWorld),this.__drawRenderPath(e))}};q([ro(tl)],Nl.prototype,`__`,void 0),q([B(100)],Nl.prototype,`width`,void 0),q([B(100)],Nl.prototype,`height`,void 0),q([Ma(!1)],Nl.prototype,`resizeChildren`,void 0),q([Ga(`show`)],Nl.prototype,`overflow`,void 0),q([co(jl.__updateStrokeSpread)],Nl.prototype,`__updateStrokeSpread`,null),q([co(jl.__updateRenderSpread)],Nl.prototype,`__updateRectRenderSpread`,null),q([co(jl.__updateBoxBounds)],Nl.prototype,`__updateRectBoxBounds`,null),q([co(jl.__updateStrokeBounds)],Nl.prototype,`__updateStrokeBounds`,null),q([co(jl.__updateRenderBounds)],Nl.prototype,`__updateRectRenderBounds`,null),q([co(jl.__updateChange)],Nl.prototype,`__updateRectChange`,null),q([co(jl.__render)],Nl.prototype,`__renderRect`,null),q([co(Ml.__render)],Nl.prototype,`__renderGroup`,null),Nl=q([lo(),po()],Nl);var Pl=class extends Nl{get __tag(){return`Frame`}get isFrame(){return!0}};q([ro(rl)],Pl.prototype,`__`,void 0),q([Ka(`#FFFFFF`)],Pl.prototype,`fill`,void 0),q([Ga(`hide`)],Pl.prototype,`overflow`,void 0),Pl=q([po()],Pl);var{moveTo:Fl,closePath:Il,ellipse:Ll}=Kr,Rl=class extends Y{get __tag(){return`Ellipse`}__updatePath(){let{width:e,height:t,innerRadius:n,startAngle:r,endAngle:i}=this.__,a=e/2,o=t/2,s=this.__.path=[];n?(r||i?(n<1&&Ll(s,a,o,a*n,o*n,0,r,i,!1),Ll(s,a,o,a,o,0,i,r,!0),n<1&&Il(s)):(n<1&&(Ll(s,a,o,a*n,o*n),Fl(s,e,o)),Ll(s,a,o,a,o,0,360,0,!0)),T.ellipseToCurve&&(this.__.path=this.getPath(!0))):r||i?(Fl(s,a,o),Ll(s,a,o,a,o,0,r,i,!1),Il(s)):Ll(s,a,o,a,o)}};q([ro(ol)],Rl.prototype,`__`,void 0),q([Va(0)],Rl.prototype,`innerRadius`,void 0),q([Va(0)],Rl.prototype,`startAngle`,void 0),q([Va(0)],Rl.prototype,`endAngle`,void 0),Rl=q([po()],Rl);var{sin:zl,cos:Bl,PI:Vl}=Math,{moveTo:Hl,lineTo:Ul,closePath:Wl,drawPoints:Gl}=Kr,Kl=class extends Y{get __tag(){return`Polygon`}__updatePath(){let e=this.__,t=e.path=[];if(e.points)Gl(t,e.points,e.curve,!0);else{let{width:n,height:r,sides:i}=e,a=n/2,o=r/2;Hl(t,a,0);for(let e=1;e<i;e++)Ul(t,a+a*zl(2*e*Vl/i),o-o*Bl(2*e*Vl/i));Wl(t)}}};q([ro(sl)],Kl.prototype,`__`,void 0),q([Va(3)],Kl.prototype,`sides`,void 0),q([Va()],Kl.prototype,`points`,void 0),q([Va(0)],Kl.prototype,`curve`,void 0),Kl=q([lo(),po()],Kl);var{sin:ql,cos:Jl,PI:Yl}=Math,{moveTo:Xl,lineTo:Zl,closePath:Ql}=Kr,$l=class extends Y{get __tag(){return`Star`}__updatePath(){let{width:e,height:t,corners:n,innerRadius:r}=this.__,i=e/2,a=t/2,o=this.__.path=[];Xl(o,i,0);for(let e=1;e<2*n;e++)Zl(o,i+(e%2==0?i:i*r)*ql(e*Yl/n),a-(e%2==0?a:a*r)*Jl(e*Yl/n));Ql(o)}};q([ro(cl)],$l.prototype,`__`,void 0),q([Va(5)],$l.prototype,`corners`,void 0),q([Va(.382)],$l.prototype,`innerRadius`,void 0),$l=q([po()],$l);var{moveTo:eu,lineTo:tu,drawPoints:nu}=Kr,{rotate:ru,getAngle:iu,getDistance:au,defaultPoint:ou}=k,su=class extends Y{get __tag(){return`Line`}get toPoint(){let{width:e,rotation:t}=this.__,n=De();return e&&(n.x=e),t&&ru(n,t),n}set toPoint(e){this.width=au(ou,e),this.rotation=iu(ou,e),this.height&&=0}__updatePath(){let e=this.__,t=e.path=[];e.points?nu(t,e.points,e.curve,e.closed):(eu(t,0,0),tu(t,this.width,0))}};q([ro(il)],su.prototype,`__`,void 0),q([Ha(`center`)],su.prototype,`strokeAlign`,void 0),q([B(0)],su.prototype,`height`,void 0),q([Va()],su.prototype,`points`,void 0),q([Va(0)],su.prototype,`curve`,void 0),q([Va(!1)],su.prototype,`closed`,void 0),su=q([po()],su);var cu=class extends Dl{get __tag(){return`Image`}get ready(){let{image:e}=this;return e&&e.ready}get image(){let{fill:e}=this.__;return S(e)&&e[0].image}};q([ro(pl)],cu.prototype,`__`,void 0),q([B(``)],cu.prototype,`url`,void 0),cu=q([po()],cu);var lu=class extends Dl{get __tag(){return`Canvas`}get context(){return this.canvas.context}get ready(){return!this.url}constructor(e){super(e),this.canvas=N.canvas(this.__),e&&e.url&&this.drawImage(e.url)}drawImage(e){new Ea({url:e}).load(e=>{this.context.drawImage(e.view,0,0),this.url=void 0,this.paint(),this.emitEvent(new ns(ns.LOADED,{image:e}))})}draw(e,t,n,r){let i=new Xe(e.worldTransform).invert(),a=new Xe;t&&a.translate(t.x,t.y),n&&(x(n)?a.scale(n):a.scale(n.x,n.y)),r&&a.rotate(r),i.multiplyParent(a),e.__render(this.canvas,{matrix:i.withScale()}),this.paint()}paint(){this.forceRender()}__drawContent(e,t){let{width:n,height:r}=this.__,{view:i}=this.canvas;e.drawImage(i,0,0,i.width,i.height,0,0,n,r)}__updateSize(){let{canvas:e}=this;if(e){let{smooth:t,safeResize:n}=this.__;e.resize(this.__,n),e.smooth!==t&&(e.smooth=t)}}destroy(){this.canvas&&=(this.canvas.destroy(),null),super.destroy()}};q([ro(ml)],lu.prototype,`__`,void 0),q([Nc(100)],lu.prototype,`width`,void 0),q([Nc(100)],lu.prototype,`height`,void 0),q([Nc(1)],lu.prototype,`pixelRatio`,void 0),q([Nc(!0)],lu.prototype,`smooth`,void 0),q([Ma(!1)],lu.prototype,`safeResize`,void 0),q([Nc()],lu.prototype,`contextSettings`,void 0),lu=q([po()],lu);var{copyAndSpread:uu,includes:du,spread:fu,setList:pu}=A,{stintSet:mu}=w,X=class extends Y{get __tag(){return`Text`}get textDrawData(){return this.updateLayout(),this.__.__textDrawData}__updateTextDrawData(){let e=this.__,{lineHeight:t,letterSpacing:n,fontFamily:r,fontSize:i,fontWeight:a,italic:o,textCase:s,textOverflow:c,padding:l,width:u,height:d}=e;e.__lineHeight=Lc.number(t,i),e.__letterSpacing=Lc.number(n,i),e.__baseLine=e.__lineHeight-(e.__lineHeight-.7*i)/2,e.__font=`${o?`italic `:``}${s===`small-caps`?`small-caps `:``}${a===`normal`?``:a+` `}${i||12}px ${r||`caption`}`,mu(e,`__padding`,l&&Ce.fourNumber(l)),mu(e,`__clipText`,c!==`show`&&!e.__autoSize),mu(e,`__isCharMode`,u||d||e.__letterSpacing||s!==`none`),e.__textDrawData=Fc.getDrawData((e.__isPlacehold=e.placeholder&&e.text===``)?e.placeholder:e.text,this.__)}__updateBoxBounds(){let e=this.__,t=this.__layout,{fontSize:n,italic:r,padding:i,__autoWidth:a,__autoHeight:o}=e;this.__updateTextDrawData();let{bounds:s}=e.__textDrawData,c=t.boxBounds;if(t.contentBounds=s,e.__lineHeight<n&&fu(s,n/2),a||o){if(c.x=a?s.x:0,c.y=o?s.y:0,c.width=a?s.width:e.width,c.height=o?s.height:e.height,i){let[t,n,r,i]=e.__padding;a&&(c.x-=i,c.width+=n+i),o&&(c.y-=t,c.height+=r+t)}this.__updateNaturalSize()}else super.__updateBoxBounds();r&&(c.width+=.16*n),w.stintSet(this,`isOverflow`,!du(c,s)),this.isOverflow?(pu(e.__textBoxBounds={},[c,s]),t.renderChanged=!0):e.__textBoxBounds=c}__updateRenderSpread(){let e=super.__updateRenderSpread();return e||=this.isOverflow?1:0,e}__updateRenderBounds(){let{renderBounds:e,renderSpread:t}=this.__layout;uu(e,this.__.__textBoxBounds,t),this.__box&&(this.__box.__layout.renderBounds=e)}__updateChange(){super.__updateChange();let e=this.__box;e&&(e.__onUpdateSize(),e.__updateChange())}__drawRenderPath(e){e.font=this.__.__font}__draw(e,t,n){let r=this.__box;r&&(r.__nowWorld=this.__nowWorld,r.__draw(e,t,n)),this.textEditing&&!t.exporting||super.__draw(e,t,n)}__drawShape(e,t){t.shape&&this.__box&&this.__box.__drawShape(e,t),super.__drawShape(e,t)}destroy(){this.boxStyle&&=null,super.destroy()}};q([ro(fl)],X.prototype,`__`,void 0),q([B(0)],X.prototype,`width`,void 0),q([B(0)],X.prototype,`height`,void 0),q([Ka()],X.prototype,`boxStyle`,void 0),q([Ma(!1)],X.prototype,`resizeFontSize`,void 0),q([Ka(`#000000`)],X.prototype,`fill`,void 0),q([Ha(`outside`)],X.prototype,`strokeAlign`,void 0),q([to(`all`)],X.prototype,`hitFill`,void 0),q([B(``)],X.prototype,`text`,void 0),q([B(``)],X.prototype,`placeholder`,void 0),q([B(`caption`)],X.prototype,`fontFamily`,void 0),q([B(12)],X.prototype,`fontSize`,void 0),q([B(`normal`)],X.prototype,`fontWeight`,void 0),q([B(!1)],X.prototype,`italic`,void 0),q([B(`none`)],X.prototype,`textCase`,void 0),q([B(`none`)],X.prototype,`textDecoration`,void 0),q([B(0)],X.prototype,`letterSpacing`,void 0),q([B({type:`percent`,value:1.5})],X.prototype,`lineHeight`,void 0),q([B(0)],X.prototype,`paraIndent`,void 0),q([B(0)],X.prototype,`paraSpacing`,void 0),q([B(`x`)],X.prototype,`writingMode`,void 0),q([B(`left`)],X.prototype,`textAlign`,void 0),q([B(`top`)],X.prototype,`verticalAlign`,void 0),q([B(!0)],X.prototype,`autoSizeAlign`,void 0),q([B(`normal`)],X.prototype,`textWrap`,void 0),q([B(`show`)],X.prototype,`textOverflow`,void 0),q([Ka(!1)],X.prototype,`textEditing`,void 0),X=q([po()],X);var hu=class extends Y{get __tag(){return`Path`}};q([ro(ll)],hu.prototype,`__`,void 0),q([Ha(`center`)],hu.prototype,`strokeAlign`,void 0),hu=q([po()],hu);var gu=class extends Cl{get __tag(){return`Pen`}setStyle(e){let t=this.pathElement=new hu(e);return this.pathStyle=e,this.__path=t.path||=[],this.add(t),this}beginPath(){return this}moveTo(e,t){return this}lineTo(e,t){return this}bezierCurveTo(e,t,n,r,i,a){return this}quadraticCurveTo(e,t,n,r){return this}closePath(){return this}rect(e,t,n,r){return this}roundRect(e,t,n,r,i){return this}ellipse(e,t,n,r,i,a,o,s){return this}arc(e,t,n,r,i,a){return this}arcTo(e,t,n,r,i){return this}drawEllipse(e,t,n,r,i,a,o,s){return this}drawArc(e,t,n,r,i,a){return this}drawPoints(e,t,n){return this}clearPath(){return this}paint(){this.pathElement.__layout.boxChanged||this.pathElement.forceUpdate(`path`)}};q([ro(ul)],gu.prototype,`__`,void 0),q([(e,t)=>{Da(e,t,{get(){return this.__path}})}],gu.prototype,`path`,void 0),gu=q([fo(li,[`set`,`path`,`paint`]),po()],gu);function _u(e,t,n,r){var i,a=arguments.length,o=a<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r;if(typeof Reflect==`object`&&typeof Reflect.decorate==`function`)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}var vu=class extends El{get __tag(){return`App`}get isApp(){return!0}constructor(e,t){super(e,t)}init(e,t){if(super.init(e,t),e){let{ground:t,tree:n,sky:r,editor:i}=e;t&&(this.ground=this.addLeafer(t)),(n||i)&&(this.tree=this.addLeafer(n||{type:e.type||`design`})),(r||i)&&(this.sky=this.addLeafer(r)),i&&N.editor(i,this)}}__setApp(){let{canvas:e}=this,{realCanvas:t,view:n}=this.config;t||n===this.canvas.view||!e.parentView?this.realCanvas=!0:e.unrealCanvas(),this.leafer=this,this.watcher.disable(),this.layouter.disable()}__updateLocalBounds(){this.forEach(e=>e.updateLayout()),super.__updateLocalBounds()}start(){super.start(),this.forEach(e=>e.start())}stop(){this.forEach(e=>e.stop()),super.stop()}unlockLayout(){super.unlockLayout(),this.forEach(e=>e.unlockLayout())}lockLayout(){super.lockLayout(),this.forEach(e=>e.lockLayout())}forceRender(e,t){this.forEach(n=>n.forceRender(e,t))}addLeafer(e){let t=new El(e);return this.add(t),t}add(e,t){if(!e.view){if(this.realCanvas&&!this.canvas.bounds)return void setTimeout(()=>this.add(e,t),10);e.init(this.__getChildConfig(e.userConfig),this)}super.add(e,t),_(t)||(e.canvas.childIndex=t),this.__listenChildEvents(e)}forEach(e){this.children.forEach(e)}__onCreated(){this.created=this.children.every(e=>e.created)}__onReady(){this.children.every(e=>e.ready)&&super.__onReady()}__onViewReady(){this.children.every(e=>e.viewReady)&&super.__onViewReady()}__onChildRenderEnd(e){this.renderer.addBlock(e.renderBounds),this.viewReady&&this.renderer.update()}__render(e,t){e.context&&this.forEach(n=>t.matrix?n.__render(e,t):e.copyWorld(n.canvas,t.bounds))}__onResize(e){this.forEach(t=>t.resize(e)),super.__onResize(e)}updateLayout(){this.forEach(e=>e.updateLayout())}__getChildConfig(e){let t=Object.assign({},this.config);return t.hittable=t.realCanvas=void 0,e&&w.assign(t,e),this.autoLayout&&w.copyAttrs(t,this,Qt),t.view=this.realCanvas?void 0:this.view,t.fill=void 0,t}__listenChildEvents(e){e.once([[U.END,this.__onReady,this],[W.START,this.__onCreated,this],[W.END,this.__onViewReady,this]]),this.realCanvas&&this.__eventIds.push(e.on_(W.END,this.__onChildRenderEnd,this))}};vu=_u([po()],vu);var yu={},bu={isHoldSpaceKey:()=>bu.isHold(`Space`),isHold:e=>yu[e],isHoldKeys:(e,t)=>t?e(t):void 0,setDownCode(e){yu[e]||(yu[e]=!0)},setUpCode(e){yu[e]=!1}},xu={LEFT:1,RIGHT:2,MIDDLE:4,defaultLeft(e){e.buttons||=1},left:e=>e.buttons===1,right:e=>e.buttons===2,middle:e=>e.buttons===4},Su=class extends Zo{get spaceKey(){return bu.isHoldSpaceKey()}get left(){return xu.left(this)}get right(){return xu.right(this)}get middle(){return xu.middle(this)}constructor(e){super(e.type),this.bubbles=!0,Object.assign(this,e)}isHoldKeys(e){return bu.isHoldKeys(e,this)}getBoxPoint(e){return(e||this.current).getBoxPoint(this)}getInnerPoint(e){return(e||this.current).getInnerPoint(this)}getLocalPoint(e){return(e||this.current).getLocalPoint(this)}getPagePoint(){return this.current.getPagePoint(this)}getInner(e){return this.getInnerPoint(e)}getLocal(e){return this.getLocalPoint(e)}getPage(){return this.getPagePoint()}static changeName(e,t){Bt.changeName(e,t)}},{min:Cu,max:wu,abs:Tu}=Math,{float:Eu,sign:Du}=Ce,{minX:Ou,maxX:ku,minY:Au,maxY:ju}=A,Z=new wt,Mu=new wt,Nu={limitMove(e,t){let{dragBounds:n,dragBoundsType:r}=e;n&&Pu.getValidMove(e.__localBoxBounds,Pu.getDragBounds(e),r,t,!0),Pu.axisMove(e,t)},limitScaleOf(e,t,n,r){let{dragBounds:i,dragBoundsType:a}=e;i&&Pu.getValidScaleOf(e.__localBoxBounds,Pu.getDragBounds(e),a,e.getLocalPointByInner(e.getInnerPointByBox(t)),n,r,!0)},axisMove(e,t){let{draggable:n}=e;n===`x`&&(t.y=0),n===`y`&&(t.x=0)},getDragBounds(e){let{dragBounds:t}=e;return t===`parent`?e.parent.boxBounds:t},isInnerMode:(e,t,n,r)=>n===`inner`||n===`auto`&&e[r]>t[r],getValidMove(e,t,n,r,i){let a=e.x+r.x,o=e.y+r.y,s=a+e.width,c=o+e.height,l=t.x+t.width,u=t.y+t.height;return i||(r=Object.assign({},r)),Pu.isInnerMode(e,t,n,`width`)?a>t.x?r.x+=t.x-a:s<l&&(r.x+=l-s):a<t.x?r.x+=t.x-a:s>l&&(r.x+=l-s),Pu.isInnerMode(e,t,n,`height`)?o>t.y?r.y+=t.y-o:c<u&&(r.y+=u-c):o<t.y?r.y+=t.y-o:c>u&&(r.y+=u-c),r.x=Eu(r.x),r.y=Eu(r.y),r},getValidScaleOf(e,t,n,r,i,a,o){o||(i=Object.assign({},i)),Mu.set(t),Z.set(e).scaleOf(r,i.x,i.y);let s=(r.x-e.x)/e.width,c=1-s,l=(r.y-e.y)/e.height,u=1-l,d,f,p,m,h=1,g=1;return Pu.isInnerMode(e,t,n,`width`)?(i.x<0&&Z.scaleOf(r,h=1/i.x,1),p=Eu(Z.minX-Mu.minX),m=Eu(Mu.maxX-Z.maxX),d=s&&p>0?1+p/(s*Z.width):1,f=c&&m>0?1+m/(c*Z.width):1,h*=wu(d,f)):(i.x<0&&((Eu(Ou(e)-Ou(t))<=0||Eu(ku(t)-ku(e))<=0)&&Z.scaleOf(r,h=1/i.x,1),Z.unsign()),p=Eu(Mu.minX-Z.minX),m=Eu(Z.maxX-Mu.maxX),d=s&&p>0?1-p/(s*Z.width):1,f=c&&m>0?1-m/(c*Z.width):1,h*=Cu(d,f)),Pu.isInnerMode(e,t,n,`height`)?(i.y<0&&Z.scaleOf(r,1,g=1/i.y),p=Eu(Z.minY-Mu.minY),m=Eu(Mu.maxY-Z.maxY),d=l&&p>0?1+p/(l*Z.height):1,f=u&&m>0?1+m/(u*Z.height):1,g*=wu(d,f),a&&(d=wu(Tu(h),Tu(g)),h=Du(h)*d,g=Du(g)*d)):(i.y<0&&((Eu(Au(e)-Au(t))<=0||Eu(ju(t)-ju(e))<=0)&&Z.scaleOf(r,1,g=1/i.y),Z.unsign()),p=Eu(Mu.minY-Z.minY),m=Eu(Z.maxY-Mu.maxY),d=l&&p>0?1-p/(l*Z.height):1,f=u&&m>0?1-m/(u*Z.height):1,g*=Cu(d,f)),i.x*=b(h)?h:1,i.y*=b(g)?g:1,i}},Pu=Nu,Q=class extends Su{};Q.POINTER=`pointer`,Q.BEFORE_DOWN=`pointer.before_down`,Q.BEFORE_MOVE=`pointer.before_move`,Q.BEFORE_UP=`pointer.before_up`,Q.DOWN=`pointer.down`,Q.MOVE=`pointer.move`,Q.UP=`pointer.up`,Q.OVER=`pointer.over`,Q.OUT=`pointer.out`,Q.ENTER=`pointer.enter`,Q.LEAVE=`pointer.leave`,Q.TAP=`tap`,Q.DOUBLE_TAP=`double_tap`,Q.CLICK=`click`,Q.DOUBLE_CLICK=`double_click`,Q.LONG_PRESS=`long_press`,Q.LONG_TAP=`long_tap`,Q.MENU=`pointer.menu`,Q.MENU_TAP=`pointer.menu_tap`,Q=_u([mo()],Q);var Fu={},$=class extends Q{static setList(e){this.list=e instanceof K?e:new K(e)}static setData(e){this.data=e}static getValidMove(e,t,n,r=!0){let i=e.getLocalPoint(n,null,!0);return k.move(i,t.x-e.x,t.y-e.y),r&&this.limitMove(e,i),Nu.axisMove(e,i),i}static limitMove(e,t){Nu.limitMove(e,t)}getPageMove(e){return this.assignMove(e),this.current.getPagePoint(Fu,null,!0)}getInnerMove(e,t){return e||=this.current,this.assignMove(t),e.getInnerPoint(Fu,null,!0)}getLocalMove(e,t){return e||=this.current,this.assignMove(t),e.getLocalPoint(Fu,null,!0)}getPageTotal(){return this.getPageMove(!0)}getInnerTotal(e){return this.getInnerMove(e,!0)}getLocalTotal(e){return this.getLocalMove(e,!0)}getPageBounds(){let e=this.getPageTotal(),t=this.getPagePoint(),n={};return A.set(n,t.x-e.x,t.y-e.y,e.x,e.y),A.unsign(n),n}assignMove(e){Fu.x=e?this.totalX:this.moveX,Fu.y=e?this.totalY:this.moveY}};$.BEFORE_DRAG=`drag.before_drag`,$.START=`drag.start`,$.DRAG=`drag`,$.END=`drag.end`,$.OVER=`drag.over`,$.OUT=`drag.out`,$.ENTER=`drag.enter`,$.LEAVE=`drag.leave`,$=_u([mo()],$);var Iu=class extends Q{static setList(e){$.setList(e)}static setData(e){$.setData(e)}};Iu.DROP=`drop`,Iu=_u([mo()],Iu);var Lu=class extends ${};Lu.BEFORE_MOVE=`move.before_move`,Lu.START=`move.start`,Lu.MOVE=`move`,Lu.END=`move.end`,Lu=_u([mo()],Lu);var Ru=class extends Su{};Ru=_u([mo()],Ru);var zu=class extends Q{};zu.BEFORE_ROTATE=`rotate.before_rotate`,zu.START=`rotate.start`,zu.ROTATE=`rotate`,zu.END=`rotate.end`,zu=_u([mo()],zu);var Bu=class extends ${};Bu.SWIPE=`swipe`,Bu.LEFT=`swipe.left`,Bu.RIGHT=`swipe.right`,Bu.UP=`swipe.up`,Bu.DOWN=`swipe.down`,Bu=_u([mo()],Bu);var Vu=class extends Q{};Vu.BEFORE_ZOOM=`zoom.before_zoom`,Vu.START=`zoom.start`,Vu.ZOOM=`zoom`,Vu.END=`zoom.end`,Vu=_u([mo()],Vu);var Hu=class extends Su{};Hu.BEFORE_DOWN=`key.before_down`,Hu.BEFORE_UP=`key.before_up`,Hu.DOWN=`key.down`,Hu.HOLD=`key.hold`,Hu.UP=`key.up`,Hu=_u([mo()],Hu);var Uu={getDragEventData:(e,t,n)=>Object.assign(Object.assign({},n),{x:n.x,y:n.y,moveX:n.x-t.x,moveY:n.y-t.y,totalX:n.x-e.x,totalY:n.y-e.y}),getDropEventData:(e,t,n)=>Object.assign(Object.assign({},e),{list:t,data:n}),getSwipeDirection:e=>e<-45&&e>-135?Bu.UP:e>45&&e<135?Bu.DOWN:e<=45&&e>=-45?Bu.RIGHT:Bu.LEFT,getSwipeEventData:(e,t,n)=>Object.assign(Object.assign({},n),{moveX:t.moveX,moveY:t.moveY,totalX:n.x-e.x,totalY:n.y-e.y,type:Wu.getSwipeDirection(k.getAngle(e,n))}),getBase(e){let t=e.button===1?4:e.button;return{altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,buttons:_(e.buttons)?1:e.buttons===0?t:e.buttons,origin:e}},pathHasEventType(e,t){let{list:n}=e;for(let e=0,r=n.length;e<r;e++)if(n[e].hasEvent(t))return!0;return!1},filterPathByEventType(e,t){let n=new K,{list:r}=e;for(let e=0,i=r.length;e<i;e++)r[e].hasEvent(t)&&n.add(r[e]);return n},pathCanDrag:e=>e&&e.list.some(e=>To.draggable(e)||!e.isLeafer&&e.hasEvent($.DRAG)),pathHasOutside:e=>e&&e.list.some(e=>e.isOutside)},Wu=Uu,Gu=new K,{getDragEventData:Ku,getDropEventData:qu,getSwipeEventData:Ju}=Uu,Yu=class{constructor(e){this.interaction=e}setDragData(e){this.animateWait&&this.dragEndReal(),this.downData=this.interaction.downData,this.dragData=Ku(e,e,e),this.canAnimate=this.canDragOut=!0}getList(e,t){let{proxy:n}=this.interaction.selector,r=n&&n.list.length,i=$.list||this.draggableList||Gu;return this.dragging&&(r?e?Gu:new K(t?[...n.list,...n.dragHoverExclude]:n.list):i)}checkDrag(e,t){let{interaction:n}=this;if(this.moving&&e.buttons<1)return this.canAnimate=!1,void n.pointerCancel();!this.moving&&t&&(this.moving=n.canMove(this.downData)||n.isHoldRightKey||n.isMobileDragEmpty)&&(this.dragData.moveType=`drag`,n.emit(Lu.START,this.dragData)),this.moving||this.dragStart(e,t),this.drag(e)}dragStart(e,t){this.dragging||(this.dragging=t&&xu.left(e),this.dragging&&(this.interaction.emit($.START,this.dragData),this.getDraggableList(this.dragData.path),this.setDragStartPoints(this.realDraggableList=this.getList(!0))))}setDragStartPoints(e){this.dragStartPoints={},e.forEach(e=>this.dragStartPoints[e.innerId]={x:e.x,y:e.y})}getDraggableList(e){let t;for(let n=0,r=e.length;n<r;n++)if(t=e.list[n],To.draggable(t)){this.draggableList=new K(t);break}}drag(e){let{interaction:t,dragData:n,downData:r}=this,{path:i,throughPath:a}=r;this.dragData=Ku(r,n,e),a&&(this.dragData.throughPath=a),this.dragData.path=i,this.moving?(this.dragData.moveType=`drag`,t.emit(Lu.BEFORE_MOVE,this.dragData),t.emit(Lu.MOVE,this.dragData)):this.dragging&&(this.dragReal(),t.emit($.BEFORE_DRAG,this.dragData),t.emit($.DRAG,this.dragData))}dragReal(e){let{interaction:t}=this,{running:n}=t,r=this.realDraggableList;if(r.length&&n){let{totalX:n,totalY:i}=this.dragData,{dragLimitAnimate:a}=t.p,o=!a||!!e;r.forEach(t=>{if(t.draggable){let r=y(t.draggable),s=$.getValidMove(t,this.dragStartPoints[t.innerId],{x:n,y:i},o||r);a&&!r&&e?To.animateMove(t,s,x(a)?a:.3):t.move(s)}})}}dragOverOrOut(e){let{interaction:t}=this,{dragOverPath:n}=this,{path:r}=e;this.dragOverPath=r,n?r.indexAt(0)!==n.indexAt(0)&&(t.emit($.OUT,e,n),t.emit($.OVER,e,r)):t.emit($.OVER,e,r)}dragEnterOrLeave(e){let{interaction:t}=this,{dragEnterPath:n}=this,{path:r}=e;t.emit($.LEAVE,e,n,r),t.emit($.ENTER,e,r,n),this.dragEnterPath=r}dragEnd(e,t){(this.dragging||this.moving)&&(this.checkDragEndAnimate(e,t)||this.dragEndReal(e))}dragEndReal(e){let{interaction:t,downData:n,dragData:r}=this;e||=r;let{path:i,throughPath:a}=n,o=Ku(n,e,e);if(a&&(o.throughPath=a),o.path=i,this.moving&&(this.moving=!1,o.moveType=`drag`,t.emit(Lu.END,o)),this.dragging){let i=this.getList();this.dragging=!1,t.p.dragLimitAnimate&&this.dragReal(!0),t.emit($.END,o),this.swipe(e,n,r,o),this.drop(e,i,this.dragEnterPath)}this.autoMoveCancel(),this.dragReset(),this.animate(null,`off`)}swipe(e,t,n,r){let{interaction:i}=this;if(k.getDistance(t,e)>i.config.pointer.swipeDistance){let e=Ju(t,n,r);this.interaction.emit(e.type,e)}}drop(e,t,n){let r=qu(e,t,$.data);r.path=n,this.interaction.emit(Iu.DROP,r),this.interaction.emit($.LEAVE,e,n)}dragReset(){$.list=$.data=this.draggableList=this.dragData=this.downData=this.dragOverPath=this.dragEnterPath=null}checkDragEndAnimate(e,t){return!1}animate(e,t){}checkDragOut(e){}autoMoveOnDragOut(e){}autoMoveCancel(){}destroy(){this.dragReset()}},Xu=M.get(`emit`),Zu=[`move`,`zoom`,`rotate`,`key`];function Qu(e,t,n,r,i){if(Zu.some(e=>t.startsWith(e))&&e.__.hitChildren&&!ed(e,i)){let a;for(let o=0,s=e.children.length;o<s;o++)a=e.children[o],!n.path.has(a)&&a.__.hittable&&$u(a,t,n,r,i)}}function $u(e,t,n,r,i){if(e.destroyed)return!1;if(e.__.hitSelf&&!ed(e,i)&&(Wc.updateEventStyle&&!r&&Wc.updateEventStyle(e,t),e.hasEvent(t,r))){n.phase=r?1:e===n.target?2:3;let i=Bt.get(t,n);if(e.emitEvent(i,r),i.isStop)return!0}return!1}function ed(e,t){return t&&t.has(e)}var td={wheel:{zoomSpeed:.5,moveSpeed:.5,rotateSpeed:.5,delta:{x:20,y:8}},pointer:{type:`pointer`,snap:!0,hitRadius:5,tapTime:120,longPressTime:800,transformTime:500,hover:!0,dragHover:!0,dragDistance:2,swipeDistance:20},touch:{preventDefault:`auto`},multiTouch:{},move:{autoDistance:2},zoom:{},cursor:!0,keyEvent:!0},{pathHasEventType:nd,pathCanDrag:rd,pathHasOutside:id}=Uu,ad=class{get dragging(){return this.dragger.dragging}get transforming(){return this.transformer.transforming}get moveMode(){return!0===this.m.drag||this.isHoldSpaceKey||this.isHoldMiddleKey||this.isHoldRightKey&&this.dragger.moving||this.isDragEmpty}get canHover(){return this.p.hover&&!this.config.mobile}get isDragEmpty(){return this.m.dragEmpty&&this.isRootPath(this.hoverData)&&(!this.downData||this.isRootPath(this.downData))}get isMobileDragEmpty(){return this.m.dragEmpty&&!this.canHover&&this.downData&&this.isTreePath(this.downData)}get isHoldMiddleKey(){return this.m.holdMiddleKey&&this.downData&&xu.middle(this.downData)}get isHoldRightKey(){return this.m.holdRightKey&&this.downData&&xu.right(this.downData)}get isHoldSpaceKey(){return this.m.holdSpaceKey&&bu.isHoldSpaceKey()}get m(){return this.config.move}get p(){return this.config.pointer}get hitRadius(){return this.p.hitRadius}constructor(e,t,n,r){this.config=w.clone(td),this.tapCount=0,this.downKeyMap={},this.target=e,this.canvas=t,this.selector=n,this.defaultPath=new K(e),this.createTransformer(),this.dragger=new Yu(this),r&&(this.config=w.default(r,this.config)),this.__listenEvents()}start(){this.running=!0}stop(){this.running=!1}receive(e){}pointerDown(e,t){e||=this.hoverData,e&&(xu.defaultLeft(e),this.updateDownData(e),this.checkPath(e,t),this.downTime=Date.now(),this.emit(Q.BEFORE_DOWN,e),this.emit(Q.DOWN,e),xu.left(e)&&(this.tapWait(),this.longPressWait(e)),this.waitRightTap=xu.right(e),this.dragger.setDragData(e),this.isHoldRightKey||this.updateCursor(e))}pointerMove(e){if(e||=this.hoverData,!e)return;let{downData:t}=this;t&&xu.defaultLeft(e),(this.canvas.bounds.hitPoint(e)||t)&&(this.pointerMoveReal(e),t&&this.dragger.checkDragOut(e))}pointerMoveReal(e){if(this.emit(Q.BEFORE_MOVE,e,this.defaultPath),this.downData){let t=k.getDistance(this.downData,e)>this.p.dragDistance;t&&(this.pointerWaitCancel(),this.waitRightTap=!1),this.dragger.checkDrag(e,t)}this.dragger.moving||(this.updateHoverData(e),this.checkPath(e),this.emit(Q.MOVE,e),this.pointerHover(e),this.dragging&&(this.dragger.dragOverOrOut(e),this.dragger.dragEnterOrLeave(e))),this.updateCursor(this.downData||e)}pointerUp(e){let{downData:t}=this;if(e||=t,!t)return;xu.defaultLeft(e),e.multiTouch=t.multiTouch,this.findPath(e);let n=Object.assign(Object.assign({},e),{path:e.path.clone()});e.path.addList(t.path.list),this.checkPath(e),this.downData=null,this.emit(Q.BEFORE_UP,e),this.emit(Q.UP,e),this.touchLeave(e),e.isCancel||(this.tap(e),this.menuTap(e)),this.dragger.dragEnd(e),this.updateCursor(n)}pointerCancel(){let e=Object.assign({},this.dragger.dragData);e.isCancel=!0,this.pointerUp(e)}menu(e){this.findPath(e),this.emit(Q.MENU,e),this.waitMenuTap=!0,!this.downData&&this.waitRightTap&&this.menuTap(e)}menuTap(e){this.waitRightTap&&this.waitMenuTap&&(this.emit(Q.MENU_TAP,e),this.waitRightTap=this.waitMenuTap=!1)}createTransformer(){}move(e){}zoom(e){}rotate(e){}transformEnd(){}wheel(e){}multiTouch(e,t){}keyDown(e){if(!this.config.keyEvent)return;this.emit(Hu.BEFORE_DOWN,e,this.defaultPath);let{code:t}=e;this.downKeyMap[t]||(this.downKeyMap[t]=!0,bu.setDownCode(t),this.emit(Hu.HOLD,e,this.defaultPath),this.moveMode&&(this.cancelHover(),this.updateCursor())),this.emit(Hu.DOWN,e,this.defaultPath)}keyUp(e){if(!this.config.keyEvent)return;this.emit(Hu.BEFORE_UP,e,this.defaultPath);let{code:t}=e;this.downKeyMap[t]=!1,bu.setUpCode(t),this.emit(Hu.UP,e,this.defaultPath),this.cursor===`grab`&&this.updateCursor()}pointerHover(e){!this.canHover||this.dragging&&!this.p.dragHover||(e.path||=new K,this.pointerOverOrOut(e),this.pointerEnterOrLeave(e))}pointerOverOrOut(e){let{path:t}=e,{overPath:n}=this;this.overPath=t,n?t.indexAt(0)!==n.indexAt(0)&&(this.emit(Q.OUT,e,n),this.emit(Q.OVER,e,t)):this.emit(Q.OVER,e,t)}pointerEnterOrLeave(e){let{path:t}=e;this.downData&&!this.moveMode&&(t=t.clone(),this.downData.path.forEach(e=>t.add(e)));let{enterPath:n}=this;this.enterPath=t,this.emit(Q.LEAVE,e,n,t),this.emit(Q.ENTER,e,t,n)}touchLeave(e){e.pointerType===`touch`&&this.enterPath&&(this.emit(Q.LEAVE,e),this.dragger.dragging&&this.emit(Iu.LEAVE,e))}tap(e){let{pointer:t}=this.config,n=this.longTap(e);if(!t.tapMore&&n||!this.waitTap)return;t.tapMore&&this.emitTap(e);let r=Date.now()-this.downTime,i=[Q.DOUBLE_TAP,Q.DOUBLE_CLICK].some(t=>nd(e.path,t));r<t.tapTime+50&&i?(this.tapCount++,this.tapCount===2?(this.tapWaitCancel(),this.emitDoubleTap(e)):(clearTimeout(this.tapTimer),this.tapTimer=setTimeout(()=>{t.tapMore||(this.tapWaitCancel(),this.emitTap(e))},t.tapTime))):t.tapMore||(this.tapWaitCancel(),this.emitTap(e))}findPath(e,t){let{hitRadius:n,through:r}=this.p,{bottomList:i,target:a}=this;T.backgrounder||e.origin||a&&a.updateLayout();let o=this.selector.getByPoint(e,n,Object.assign({bottomList:i,name:e.type},t||{through:r}));return o.throughPath&&(e.throughPath=o.throughPath),e.path=o.path,o.path}isRootPath(e){return e&&e.path.list[0].isLeafer}isTreePath(e){let t=this.target.app;return!(!t||!t.isApp)&&t.editor&&!e.path.has(t.editor)&&e.path.has(t.tree)&&!e.target.syncEventer}checkPath(e,t){(t||this.moveMode&&!id(e.path))&&(e.path=this.defaultPath)}canMove(e){return e&&(this.moveMode||this.m.drag===`auto`&&!rd(e.path))&&!id(e.path)}isDrag(e){return this.dragger.getList().has(e)}isPress(e){return this.downData&&this.downData.path.has(e)}isHover(e){return this.enterPath&&this.enterPath.has(e)}isFocus(e){return this.focusData===e}cancelHover(){let{hoverData:e}=this;e&&(e.path=this.defaultPath,this.pointerHover(e))}updateDownData(e,t,n){let{downData:r}=this;!e&&r&&(e=r),e&&(this.findPath(e,t),n&&r&&e.path.addList(r.path.list),this.downData=e)}updateHoverData(e){e||=this.hoverData,e&&(this.findPath(e,{exclude:this.dragger.getList(!1,!0),name:Q.MOVE}),this.hoverData=e)}updateCursor(e){if(!this.config.cursor||!this.canHover)return;if(e||=(this.updateHoverData(),this.downData||this.hoverData),this.dragger.moving)return this.setCursor(`grabbing`);if(this.canMove(e))return this.setCursor(this.downData?`grabbing`:`grab`);if(!e)return;let t,n,{path:r}=e;for(let e=0,i=r.length;e<i&&(t=r.list[e],n=t.syncEventer&&t.syncEventer.cursor||t.cursor,!n);e++);this.setCursor(n)}setCursor(e){this.cursor=e}getLocal(e,t){let n=this.canvas.getClientBounds(t),r={x:e.clientX-n.x,y:e.clientY-n.y},{bounds:i}=this.canvas;return r.x*=i.width/n.width,r.y*=i.height/n.height,this.p.snap&&k.round(r),r}emitTap(e){this.emit(Q.TAP,e),this.emit(Q.CLICK,e)}emitDoubleTap(e){this.emit(Q.DOUBLE_TAP,e),this.emit(Q.DOUBLE_CLICK,e)}pointerWaitCancel(){this.tapWaitCancel(),this.longPressWaitCancel()}tapWait(){clearTimeout(this.tapTimer),this.waitTap=!0}tapWaitCancel(){this.waitTap&&(clearTimeout(this.tapTimer),this.waitTap=!1,this.tapCount=0)}longPressWait(e){clearTimeout(this.longPressTimer),this.longPressTimer=setTimeout(()=>{this.longPressed=!0,this.emit(Q.LONG_PRESS,e)},this.p.longPressTime)}longTap(e){let t;return this.longPressed&&(this.emit(Q.LONG_TAP,e),(nd(e.path,Q.LONG_TAP)||nd(e.path,Q.LONG_PRESS))&&(t=!0)),this.longPressWaitCancel(),t}longPressWaitCancel(){this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressed=!1)}__onResize(){let{dragOut:e}=this.m;this.shrinkCanvasBounds=new wt(this.canvas.bounds),this.shrinkCanvasBounds.spread(-(x(e)?e:2))}__listenEvents(){let{target:e}=this;this.__eventIds=[e.on_(ls.RESIZE,this.__onResize,this)],e.once(G.READY,()=>this.__onResize())}__removeListenEvents(){this.target.off_(this.__eventIds),this.__eventIds.length=0}emit(e,t,n,r){this.running&&function(e,t,n,r){if(!n&&!t.path)return;let i;t.type=e,n?t=Object.assign(Object.assign({},t),{path:n}):n=t.path,t.target=n.indexAt(0);try{for(let a=n.length-1;a>-1;a--){if(i=n.list[a],$u(i,e,t,!0,r))return;i.isApp&&Qu(i,e,t,!0,r)}for(let a=0,o=n.length;a<o;a++)if(i=n.list[a],i.isApp&&Qu(i,e,t,!1,r),$u(i,e,t,!1,r))return}catch(e){Xu.error(e)}}(e,t,n,r)}destroy(){this.__eventIds.length&&(this.stop(),this.__removeListenEvents(),this.dragger.destroy(),this.transformer&&this.transformer.destroy(),this.downData=this.overPath=this.enterPath=null)}},od=class{static set(e,t){this.custom[e]=t}static get(e){return this.custom[e]}};od.custom={};var sd=class extends Ht{constructor(){super(...arguments),this.maxTotal=1e3,this.pathList=new K,this.pixelList=new K}getPixelType(e,t){return this.__autoClear(),this.pixelList.add(e),N.hitCanvas(t)}getPathType(e){return this.__autoClear(),this.pathList.add(e),N.hitCanvas()}clearImageType(){this.__clearLeafList(this.pixelList)}clearPathType(){this.__clearLeafList(this.pathList)}__clearLeafList(e){e.length&&(e.forEach(e=>{e.__hitCanvas&&=(e.__hitCanvas.destroy(),null)}),e.reset())}__autoClear(){this.pathList.length+this.pixelList.length>this.maxTotal&&this.clear()}clear(){this.clearPathType(),this.clearImageType()}};T.getSelector=function(e){return e.leafer?e.leafer.selector:T.selector||=N.selector()};var{toInnerRadiusPointOf:cd,copy:ld,setRadius:ud}=k,{hitRadiusPoint:dd,hitPoint:fd}=A,pd={},md={},hd=bc.prototype;hd.hit=function(e,t=0){this.updateLayout(),ld(md,e),ud(md,t);let n=this.__world;return!!(t?dd(n,md):fd(n,md))&&(this.isBranch?T.getSelector(this).hitPoint(Object.assign({},md),t,{target:this}):this.__hitWorld(md))},hd.__hitWorld=function(e){let t=this.__;if(!t.hitSelf)return!1;let n=this.__world,r=this.__layout,i=n.width<10&&n.height<10;if(t.hitRadius&&(ld(pd,e),ud(e=pd,t.hitRadius)),cd(e,n,pd),t.hitBox||i){if(A.hitRadiusPoint(r.boxBounds,pd))return!0;if(i)return!1}return!r.hitCanvasChanged&&this.__hitCanvas||(this.__updateHitCanvas(),r.boundsChanged||(r.hitCanvasChanged=!1)),this.__hit(pd)},hd.__hitFill=function(e){let t=this.__hitCanvas;return t&&t.hitFill(e,this.__.windingRule)},hd.__hitStroke=function(e,t){let n=this.__hitCanvas;return n&&n.hitStroke(e,t)},hd.__hitPixel=function(e){let t=this.__hitCanvas;return t&&t.hitPixel(e,this.__layout.renderBounds,t.hitScale)},hd.__drawHitPath=function(e){e&&this.__drawRenderPath(e)};var gd=new Xe,_d=Y.prototype;_d.__updateHitCanvas=function(){this.__box&&this.__box.__updateHitCanvas();let{hitCanvasManager:e}=this.leafer||this.parent&&this.parent.leafer||{};if(!e)return;let t=this.__,n=(t.__isAlphaPixelFill||t.__isCanvas)&&t.hitFill===`pixel`,r=t.__isAlphaPixelStroke&&t.hitStroke===`pixel`,i=n||r;this.__hitCanvas||=i?e.getPixelType(this,{contextSettings:{willReadFrequently:!0}}):e.getPathType(this);let a=this.__hitCanvas;if(i){let{renderBounds:e}=this.__layout,i=T.image.hitCanvasSize,o=a.hitScale=Tt.set(0,0,i,i).getFitMatrix(e).a,{x:s,y:c,width:l,height:u}=Tt.set(e).scale(o);a.resize({width:l,height:u,pixelRatio:1}),a.clear(),Sa.patternLocked=!0,this.__renderShape(a,{matrix:gd.setWith(this.__world).scaleWith(1/o).invertWith().translate(-s,-c),ignoreFill:!n,ignoreStroke:!r}),Sa.patternLocked=!1,a.resetTransform(),t.__isHitPixel=!0}else t.__isHitPixel&&=!1;this.__drawHitPath(a),a.setStrokeOptions(t)},_d.__hit=function(e){if(this.__box&&this.__box.__hit(e))return!0;let t=this.__;if(t.__isHitPixel&&this.__hitPixel(e))return!0;let{hitFill:n}=t,r=(t.fill||t.__isCanvas)&&(n===`path`||n===`pixel`&&!(t.__isAlphaPixelFill||t.__isCanvas))||n===`all`;if(r&&this.__hitFill(e))return!0;let{hitStroke:i,__maxStrokeWidth:a}=t,o=t.stroke&&(i===`path`||i===`pixel`&&!t.__isAlphaPixelStroke)||i===`all`;if(!r&&!o)return!1;let s=2*e.radiusX,c=s;if(o)switch(t.strokeAlign){case`inside`:if(c+=2*a,!r&&this.__hitFill(e)&&this.__hitStroke(e,c))return!0;c=s;break;case`center`:c+=a;break;case`outside`:if(c+=2*a,!r){if(!this.__hitFill(e)&&this.__hitStroke(e,c))return!0;c=s}}return!!c&&this.__hitStroke(e,c)};var vd=Y.prototype,yd=Dl.prototype,bd=Nl.prototype;yd.__updateHitCanvas=bd.__updateHitCanvas=function(){this.stroke||this.cornerRadius||(this.fill||this.__.__isCanvas)&&this.hitFill===`pixel`||this.hitStroke===`all`?vd.__updateHitCanvas.call(this):this.__hitCanvas&&=null},yd.__hitFill=bd.__hitFill=function(e){return this.__hitCanvas?vd.__hitFill.call(this,e):A.hitRadiusPoint(this.__layout.boxBounds,e)},X.prototype.__drawHitPath=function(e){let{__lineHeight:t,fontSize:n,__baseLine:r,__letterSpacing:i,__textDrawData:a}=this.__;e.beginPath(),i<0?this.__drawPathByBox(e):a.rows.forEach(i=>e.rect(i.x,i.y-r,i.width,t<n?n:t))},Cl.prototype.pick=function(e,t){return t||=g,this.updateLayout(),T.getSelector(this).getByPoint(e,t.hitRadius||0,Object.assign(Object.assign({},t),{target:this}))};var xd=$t.prototype;xd.hitFill=function(e,t){return t?this.context.isPointInPath(e.x,e.y,t):this.context.isPointInPath(e.x,e.y)},xd.hitStroke=function(e,t){return this.strokeWidth=t,this.context.isPointInStroke(e.x,e.y)},xd.hitPixel=function(e,t,n=1){let{x:r,y:i,radiusX:a,radiusY:o}=e;t&&(r-=t.x,i-=t.y),Tt.set(r-a,i-o,2*a,2*o).scale(n).ceil();let{data:s}=this.context.getImageData(Tt.x,Tt.y,Tt.width||1,Tt.height||1);for(let e=0,t=s.length;e<t;e+=4)if(s[e+3]>0)return!0;return s[3]>0};var Sd=M.get(`LeaferCanvas`),Cd=class extends $t{set zIndex(e){let{style:t}=this.view;t.zIndex=e,this.setAbsolute(this.view)}set childIndex(e){let{view:t,parentView:n}=this;if(t&&n){let r=n.children[e];r?(this.setAbsolute(r),n.insertBefore(t,r)):n.appendChild(r)}}init(){let{config:e}=this,t=e.view||e.canvas;t?this.__createViewFrom(t):this.__createView();let{style:n}=this.view;if(n.display||=`block`,this.parentView=this.view.parentElement,this.parentView){let e=this.parentView.style;e.webkitUserSelect=e.userSelect=`none`}T.syncDomFont&&!this.parentView&&(n.display=`none`,document.body&&document.body.appendChild(this.view)),this.__createContext(),this.autoLayout||this.resize(e)}set backgroundColor(e){this.view.style.backgroundColor=e}get backgroundColor(){return this.view.style.backgroundColor}set hittable(e){this.view.style.pointerEvents=e?`auto`:`none`}get hittable(){return this.view.style.pointerEvents!==`none`}__createView(){this.view=document.createElement(`canvas`)}__createViewFrom(e){let t=y(e)?document.getElementById(e):e;if(t)if(t instanceof HTMLCanvasElement)this.view=t;else{let e=t;if(t===window||t===document){let t=document.createElement(`div`),{style:n}=t;n.position=`absolute`,n.top=n.bottom=n.left=n.right=`0px`,document.body.appendChild(t),e=t}this.__createView();let n=this.view;e.hasChildNodes()&&(this.setAbsolute(n),e.style.position||(e.style.position=`relative`)),e.appendChild(n)}else Sd.error(`no id: ${e}`),this.__createView()}setAbsolute(e){let{style:t}=e;t.position=`absolute`,t.top=t.left=`0px`}updateViewSize(){let{width:e,height:t,pixelRatio:n}=this,{style:r}=this.view;if(this.unreal){let{config:e,autoWidthStr:t,autoHeightStr:n}=this;e.width?(_(t)&&(this.autoWidthStr=r.width||``),r.width=e.width+`px`):_(t)||(r.width=t),e.height?(_(n)&&(this.autoHeightStr=r.height||``),r.height=e.height+`px`):_(n)||(r.height=n)}else r.width=e+`px`,r.height=t+`px`,this.view.width=Math.ceil(e*n),this.view.height=Math.ceil(t*n)}updateClientBounds(){this.view.parentElement&&(this.clientBounds=this.view.getBoundingClientRect())}startAutoLayout(e,t){if(this.resizeListener=t,e){if(this.autoBounds=e,this.resizeObserver)return;try{this.resizeObserver=new ResizeObserver(e=>{this.updateClientBounds();for(let t of e)this.checkAutoBounds(t.contentRect)});let e=this.parentView;e?(this.resizeObserver.observe(e),this.checkAutoBounds(e.getBoundingClientRect())):(this.checkAutoBounds(this.view),Sd.warn(`no parent`))}catch{this.imitateResizeObserver()}this.stopListenPixelRatio()}else this.listenPixelRatio(),this.unreal&&this.updateViewSize()}imitateResizeObserver(){this.autoLayout&&(this.parentView&&this.checkAutoBounds(this.parentView.getBoundingClientRect()),T.requestRender(this.imitateResizeObserver.bind(this)))}listenPixelRatio(){this.windowListener||window.addEventListener(`resize`,this.windowListener=()=>{let e=T.devicePixelRatio;if(!this.config.pixelRatio&&this.pixelRatio!==e){let{width:t,height:n}=this;this.emitResize({width:t,height:n,pixelRatio:e})}})}stopListenPixelRatio(){this.windowListener&&=(window.removeEventListener(`resize`,this.windowListener),null)}checkAutoBounds(e){let t=this.view,{x:n,y:r,width:i,height:a}=this.autoBounds.getBoundsFrom(e),o={width:i,height:a,pixelRatio:this.config.pixelRatio?this.pixelRatio:T.devicePixelRatio};if(!this.isSameSize(o)){let{style:e}=t;e.marginLeft=n+`px`,e.marginTop=r+`px`,this.emitResize(o)}}stopAutoLayout(){this.autoLayout=!1,this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeListener=this.resizeObserver=null}emitResize(e){let t={};w.copyAttrs(t,this,Qt),this.resize(e),this.resizeListener&&!_(this.width)&&this.resizeListener(new ls(e,t))}unrealCanvas(){if(!this.unreal&&this.parentView){let e=this.view;e&&e.remove(),this.view=this.parentView,this.unreal=!0}}destroy(){if(this.view){if(this.stopAutoLayout(),this.stopListenPixelRatio(),!this.unreal){let e=this.view;e.parentElement&&e.remove()}super.destroy()}}};pa(CanvasRenderingContext2D.prototype),pa(Path2D.prototype);var{mineType:wd,fileType:Td}=ma;function Ed(e,t){T.origin={createCanvas(e,t){let n=document.createElement(`canvas`);return n.width=e,n.height=t,n},canvasToDataURL:(e,t,n)=>{let r=wd(t),i=e.toDataURL(r,n);return r===`image/bmp`?i.replace(`image/png;`,`image/bmp;`):i},canvasToBolb:(e,t,n)=>new Promise(r=>e.toBlob(r,wd(t),n)),canvasSaveAs:(e,t,n)=>{let r=e.toDataURL(wd(Td(t)),n);return T.origin.download(r,t)},download:(e,t)=>new Promise(n=>{let r=document.createElement(`a`);r.href=e,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),n()}),loadImage:e=>new Promise((t,n)=>{let r=new T.origin.Image,{crossOrigin:i}=T.image;i&&(r.setAttribute(`crossOrigin`,i),r.crossOrigin=i),r.onload=()=>{t(r)},r.onerror=e=>{n(e)},r.src=T.image.getRealURL(e)}),Image,PointerEvent,DragEvent},T.event={stopDefault(e){e.preventDefault()},stopNow(e){e.stopImmediatePropagation()},stop(e){e.stopPropagation()}},T.canvas=N.canvas(),T.conicGradientSupport=!!T.canvas.context.createConicGradient}Object.assign(N,{canvas:(e,t)=>new Cd(e,t),image:e=>new Ea(e)}),T.name=`web`,T.isMobile=`ontouchstart`in window,T.requestRender=function(e){window.requestAnimationFrame(e)},Da(T,`devicePixelRatio`,{get:()=>devicePixelRatio});var{userAgent:Dd}=navigator;Dd.indexOf(`Firefox`)>-1?(T.conicGradientRotate90=!0,T.intWheelDeltaY=!0,T.syncDomFont=!0):(/iPhone|iPad|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent))&&(T.fullImageShadow=!0),Dd.indexOf(`Windows`)>-1?(T.os=`Windows`,T.intWheelDeltaY=!0):Dd.indexOf(`Mac`)>-1?T.os=`Mac`:Dd.indexOf(`Linux`)>-1&&(T.os=`Linux`);var Od=class{get childrenChanged(){return this.hasAdd||this.hasRemove||this.hasVisible}get updatedList(){if(this.hasRemove){let e=new K;return this.__updatedList.list.forEach(t=>{t.leafer&&e.add(t)}),e}return this.__updatedList}constructor(e,t){this.totalTimes=0,this.config={},this.__updatedList=new K,this.target=e,t&&(this.config=w.default(t,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}update(){this.changed=!0,this.running&&this.target.emit(W.REQUEST)}__onAttrChange(e){this.__updatedList.add(e.target),this.update()}__onChildEvent(e){e.type===Qo.ADD?(this.hasAdd=!0,this.__pushChild(e.child)):(this.hasRemove=!0,this.__updatedList.add(e.parent)),this.update()}__pushChild(e){this.__updatedList.add(e),e.isBranch&&this.__loopChildren(e)}__loopChildren(e){let{children:t}=e;for(let e=0,n=t.length;e<n;e++)this.__pushChild(t[e])}__onRquestData(){this.target.emitEvent(new us(us.DATA,{updatedList:this.updatedList})),this.__updatedList=new K,this.totalTimes++,this.changed=this.hasVisible=this.hasRemove=this.hasAdd=!1}__listenEvents(){this.__eventIds=[this.target.on_([[es.CHANGE,this.__onAttrChange,this],[[Qo.ADD,Qo.REMOVE],this.__onChildEvent,this],[us.REQUEST,this.__onRquestData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&=(this.stop(),this.__removeListenEvents(),this.__updatedList=null)}},{updateAllMatrix:kd,updateBounds:Ad,updateChange:jd}=To,{pushAllChildBranch:Md,pushAllParent:Nd}=Io,{worldBounds:Pd}=Mo,Fd=class{constructor(e){this.updatedBounds=new wt,this.beforeBounds=new wt,this.afterBounds=new wt,S(e)&&(e=new K(e)),this.updatedList=e}setBefore(){this.beforeBounds.setListWithFn(this.updatedList.list,Pd)}setAfter(){this.afterBounds.setListWithFn(this.updatedList.list,Pd),this.updatedBounds.setList([this.beforeBounds,this.afterBounds])}merge(e){this.updatedList.addList(e.updatedList.list),this.beforeBounds.add(e.beforeBounds),this.afterBounds.add(e.afterBounds),this.updatedBounds.add(e.updatedBounds)}destroy(){this.updatedList=null}},{updateAllMatrix:Id,updateAllChange:Ld}=To,Rd=M.get(`Layouter`),zd=class e{constructor(e,t){this.totalTimes=0,this.config={},this.__levelList=new jc,this.target=e,t&&(this.config=w.default(t,this.config)),this.__listenEvents()}start(){this.disabled||(this.running=!0)}stop(){this.running=!1}disable(){this.stop(),this.__removeListenEvents(),this.disabled=!0}layout(){if(this.layouting||!this.running)return;let{target:e}=this;this.times=0;try{e.emit(U.START),this.layoutOnce(),e.emitEvent(new U(U.END,this.layoutedBlocks,this.times))}catch(e){Rd.error(e)}this.layoutedBlocks=null}layoutAgain(){this.layouting?this.waitAgain=!0:this.layoutOnce()}layoutOnce(){return this.layouting?Rd.warn(`layouting`):this.times>3?Rd.warn(`layout max times`):(this.times++,this.totalTimes++,this.layouting=!0,this.target.emit(us.REQUEST),this.totalTimes>1?this.partLayout():this.fullLayout(),this.layouting=!1,void(this.waitAgain&&(this.waitAgain=!1,this.layoutOnce())))}partLayout(){if(!this.__updatedList?.length)return;let e=Mt.start(`PartLayout`),{target:t,__updatedList:n}=this,{BEFORE:r,LAYOUT:i,AFTER:a}=U,o=this.getBlocks(n);o.forEach(e=>e.setBefore()),t.emitEvent(new U(r,o,this.times)),this.extraBlock=null,n.sort(),function(e,t){let n;e.list.forEach(e=>{n=e.__layout,t.without(e)&&!n.proxyZoom&&(n.matrixChanged?(kd(e,!0),t.add(e),e.isBranch&&Md(e,t),Nd(e,t)):n.boundsChanged&&(t.add(e),e.isBranch&&(e.__tempNumber=0),Nd(e,t)))})}(n,this.__levelList),function(e){let t,n,r;e.sort(!0),e.levels.forEach(i=>{t=e.levelMap[i];for(let e=0,i=t.length;e<i;e++){if(n=t[e],n.isBranch&&n.__tempNumber){r=n.children;for(let e=0,t=r.length;e<t;e++)r[e].isBranch||Ad(r[e])}Ad(n)}})}(this.__levelList),function(e){e.list.forEach(jd)}(n),this.extraBlock&&o.push(this.extraBlock),o.forEach(e=>e.setAfter()),t.emitEvent(new U(i,o,this.times)),t.emitEvent(new U(a,o,this.times)),this.addBlocks(o),this.__levelList.reset(),this.__updatedList=null,Mt.end(e)}fullLayout(){let t=Mt.start(`FullLayout`),{target:n}=this,{BEFORE:r,LAYOUT:i,AFTER:a}=U,o=this.getBlocks(new K(n));n.emitEvent(new U(r,o,this.times)),e.fullLayout(n),o.forEach(e=>{e.setAfter()}),n.emitEvent(new U(i,o,this.times)),n.emitEvent(new U(a,o,this.times)),this.addBlocks(o),Mt.end(t)}static fullLayout(e){Id(e,!0),e.isBranch?Io.updateBounds(e):To.updateBounds(e),Ld(e)}addExtra(e){if(!this.__updatedList.has(e)){let{updatedList:t,beforeBounds:n}=this.extraBlock||=new Fd([]);t.length?n.add(e.__world):n.set(e.__world),t.add(e)}}createBlock(e){return new Fd(e)}getBlocks(e){return[this.createBlock(e)]}addBlocks(e){this.layoutedBlocks?this.layoutedBlocks.push(...e):this.layoutedBlocks=e}__onReceiveWatchData(e){this.__updatedList=e.data.updatedList}__listenEvents(){this.__eventIds=[this.target.on_([[U.REQUEST,this.layout,this],[U.AGAIN,this.layoutAgain,this],[us.DATA,this.__onReceiveWatchData,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&=(this.stop(),this.__removeListenEvents(),this.config=null)}},Bd=M.get(`Renderer`),Vd=class e{get needFill(){return!(this.canvas.allowBackgroundColor||!this.config.fill)}constructor(e,t,n){this.FPS=60,this.totalTimes=0,this.times=0,this.config={usePartRender:!0,maxFPS:120},this.frames=[],this.target=e,this.canvas=t,n&&(this.config=w.default(n,this.config)),this.__listenEvents()}start(){this.running=!0,this.update(!1)}stop(){this.running=!1}update(e=!0){this.changed||=e,this.__requestRender()}requestLayout(){this.target.emit(U.REQUEST)}checkRender(){if(this.running){let{target:e}=this;e.isApp&&(e.emit(W.CHILD_START,e),e.children.forEach(e=>{e.renderer.FPS=this.FPS,e.renderer.checkRender()}),e.emit(W.CHILD_END,e)),this.changed&&this.canvas.view&&this.render(),this.target.emit(W.NEXT)}}render(e){if(!this.running||!this.canvas.view)return this.update();let{target:t}=this;this.times=0,this.totalBounds=new wt,Bd.log(t.innerName,`--->`);try{this.emitRender(W.START),this.renderOnce(e),this.emitRender(W.END,this.totalBounds),Sa.clearRecycled()}catch(e){this.rendering=!1,Bd.error(e)}Bd.log(`-------------|`)}renderAgain(){this.rendering?this.waitAgain=!0:this.renderOnce()}renderOnce(e){if(this.rendering)return Bd.warn(`rendering`);if(this.times>3)return Bd.warn(`render max times`);if(this.times++,this.totalTimes++,this.rendering=!0,this.changed=!1,this.renderBounds=new wt,this.renderOptions={},e)this.emitRender(W.BEFORE),e();else{if(this.requestLayout(),this.ignore)return void(this.ignore=this.rendering=!1);this.emitRender(W.BEFORE),this.config.usePartRender&&this.totalTimes>1?this.partRender():this.fullRender()}this.emitRender(W.RENDER,this.renderBounds,this.renderOptions),this.emitRender(W.AFTER,this.renderBounds,this.renderOptions),this.updateBlocks=null,this.rendering=!1,this.waitAgain&&(this.waitAgain=!1,this.renderOnce())}partRender(){let{canvas:e,updateBlocks:t}=this;t&&(this.mergeBlocks(),t.forEach(t=>{e.bounds.hit(t)&&!t.isEmpty()&&this.clipRender(t)}))}clipRender(t){let n=Mt.start(`PartRender`),{canvas:r}=this,i=t.getIntersect(r.bounds),a=new wt(i);r.save(),i.spread(e.clipSpread).ceil(),r.clearWorld(i),r.clipWorld(i),this.__render(i,a),r.restore(),Mt.end(n)}fullRender(){let e=Mt.start(`FullRender`),{canvas:t}=this;t.save(),t.clear(),this.__render(t.bounds),t.restore(),Mt.end(e)}__render(e,t){let{canvas:n}=this,r=e.includes(this.target.__world),i=r?{includes:r}:{bounds:e,includes:r};this.needFill&&n.fillWorld(e,this.config.fill),M.showRepaint&&M.drawRepaint(n,e),T.render(this.target,n,i),this.renderBounds=t||=e,this.renderOptions=i,this.totalBounds.isEmpty()?this.totalBounds=t:this.totalBounds.add(t),n.updateRender(t)}addBlock(e){this.updateBlocks||=[],this.updateBlocks.push(e)}mergeBlocks(){let{updateBlocks:e}=this;if(e){let t=new wt;t.setList(e),e.length=0,e.push(t)}}__requestRender(){let e=this.target;if(this.requestTime||!e)return;if(e.parentApp)return e.parentApp.requestRender(!1);this.requestTime=this.frameTime||Date.now();let t=()=>{let e=1e3/((this.frameTime=Date.now())-this.requestTime),{maxFPS:n}=this.config;if(n&&e>n)return T.requestRender(t);let{frames:r}=this;r.length>30&&r.shift(),r.push(e),this.FPS=Math.round(r.reduce((e,t)=>e+t,0)/r.length),this.requestTime=0,this.checkRender()};T.requestRender(t)}__onResize(e){if(!this.canvas.unreal){if(e.bigger||!e.samePixelRatio){let{width:t,height:n}=e.old;if(!new wt(0,0,t,n).includes(this.target.__world)||this.needFill||!e.samePixelRatio)return this.addBlock(this.canvas.bounds),void this.target.forceUpdate(`surface`)}this.addBlock(new wt(0,0,1,1)),this.update()}}__onLayoutEnd(e){e.data&&e.data.map(e=>{let t;e.updatedList&&e.updatedList.list.some(e=>(t=!e.__world.width||!e.__world.height,t&&=(e.isLeafer||Bd.tip(e.innerName,`: empty`),!e.isBranch||e.isBranchLeaf),t)),this.addBlock(t?this.canvas.bounds:e.updatedBounds)})}emitRender(e,t,n){this.target.emitEvent(new W(e,this.times,t,n))}__listenEvents(){this.__eventIds=[this.target.on_([[W.REQUEST,this.update,this],[U.END,this.__onLayoutEnd,this],[W.AGAIN,this.renderAgain,this],[ls.RESIZE,this.__onResize,this]])]}__removeListenEvents(){this.target.off_(this.__eventIds)}destroy(){this.target&&=(this.stop(),this.__removeListenEvents(),this.config={},this.canvas=null)}};Vd.clipSpread=10;var{hitRadiusPoint:Hd}=A,Ud=class{constructor(e,t){this.target=e,this.selector=t}getByPoint(e,t,n){t||=0,n||={};let r=n.through||!1,i=n.ignoreHittable||!1,a=n.target||this.target;this.exclude=n.exclude||null,this.point={x:e.x,y:e.y,radiusX:t,radiusY:t},this.findList=new K(n.findList),n.findList||this.hitBranch(a.isBranchLeaf?{children:[a]}:a);let{list:o}=this.findList,s=this.getBestMatchLeaf(o,n.bottomList,i,!!n.findList),c=i?this.getPath(s):this.getHitablePath(s);return this.clear(),r?{path:c,target:s,throughPath:o.length?this.getThroughPath(o):c}:{path:c,target:s}}hitPoint(e,t,n){return!!this.getByPoint(e,t,n).target}getBestMatchLeaf(e,t,n,r){let i=this.findList=new K;if(e.length){let t,{x:r,y:a}=this.point,o={x:r,y:a,radiusX:0,radiusY:0};for(let r=0,a=e.length;r<a;r++)if(t=e[r],(n||To.worldHittable(t))&&(this.hitChild(t,o),i.length)){if(t.isBranchLeaf&&e.some(e=>e!==t&&To.hasParent(e,t))){i.reset();break}return i.list[0]}}if(t){for(let e=0,n=t.length;e<n;e++)if(this.hitChild(t[e].target,this.point,t[e].proxy),i.length)return i.list[0]}return r?null:n?e[0]:e.find(e=>To.worldHittable(e))}getPath(e){let t=new K,n=[],{target:r}=this;for(;e&&(e.syncEventer&&n.push(e.syncEventer),t.add(e),(e=e.parent)!==r););return n.length&&n.forEach(e=>{for(;e&&(e.__.hittable&&t.add(e),(e=e.parent)!==r););}),r&&t.add(r),t}getHitablePath(e){let t=this.getPath(e&&e.hittable?e:null),n,r=new K;for(let e=t.list.length-1;e>-1&&(n=t.list[e],n.__.hittable)&&(r.addAt(n,0),n.__.hitChildren&&(!n.isLeafer||n.mode!==`draw`));e--);return r}getThroughPath(e){let t=new K,n=[];for(let t=e.length-1;t>-1;t--)n.push(this.getPath(e[t]));let r,i,a;for(let e=0,o=n.length;e<o;e++){r=n[e],i=n[e+1];for(let e=0,n=r.length;e<n&&(a=r.list[e],!i||!i.has(a));e++)t.add(a)}return t}hitBranch(e){this.eachFind(e.children,e.__onlyHitMask)}eachFind(e,t){let n,r,{point:i}=this;for(let a=e.length-1;a>-1;a--)if(n=e[a],n.__.visible&&(!t||n.__.mask))if(r=!!n.__.hitRadius||Hd(n.__world,i),n.isBranch){if(r||n.__ignoreHitWorld){if(n.isBranchLeaf&&n.__.__clipAfterFill&&!n.__hitWorld(i))continue;n.topChildren&&this.eachFind(n.topChildren,!1),this.eachFind(n.children,n.__onlyHitMask),n.isBranchLeaf&&this.hitChild(n,i)}}else r&&this.hitChild(n,i)}hitChild(e,t,n){if((!this.exclude||!this.exclude.has(e))&&e.__hitWorld(t)){let{parent:r}=e;if(r&&r.__hasMask&&!e.__.mask){let n,i=[],{children:a}=r;for(let r=0,o=a.length;r<o;r++)if(n=a[r],n.__.mask&&i.push(n),n===e){if(i&&!i.every(e=>e.__hitWorld(t)))return;break}}this.findList.add(n||e)}}clear(){this.point=null,this.findList=null,this.exclude=null}destroy(){this.clear()}},Wd=class{constructor(e,t){this.config={},t&&(this.config=w.default(t,this.config)),this.picker=new Ud(this.target=e,this),this.finder=N.finder&&N.finder()}getByPoint(e,t,n){let{target:r,picker:i}=this;return T.backgrounder&&r&&r.updateLayout(),i.getByPoint(e,t,n)}hitPoint(e,t,n){return this.picker.hitPoint(e,t,n)}getBy(e,t,n,r){return this.finder?this.finder.getBy(e,t,n,r):Ft.need(`find`)}destroy(){this.picker.destroy(),this.finder&&this.finder.destroy()}};Object.assign(N,{watcher:(e,t)=>new Od(e,t),layouter:(e,t)=>new zd(e,t),renderer:(e,t,n)=>new Vd(e,t,n),selector:(e,t)=>new Wd(e,t)}),T.layout=zd.fullLayout,T.render=function(e,t,n){let r=Object.assign(Object.assign({},n),{topRendering:!0});n.topList=new K,e.__render(t,n),n.topList.length&&n.topList.forEach(e=>e.__render(t,r))};var Gd={convert(e,t){let n=Uu.getBase(e),{x:r,y:i}=t,a=Object.assign(Object.assign({},n),{x:r,y:i,width:e.width,height:e.height,pointerType:e.pointerType,pressure:e.pressure});return a.pointerType===`pen`&&(a.tangentialPressure=e.tangentialPressure,a.tiltX=e.tiltX,a.tiltY=e.tiltY,a.twist=e.twist),a},convertMouse(e,t){let n=Uu.getBase(e),{x:r,y:i}=t;return Object.assign(Object.assign({},n),{x:r,y:i,width:1,height:1,pointerType:`mouse`,pressure:.5})},convertTouch(e,t){let n=Gd.getTouch(e),r=Uu.getBase(e),{x:i,y:a}=t;return Object.assign(Object.assign({},r),{x:i,y:a,width:1,height:1,pointerType:`touch`,multiTouch:e.touches.length>1,pressure:n.force})},getTouch:e=>e.targetTouches[0]||e.changedTouches[0]},Kd={convert(e){let t=Uu.getBase(e);return Object.assign(Object.assign({},t),{code:e.code,key:e.key})}},{pathCanDrag:qd}=Uu,Jd=class extends ad{get notPointer(){let{p:e}=this;return e.type!==`pointer`||e.touch||this.useMultiTouch}get notTouch(){let{p:e}=this;return e.type===`mouse`||this.usePointer}get notMouse(){return this.usePointer||this.useTouch}__listenEvents(){super.__listenEvents();let e=this.view=this.canvas.view;this.viewEvents={pointerdown:this.onPointerDown,mousedown:this.onMouseDown,touchstart:this.onTouchStart,pointerleave:this.onPointerLeave,contextmenu:this.onContextMenu,wheel:this.onWheel,gesturestart:this.onGesturestart,gesturechange:this.onGesturechange,gestureend:this.onGestureend},this.windowEvents={pointermove:this.onPointerMove,pointerup:this.onPointerUp,pointercancel:this.onPointerCancel,mousemove:this.onMouseMove,mouseup:this.onMouseUp,touchmove:this.onTouchMove,touchend:this.onTouchEnd,touchcancel:this.onTouchCancel,keydown:this.onKeyDown,keyup:this.onKeyUp,scroll:this.onScroll};let{viewEvents:t,windowEvents:n}=this;for(let n in t)t[n]=t[n].bind(this),e.addEventListener(n,t[n]);for(let e in n)n[e]=n[e].bind(this),window.addEventListener(e,n[e])}__removeListenEvents(){super.__removeListenEvents();let{viewEvents:e,windowEvents:t}=this;for(let t in e)this.view.removeEventListener(t,e[t]),this.viewEvents={};for(let e in t)window.removeEventListener(e,t[e]),this.windowEvents={}}getTouches(e){let t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}preventDefaultPointer(e){let{pointer:t}=this.config;t.preventDefault&&e.preventDefault()}preventDefaultWheel(e){let{wheel:t}=this.config;t.preventDefault&&e.preventDefault()}preventWindowPointer(e){return!this.downData&&e.target!==this.view}onKeyDown(e){this.keyDown(Kd.convert(e))}onKeyUp(e){this.keyUp(Kd.convert(e))}onContextMenu(e){this.config.pointer.preventDefaultMenu&&e.preventDefault(),this.menu(Gd.convert(e,this.getLocal(e)))}onScroll(){this.canvas.updateClientBounds()}onPointerDown(e){this.preventDefaultPointer(e),this.notPointer||(this.usePointer||=!0,this.pointerDown(Gd.convert(e,this.getLocal(e))))}onPointerMove(e,t){if(this.notPointer||this.preventWindowPointer(e))return;this.usePointer||=!0;let n=Gd.convert(e,this.getLocal(e,!0));t?this.pointerHover(n):this.pointerMove(n)}onPointerLeave(e){this.onPointerMove(e,!0)}onPointerUp(e){this.downData&&this.preventDefaultPointer(e),this.notPointer||this.preventWindowPointer(e)||this.pointerUp(Gd.convert(e,this.getLocal(e)))}onPointerCancel(){this.useMultiTouch||this.pointerCancel()}onMouseDown(e){this.preventDefaultPointer(e),this.notMouse||this.pointerDown(Gd.convertMouse(e,this.getLocal(e)))}onMouseMove(e){this.notMouse||this.preventWindowPointer(e)||this.pointerMove(Gd.convertMouse(e,this.getLocal(e,!0)))}onMouseUp(e){this.downData&&this.preventDefaultPointer(e),this.notMouse||this.preventWindowPointer(e)||this.pointerUp(Gd.convertMouse(e,this.getLocal(e)))}onMouseCancel(){this.notMouse||this.pointerCancel()}onTouchStart(e){let t=Gd.getTouch(e),n=this.getLocal(t,!0),{preventDefault:r}=this.config.touch;(!0===r||r===`auto`&&qd(this.findPath(n)))&&e.preventDefault(),this.multiTouchStart(e),this.notTouch||(this.touchTimer&&=(window.clearTimeout(this.touchTimer),0),this.useTouch=!0,this.pointerDown(Gd.convertTouch(e,n)))}onTouchMove(e){if(this.multiTouchMove(e),this.notTouch||this.preventWindowPointer(e))return;let t=Gd.getTouch(e);this.pointerMove(Gd.convertTouch(e,this.getLocal(t)))}onTouchEnd(e){if(this.multiTouchEnd(),this.notTouch||this.preventWindowPointer(e))return;this.touchTimer&&clearTimeout(this.touchTimer),this.touchTimer=setTimeout(()=>{this.useTouch=!1},500);let t=Gd.getTouch(e);this.pointerUp(Gd.convertTouch(e,this.getLocal(t)))}onTouchCancel(){this.notTouch||this.pointerCancel()}multiTouchStart(e){this.useMultiTouch=e.touches.length>1,this.touches=this.useMultiTouch?this.getTouches(e.touches):void 0,this.useMultiTouch&&this.pointerCancel()}multiTouchMove(e){if(this.useMultiTouch&&e.touches.length>1){let t=this.getTouches(e.touches),n=this.getKeepTouchList(this.touches,t);n.length>1&&(this.multiTouch(Uu.getBase(e),n),this.touches=t)}}multiTouchEnd(){this.touches=null,this.useMultiTouch=!1,this.transformEnd()}getKeepTouchList(e,t){let n,r=[];return e.forEach(e=>{n=t.find(t=>t.identifier===e.identifier),n&&r.push({from:this.getLocal(e),to:this.getLocal(n)})}),r}getLocalTouchs(e){return e.map(e=>this.getLocal(e))}onWheel(e){this.preventDefaultWheel(e),this.wheel(Object.assign(Object.assign(Object.assign({},Uu.getBase(e)),this.getLocal(e)),{deltaX:e.deltaX,deltaY:e.deltaY}))}onGesturestart(e){this.useMultiTouch||(this.preventDefaultWheel(e),this.lastGestureScale=1,this.lastGestureRotation=0)}onGesturechange(e){if(this.useMultiTouch)return;this.preventDefaultWheel(e);let t=Uu.getBase(e);Object.assign(t,this.getLocal(e));let n=e.scale/this.lastGestureScale,r=(e.rotation-this.lastGestureRotation)/Math.PI*180*(Ce.within(this.config.wheel.rotateSpeed,0,1)/4+.1);this.zoom(Object.assign(Object.assign({},t),{scale:n*n})),this.rotate(Object.assign(Object.assign({},t),{rotation:r})),this.lastGestureScale=e.scale,this.lastGestureRotation=e.rotation}onGestureend(e){this.useMultiTouch||(this.preventDefaultWheel(e),this.transformEnd())}setCursor(e){super.setCursor(e);let t=[];this.eachCursor(e,t),C(t[t.length-1])&&t.push(`default`),this.canvas.view.style.cursor=t.map(e=>C(e)?`url(${e.url}) ${e.x||0} ${e.y||0}`:e).join(`,`)}eachCursor(e,t,n=0){if(n++,S(e))e.forEach(e=>this.eachCursor(e,t,n));else{let r=y(e)&&od.get(e);r&&n<2?this.eachCursor(r,t,n):t.push(e)}}destroy(){this.view&&(super.destroy(),this.view=null,this.touches=null)}};function Yd(e,t,n){e.__.__font?J.fillText(e,t,n):e.__.windingRule?t.fill(e.__.windingRule):t.fill()}function Xd(e,t,n,r,i){let a=n.__;C(e)?J.drawStrokesStyle(e,t,!1,n,r,i):(r.setStroke(e,a.__strokeWidth*t,a),r.stroke()),a.__useArrow&&J.strokeArrow(e,n,r,i)}function Zd(e,t,n,r,i){let a=n.__;C(e)?J.drawStrokesStyle(e,t,!0,n,r,i):(r.setStroke(e,a.__strokeWidth*t,a),J.drawTextStroke(n,r,i))}function Qd(e,t,n,r,i){let a=r.getSameCanvas(!0,!0);a.font=n.__.__font,Zd(e,2,n,a,i),a.blendMode=t===`outside`?`destination-out`:`destination-in`,J.fillText(n,a,i),a.blendMode=`normal`,To.copyCanvasByWorld(n,r,a),a.recycle(n.__nowWorld)}var{getSpread:$d,copyAndSpread:ef,toOuterOf:tf,getOuterOf:nf,getByMove:rf,move:af,getIntersectData:of}=A,sf={},cf,{stintSet:lf}=w,{hasTransparent:uf}=Ic;function df(e,t,n){if(!C(t)||!1===t.visible||t.opacity===0)return;let r,{boxBounds:i}=n.__layout;switch(t.type){case`image`:r=zc.image(n,e,t,i,!cf||!cf[t.url]);break;case`linear`:r=Bc.linearGradient(t,i);break;case`radial`:r=Bc.radialGradient(t,i);break;case`angular`:r=Bc.conicGradient(t,i);break;case`solid`:let{type:a,color:o,opacity:s}=t;r={type:a,style:Ic.string(o,s)};break;default:_(t.r)||(r={type:`solid`,style:Ic.string(t)})}if(r&&(r.originPaint=t,y(r.style)&&uf(r.style)&&(r.isTransparent=!0),t.style)){if(t.style.strokeWidth===0)return;r.strokeStyle=t.style}return r}var ff={compute:function(e,t){let n=t.__,r=[],i,a,o,s=n.__input[e];S(s)||(s=[s]),cf=zc.recycleImage(e,n);for(let n,i=0,a=s.length;i<a;i++)(n=df(e,s[i],t))&&(r.push(n),n.strokeStyle&&(o||=1,n.strokeStyle.strokeWidth&&(o=Math.max(o,n.strokeStyle.strokeWidth))));n[`_`+e]=r.length?r:void 0,r.length?(r.every(e=>e.isTransparent)&&(r.some(e=>e.image)&&(i=!0),a=!0),e===`fill`?(lf(n,`__isAlphaPixelFill`,i),lf(n,`__isTransparentFill`,a)):(lf(n,`__isAlphaPixelStroke`,i),lf(n,`__isTransparentStroke`,a),lf(n,`__hasMultiStrokeStyle`,o))):n.__removePaint(e,!1)},fill:function(e,t,n,r){n.fillStyle=e,Yd(t,n,r)},fills:function(e,t,n,r){let i,a,o;for(let s=0,c=e.length;s<c;s++){if(i=e[s],a=i.originPaint,i.image){if(o?o++:o=1,zc.checkImage(i,!t.__.__font,t,n,r))continue;if(!i.style){o===1&&i.image.isPlacehold&&t.drawImagePlaceholder(i,n,r);continue}}if(n.fillStyle=i.style,i.transform||a.scaleFixed){if(n.save(),i.transform&&n.transform(i.transform),a.scaleFixed){let{scaleX:e,scaleY:r}=t.getRenderScaleData(!0);(!0===a.scaleFixed||a.scaleFixed===`zoom-in`&&e>1&&r>1)&&n.scale(1/e,1/r)}a.blendMode&&(n.blendMode=a.blendMode),Yd(t,n,r),n.restore()}else a.blendMode?(n.saveBlendMode(a.blendMode),Yd(t,n,r),n.restoreBlendMode()):Yd(t,n,r)}},fillPathOrText:Yd,fillText:function(e,t,n){let r=e.__,{rows:i,decorationY:a}=r.__textDrawData,o;r.__isPlacehold&&r.placeholderColor&&(t.fillStyle=r.placeholderColor);for(let e=0,n=i.length;e<n;e++)o=i[e],o.text?t.fillText(o.text,o.x,o.y):o.data&&o.data.forEach(e=>{t.fillText(e.char,e.x,o.y)});if(a){let{decorationColor:e,decorationHeight:n}=r.__textDrawData;e&&(t.fillStyle=e),i.forEach(e=>a.forEach(r=>t.fillRect(e.x,e.y+r,e.width,n)))}},stroke:function(e,t,n,r){let i=t.__;if(i.__strokeWidth)if(i.__font)J.strokeText(e,t,n,r);else switch(i.strokeAlign){case`center`:Xd(e,1,t,n,r);break;case`inside`:(function(e,t,n,r){n.save(),n.clipUI(t),Xd(e,2,t,n,r),n.restore()})(e,t,n,r);break;case`outside`:(function(e,t,n,r){let i=t.__;if(i.__fillAfterStroke)Xd(e,2,t,n,r);else{let{renderBounds:a}=t.__layout,o=n.getSameCanvas(!0,!0);t.__drawRenderPath(o),Xd(e,2,t,o,r),o.clipUI(i),o.clearWorld(a),To.copyCanvasByWorld(t,n,o),o.recycle(t.__nowWorld)}})(e,t,n,r)}},strokes:function(e,t,n,r){J.stroke(e,t,n,r)},strokeText:function(e,t,n,r){switch(t.__.strokeAlign){case`center`:Zd(e,1,t,n,r);break;case`inside`:Qd(e,`inside`,t,n,r);break;case`outside`:t.__.__fillAfterStroke?Zd(e,2,t,n,r):Qd(e,`outside`,t,n,r)}},drawTextStroke:function(e,t,n){let r,i=e.__.__textDrawData,{rows:a,decorationY:o}=i;for(let e=0,n=a.length;e<n;e++)r=a[e],r.text?t.strokeText(r.text,r.x,r.y):r.data&&r.data.forEach(e=>{t.strokeText(e.char,e.x,r.y)});if(o){let{decorationHeight:e}=i;a.forEach(n=>o.forEach(r=>t.strokeRect(n.x,n.y+r,n.width,e)))}},drawStrokesStyle:function(e,t,n,r,i,a){let o,s=r.__,{__hasMultiStrokeStyle:c}=s;c||i.setStroke(void 0,s.__strokeWidth*t,s);for(let l=0,u=e.length;l<u;l++)if(o=e[l],(!o.image||!zc.checkImage(o,!1,r,i,a))&&o.style){if(c){let{strokeStyle:e}=o;e?i.setStroke(o.style,s.__getRealStrokeWidth(e)*t,s,e):i.setStroke(o.style,s.__strokeWidth*t,s)}else i.strokeStyle=o.style;o.originPaint.blendMode?(i.saveBlendMode(o.originPaint.blendMode),n?J.drawTextStroke(r,i,a):i.stroke(),i.restoreBlendMode()):n?J.drawTextStroke(r,i,a):i.stroke()}},shape:function(e,t,n){let r=t.getSameCanvas(),i=t.bounds,a=e.__nowWorld,o=e.__layout,s=e.__nowWorldShapeBounds||={},c,l,u,d,f,p;tf(o.strokeSpread?(ef(sf,o.boxBounds,o.strokeSpread),sf):o.boxBounds,a,s);let{scaleX:m,scaleY:h}=e.getRenderScaleData(!0);if(i.includes(s))p=r,c=f=s,l=a;else{let r;r=T.fullImageShadow?s:of(o.renderShapeSpread?$d(i,pe.swapAndScale(o.renderShapeSpread,m,h)):i,s),d=i.getFitMatrix(r);let{a:g,d:_}=d;d.a<1&&(p=t.getSameCanvas(),e.__renderShape(p,n),m*=g,h*=_),f=nf(s,d),c=rf(f,-d.e,-d.f),l=nf(a,d),af(l,-d.e,-d.f);let v=n.matrix;v?(u=new Xe(d),u.multiply(v),g*=v.scaleX,_*=v.scaleY):u=d,u.withScale(g,_),n=Object.assign(Object.assign({},n),{matrix:u})}return e.__renderShape(r,n),{canvas:r,matrix:u,fitMatrix:d,bounds:c,renderBounds:l,worldCanvas:p,shapeBounds:f,scaleX:m,scaleY:h}}},pf,mf=new wt,{isSame:hf}=A;function gf(e,t,n,r,i,a){if(t===`fill`&&!e.__.__naturalWidth){let t=e.__;if(t.__naturalWidth=r.width/t.pixelRatio,t.__naturalHeight=r.height/t.pixelRatio,t.__autoSide)return e.forceUpdate(`width`),e.__proxyData&&(e.setProxyAttr(`width`,t.width),e.setProxyAttr(`height`,t.height)),!1}return i.data||zc.createData(i,r,n,a),!0}function _f(e,t){bf(e,ns.LOAD,t)}function vf(e,t){bf(e,ns.LOADED,t)}function yf(e,t,n){t.error=n,e.forceUpdate(`surface`),bf(e,ns.ERROR,t)}function bf(e,t,n){e.hasEvent(t)&&e.emitEvent(new ns(t,n))}function xf(e,t){let{leafer:n}=e;n&&n.viewReady&&(n.renderer.ignore=t)}var{get:Sf,translate:Cf}=D,wf=new wt,Tf={},Ef={};function Df(e,t,n,r){let i=y(e)||r?(r?n-r*t:n%t)/((r||Math.floor(n/t))-1):e;return e===`auto`&&i<0?0:i}var Of={},kf=ke(),{get:Af,set:jf,rotateOfOuter:Mf,translate:Nf,scaleOfOuter:Pf,multiplyParent:Ff,scale:If,rotate:Lf,skew:Rf}=D;function zf(e,t,n,r,i,a,o,s){o&&Lf(e,o),s&&Rf(e,s.x,s.y),i&&If(e,i,a),Nf(e,t.x+n,t.y+r)}function Bf(e,t,n,r){return new(n||=Promise)(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})}var{get:Vf,scale:Hf,copy:Uf}=D,{getFloorScale:Wf}=Ce,{abs:Gf}=Math,Kf={image:function(e,t,n,r,i){let a,o,s=Sa.get(n);return pf&&n===pf.paint&&hf(r,pf.boxBounds)?a=pf.leafPaint:(a={type:n.type,image:s},s.hasAlphaPixel&&(a.isTransparent=!0),pf=s.use>1?{leafPaint:a,paint:n,boxBounds:mf.set(r)}:null),(i||s.loading)&&(o={image:s,attrName:t,attrValue:n}),s.ready?(gf(e,t,n,s,a,r),i&&(_f(e,o),vf(e,o))):s.error?i&&yf(e,o,s.error):(i&&(xf(e,!0),_f(e,o)),a.loadId=s.load(()=>{xf(e,!1),e.destroyed||(gf(e,t,n,s,a,r)&&(s.hasAlphaPixel&&(e.__layout.hitCanvasChanged=!0),e.forceUpdate(`surface`)),vf(e,o)),a.loadId=void 0},t=>{xf(e,!1),yf(e,o,t),a.loadId=void 0}),e.placeholderColor&&(e.placeholderDelay?setTimeout(()=>{s.ready||(s.isPlacehold=!0,e.forceUpdate(`surface`))},e.placeholderDelay):s.isPlacehold=!0)),a},checkImage:function(e,t,n,r,i){let{scaleX:a,scaleY:o}=zc.getImageRenderScaleData(e,n,r,i),{image:s,data:c,originPaint:l}=e,{exporting:u}=i;return!(!c||e.patternId===a+`-`+o&&!u)&&(t&&(c.repeat?t=!1:l.changeful||T.name===`miniapp`&&ls.isResizing(n)||u||(t=T.image.isLarge(s,a,o))),t?(n.__.__isFastShadow&&(r.fillStyle=e.style||`#000`,r.fill()),zc.drawImage(e,a,o,n,r,i),!0):(!e.style||l.sync||u?zc.createPattern(e,n,r,i):zc.createPatternTask(e,n,r,i),!1))},drawImage:function(e,t,n,r,i,a){let{data:o,image:s}=e,{blendMode:c}=e.originPaint,{opacity:l,transform:u}=o,d=s.getFull(o.filters),f=r.__,p,{width:m,height:h}=s;(p=u&&!u.onlyScale||f.path||f.cornerRadius)||l||c?(i.save(),p&&i.clipUI(r),c&&(i.blendMode=c),l&&(i.opacity*=l),u&&i.transform(u),i.drawImage(d,0,0,m,h),i.restore()):(o.scaleX&&(m*=o.scaleX,h*=o.scaleY),i.drawImage(d,0,0,m,h))},getImageRenderScaleData:function(e,t,n,r){let i=t.getRenderScaleData(!0,e.originPaint.scaleFixed),{data:a}=e;if(n){let{pixelRatio:e}=n;i.scaleX*=e,i.scaleY*=e}return a&&a.scaleX&&(i.scaleX*=Math.abs(a.scaleX),i.scaleY*=Math.abs(a.scaleY)),i},recycleImage:function(e,t){let n=t[`_`+e];if(S(n)){let r,i,a,o,s;for(let c=0,l=n.length;c<l;c++)r=n[c],i=r.image,s=i&&i.url,s&&(a||={},a[s]=!0,Sa.recycle(i),i.loading&&(o||(o=t.__input&&t.__input[e]||[],S(o)||(o=[o])),i.unload(n[c].loadId,!o.some(e=>e.url===s))));return a}return null},createPatternTask:function(e,t,n,r){e.patternTask||=Sa.patternTasker.add(()=>Bf(this,void 0,void 0,function*(){e.patternTask=null,n.bounds.hit(t.__nowWorld)&&zc.createPattern(e,t,n,r),t.forceUpdate(`surface`)}),300)},createPattern:function(e,t,n,r){let{scaleX:i,scaleY:a}=zc.getImageRenderScaleData(e,t,n,r),o=i+`-`+a;if(e.patternId!==o&&!t.destroyed&&(!T.image.isLarge(e.image,i,a)||e.data.repeat)){let{image:n,data:r}=e,{transform:s,gap:c}=r,l=zc.getPatternFixScale(e,i,a),u,d,f,{width:p,height:m}=n;l&&(i*=l,a*=l),p*=i,m*=a,c&&(d=c.x*i/Gf(r.scaleX||1),f=c.y*a/Gf(r.scaleY||1)),(s||i!==1||a!==1)&&(i*=Wf(p+(d||0)),a*=Wf(m+(f||0)),u=Vf(),s&&Uf(u,s),Hf(u,1/i,1/a));let h=n.getCanvas(p,m,r.opacity,r.filters,d,f,t.leafer&&t.leafer.config.smooth);e.style=n.getPattern(h,r.repeat||T.origin.noRepeat||`no-repeat`,u,e),e.patternId=o}},getPatternFixScale:function(e,t,n){let{image:r}=e,i,a=T.image.maxPatternSize,o=r.width*r.height;return r.isSVG?t>1&&(i=Math.ceil(t)/t):a>o&&(a=o),(o*=t*n)>a&&(i=Math.sqrt(a/o)),i},createData:function(e,t,n,r){e.data=zc.getPatternData(n,r,t)},getPatternData:function(e,t,n){e.padding&&(t=wf.set(t).shrink(e.padding)),e.mode===`strench`&&(e.mode=`stretch`);let{width:r,height:i}=n,{opacity:a,mode:o,align:s,offset:c,scale:l,size:u,rotation:d,skew:f,clipSize:p,repeat:m,gap:h,filters:g}=e,_=t.width===r&&t.height===i,v={mode:o},b=s!==`center`&&(d||0)%180==90,x,S;switch(A.set(Ef,0,0,b?i:r,b?r:i),o&&o!==`cover`&&o!==`fit`?((l||u)&&(Ce.getScaleData(l,u,n,Tf),x=Tf.scaleX,S=Tf.scaleY),(s||h||m)&&(x&&A.scale(Ef,x,S,!0),s&&at.toPoint(s,Ef,t,Ef,!0,!0))):_&&!d||(x=S=A.getFitScale(t,Ef,o!==`fit`),A.put(t,n,s,x,!1,Ef),A.scale(Ef,x,S,!0)),c&&k.move(Ef,c),o){case`stretch`:_?x&&=S=void 0:(x=t.width/r,S=t.height/i,zc.stretchMode(v,t,x,S));break;case`normal`:case`clip`:if(Ef.x||Ef.y||x||p||d||f){let e,n;p&&(e=t.width/p.width,n=t.height/p.height),zc.clipMode(v,t,Ef.x,Ef.y,x,S,d,f,e,n),e&&(x=x?x*e:e,S=S?S*n:n)}break;case`repeat`:(!_||x||d||f)&&zc.repeatMode(v,t,r,i,Ef.x,Ef.y,x,S,d,f,s,e.freeTransform),m||(v.repeat=`repeat`);let n=C(m);(h||n)&&(v.gap=function(e,t,n,r,i){let a,o;return C(e)?(a=e.x,o=e.y):a=o=e,{x:Df(a,n,i.width,t&&t.x),y:Df(o,r,i.height,t&&t.y)}}(h,n&&m,Ef.width,Ef.height,t));break;default:x&&zc.fillOrFitMode(v,t,Ef.x,Ef.y,x,S,d)}return v.transform||(t.x||t.y)&&Cf(v.transform=Sf(),t.x,t.y),x&&(v.scaleX=x,v.scaleY=S),a&&a<1&&(v.opacity=a),g&&(v.filters=g),m&&(v.repeat=y(m)?m===`x`?`repeat-x`:`repeat-y`:`repeat`),v},stretchMode:function(e,t,n,r){let i=Af(),{x:a,y:o}=t;a||o?Nf(i,a,o):i.onlyScale=!0,If(i,n,r),e.transform=i},fillOrFitMode:function(e,t,n,r,i,a,o){let s=Af();Nf(s,t.x+n,t.y+r),If(s,i,a),o&&Mf(s,{x:t.x+t.width/2,y:t.y+t.height/2},o),e.transform=s},clipMode:function(e,t,n,r,i,a,o,s,c,l){let u=Af();zf(u,t,n,r,i,a,o,s),c&&(o||s?(jf(kf),Pf(kf,t,c,l),Ff(u,kf)):Pf(u,t,c,l)),e.transform=u},repeatMode:function(e,t,n,r,i,a,o,s,c,l,u,d){let f=Af();if(d)zf(f,t,i,a,o,s,c,l);else{if(c)if(u===`center`)Mf(f,{x:n/2,y:r/2},c);else switch(Lf(f,c),c){case 90:Nf(f,r,0);break;case 180:Nf(f,n,r);break;case 270:Nf(f,0,n)}Of.x=t.x+i,Of.y=t.y+a,Nf(f,Of.x,Of.y),o&&Pf(f,Of,o,s)}e.transform=f}},{toPoint:qf}=nt,{hasTransparent:Jf}=Ic,Yf={},Xf={};function Zf(e,t,n,r){if(n){let i,a,o,s;for(let e=0,c=n.length;e<c;e++)i=n[e],y(i)?(o=e/(c-1),a=Ic.string(i,r)):(o=i.offset,a=Ic.string(i.color,r)),t.addColorStop(o,a),!s&&Jf(a)&&(s=!0);s&&(e.isTransparent=!0)}}var{getAngle:Qf,getDistance:$f}=k,{get:ep,rotateOfOuter:tp,scaleOfOuter:np}=D,{toPoint:rp}=nt,ip={},ap={};function op(e,t,n,r,i){let a,{width:o,height:s}=e;if(o!==s||r){let e=Qf(t,n);a=ep(),i?(np(a,t,o/s*(r||1),1),tp(a,t,e+90)):(np(a,t,1,o/s*(r||1)),tp(a,t,e))}return a}var{getDistance:sp}=k,{toPoint:cp}=nt,lp={},up={},dp={linearGradient:function(e,t){let{from:n,to:r,type:i,opacity:a}=e;qf(n||`top`,t,Yf),qf(r||`bottom`,t,Xf);let o=T.canvas.createLinearGradient(Yf.x,Yf.y,Xf.x,Xf.y),s={type:i,style:o};return Zf(s,o,e.stops,a),s},radialGradient:function(e,t){let{from:n,to:r,type:i,opacity:a,stretch:o}=e;rp(n||`center`,t,ip),rp(r||`bottom`,t,ap);let s=T.canvas.createRadialGradient(ip.x,ip.y,0,ip.x,ip.y,$f(ip,ap)),c={type:i,style:s};Zf(c,s,e.stops,a);let l=op(t,ip,ap,o,!0);return l&&(c.transform=l),c},conicGradient:function(e,t){let{from:n,to:r,type:i,opacity:a,stretch:o}=e;cp(n||`center`,t,lp),cp(r||`bottom`,t,up);let s=T.conicGradientSupport?T.canvas.createConicGradient(0,lp.x,lp.y):T.canvas.createRadialGradient(lp.x,lp.y,0,lp.x,lp.y,sp(lp,up)),c={type:i,style:s};Zf(c,s,e.stops,a);let l=op(t,lp,up,o||1,T.conicGradientRotate90);return l&&(c.transform=l),c},getTransform:op},{copy:fp,move:pp,toOffsetOutBounds:mp}=A,{max:hp,abs:gp}=Math,_p={},vp=new Xe,yp={};function bp(e,t){let n,r,i,a,o=0,s=0,c=0,l=0;return t.forEach(e=>{n=e.x||0,r=e.y||0,a=1.5*(e.blur||0),i=gp(e.spread||0),o=hp(o,i+a-r),s=hp(s,i+a+n),c=hp(c,i+a+r),l=hp(l,i+a-n)}),o===s&&s===c&&c===l?o:[o,s,c,l]}function xp(e,t,n){let{shapeBounds:r}=n,i,a;T.fullImageShadow?(fp(_p,e.bounds),pp(_p,t.x-r.x,t.y-r.y),i=e.bounds,a=_p):(i=r,a=t),e.copyWorld(n.canvas,i,a)}var{toOffsetOutBounds:Sp}=A,Cp={},wp={shadow:function(e,t,n){let r,i,{__nowWorld:a}=e,{shadow:o}=e.__,{worldCanvas:s,bounds:c,renderBounds:l,shapeBounds:u,scaleX:d,scaleY:f}=n,p=t.getSameCanvas(),m=o.length-1;mp(c,yp,l),o.forEach((o,h)=>{let g=1;if(o.scaleFixed){let e=Math.abs(a.scaleX);e>1&&(g=1/e)}p.setWorldShadow(yp.offsetX+(o.x||0)*d*g,yp.offsetY+(o.y||0)*f*g,(o.blur||0)*d*g,Ic.string(o.color)),i=Vc.getShadowTransform(e,p,n,o,yp,g),i&&p.setTransform(i),xp(p,yp,n),i&&p.resetTransform(),r=l,o.box&&(p.restore(),p.save(),s&&(p.copyWorld(p,l,a,`copy`),r=a),s?p.copyWorld(s,a,a,`destination-out`):p.copyWorld(n.canvas,u,c,`destination-out`)),To.copyCanvasByWorld(e,t,p,r,o.blendMode),m&&h<m&&p.clearWorld(r)}),p.recycle(r)},innerShadow:function(e,t,n){let r,i,{__nowWorld:a}=e,{innerShadow:o}=e.__,{worldCanvas:s,bounds:c,renderBounds:l,shapeBounds:u,scaleX:d,scaleY:f}=n,p=t.getSameCanvas(),m=o.length-1;Sp(c,Cp,l),o.forEach((o,h)=>{let g=1;if(o.scaleFixed){let e=Math.abs(a.scaleX);e>1&&(g=1/e)}p.save(),p.setWorldShadow(Cp.offsetX+(o.x||0)*d*g,Cp.offsetY+(o.y||0)*f*g,(o.blur||0)*d*g),i=Vc.getShadowTransform(e,p,n,o,Cp,g,!0),i&&p.setTransform(i),xp(p,Cp,n),p.restore(),s?(p.copyWorld(p,l,a,`copy`),p.copyWorld(s,a,a,`source-out`),r=a):(p.copyWorld(n.canvas,u,c,`source-out`),r=l),p.fillWorld(r,Ic.string(o.color),`source-in`),To.copyCanvasByWorld(e,t,p,r,o.blendMode),m&&h<m&&p.clearWorld(r)}),p.recycle(r)},blur:function(e,t,n){let{blur:r}=e.__;n.setWorldBlur(r*e.__nowWorld.a),n.copyWorldToInner(t,e.__nowWorld,e.__layout.renderBounds),n.filter=`none`},backgroundBlur:function(e,t,n){},getShadowRenderSpread:bp,getShadowTransform:function(e,t,n,r,i,a,o){if(r.spread){let n=2*r.spread*a*(o?-1:1),{width:s,height:c}=e.__layout.strokeBounds;return vp.set().scaleOfOuter({x:(i.x+i.width/2)*t.pixelRatio,y:(i.y+i.height/2)*t.pixelRatio},1+n/s,1+n/c),vp}},isTransformShadow(e){},getInnerShadowSpread:bp},{excludeRenderBounds:Tp}=Mo,Ep;function Dp(e,t,n,r,i,a,o,s){switch(t){case`grayscale`:Ep||(Ep=!0,i.useGrayscaleAlpha(e.__nowWorld));case`alpha`:(function(e,t,n,r,i,a){let o=e.__nowWorld;n.resetTransform(),n.opacity=1,n.useMask(r,o),a&&r.recycle(o),kp(e,t,n,1,i,a)})(e,n,r,i,o,s);break;case`opacity-path`:kp(e,n,r,a,o,s);break;case`path`:s&&n.restore()}}function Op(e){return e.getSameCanvas(!1,!0)}function kp(e,t,n,r,i,a){let o=e.__nowWorld;t.resetTransform(),t.opacity=r,t.copyWorld(n,o,void 0,i),a?n.recycle(o):n.clearWorld(o)}Cl.prototype.__renderMask=function(e,t){let n,r,i,a,o,s,{children:c}=this;for(let l=0,u=c.length;l<u;l++){if(n=c[l],s=n.__.mask,s){o&&(Dp(this,o,e,i,r,a,void 0,!0),r=i=null),s!==`clipping`&&s!==`clipping-path`||Tp(n,t)||n.__render(e,t),a=n.__.opacity,Ep=!1,s===`path`||s===`clipping-path`?(a<1?(o=`opacity-path`,i||=Op(e)):(o=`path`,e.save()),n.__clip(i||e,t)):(o=s===`grayscale`?`grayscale`:`alpha`,r||=Op(e),i||=Op(e),n.__render(r,t));continue}let u=a===1&&n.__.__blendMode;u&&Dp(this,o,e,i,r,a,void 0,!1),Tp(n,t)||n.__render(i||e,t),u&&Dp(this,o,e,i,r,a,u,!1)}Dp(this,o,e,i,r,a,void 0,!0)};var Ap=`>)]}%!?,.:;'"`,jp=Ap+`_#~&*+\\=|`,Mp=new RegExp([[19968,40959],[13312,19903],[131072,173791],[173824,177983],[177984,178207],[178208,183983],[183984,191471],[196608,201551],[201552,205743],[11904,12031],[12032,12255],[12272,12287],[12288,12351],[12736,12783],[12800,13055],[13056,13311],[63744,64255],[65072,65103],[127488,127743],[194560,195103]].map(([e,t])=>`[\\u${e.toString(16)}-\\u${t.toString(16)}]`).join(`|`));function Np(e){let t={};return e.split(``).forEach(e=>t[e]=!0),t}var Pp=Np(`ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz`),Fp=Np(`{[(<'"`),Ip=Np(Ap),Lp=Np(jp),Rp=Np(`- `),zp;(function(e){e[e.Letter=0]=`Letter`,e[e.Single=1]=`Single`,e[e.Before=2]=`Before`,e[e.After=3]=`After`,e[e.Symbol=4]=`Symbol`,e[e.Break=5]=`Break`})(zp||={});var{Letter:Bp,Single:Vp,Before:Hp,After:Up,Symbol:Wp,Break:Gp}=zp;function Kp(e){return Pp[e]?Bp:Rp[e]?Gp:Fp[e]?Hp:Ip[e]?Up:Lp[e]?Wp:Mp.test(e)?Vp:Bp}var qp={trimRight(e){let{words:t}=e,n,r=0,i=t.length;for(let a=i-1;a>-1&&(n=t[a].data[0],n.char===` `);a--)r++,e.width-=n.width;r&&t.splice(i-r,r)}};function Jp(e,t,n){switch(t){case`title`:return n?e.toUpperCase():e;case`upper`:return e.toUpperCase();case`lower`:return e.toLowerCase();default:return e}}var{trimRight:Yp}=qp,{Letter:Xp,Single:Zp,Before:Qp,After:$p,Symbol:em,Break:tm}=zp,nm,rm,im,am,om,sm,cm,lm,um,dm,fm,pm,mm,hm,gm,_m,vm,ym=[];function bm(e,t){um&&!lm&&(lm=um),nm.data.push({char:e,width:t}),im+=t}function xm(){am+=im,nm.width=im,rm.words.push(nm),nm={data:[]},im=0}function Sm(){hm&&=(gm.paraNumber++,rm.paraStart=!0,!1),um&&(rm.startCharSize=lm,rm.endCharSize=um,lm=0),rm.width=am,_m.width?Yp(rm):vm&&Cm(),ym.push(rm),rm={words:[]},am=0}function Cm(){am>(gm.maxWidth||0)&&(gm.maxWidth=am)}var{top:wm,right:Tm,bottom:Em,left:Dm}=$e;function Om(e,t,n){let{bounds:r,rows:i}=e;r[t]+=n;for(let e=0;e<i.length;e++)i[e][t]+=n}Object.assign(Fc,{getDrawData:function(e,t){y(e)||(e=String(e));let n=0,r=0,i=t.__getInput(`width`)||0,a=t.__getInput(`height`)||0,{__padding:o}=t;o&&(i?(n=o[Dm],i-=o[Tm]+o[Dm],!i&&(i=.01)):t.autoSizeAlign||(n=o[Dm]),a?(r=o[wm],a-=o[wm]+o[Em],!a&&(a=.01)):t.autoSizeAlign||(r=o[wm]));let s={bounds:{x:n,y:r,width:i,height:a},rows:[],paraNumber:0,font:T.canvas.font=t.__font};return function(e,t,n){gm=e,ym=e.rows,_m=e.bounds,vm=!_m.width&&!n.autoSizeAlign;let{__letterSpacing:r,paraIndent:i,textCase:a}=n,{canvas:o}=T,{width:s}=_m;if(n.__isCharMode){let e=n.textWrap!==`none`,c=n.textWrap===`break`;hm=!0,fm=null,lm=cm=um=im=am=0,nm={data:[]},rm={words:[]},r&&(t=[...t]);for(let n=0,l=t.length;n<l;n++)sm=t[n],sm===`
`?(im&&xm(),rm.paraEnd=!0,Sm(),hm=!0):(dm=Kp(sm),dm===Xp&&a!==`none`&&(sm=Jp(sm,a,!im)),cm=o.measureText(sm).width,r&&(r<0&&(um=cm),cm+=r),pm=dm===Zp&&(fm===Zp||fm===Xp)||fm===Zp&&dm!==$p,mm=!(dm!==Qp&&dm!==Zp||fm!==em&&fm!==$p),om=hm&&i?s-i:s,e&&s&&am+im+cm>om&&(c?(im&&xm(),am&&Sm()):(mm||=dm===Xp&&fm==$p,(pm||mm||dm===tm||dm===Qp||dm===Zp||im+cm>om)&&im&&xm(),am&&Sm())),sm===` `&&!0!==hm&&am+im===0||(dm===tm?(sm===` `&&im&&xm(),bm(sm,cm),xm()):((pm||mm)&&im&&xm(),bm(sm,cm))),fm=dm);im&&xm(),am&&Sm(),ym.length>0&&(ym[ym.length-1].paraEnd=!0)}else t.split(`
`).forEach(e=>{gm.paraNumber++,am=o.measureText(e).width,ym.push({x:i||0,text:e,width:am,paraStart:!0}),vm&&Cm()})}(s,e,t),o&&function(e,t,n,r,i){if(!r&&n.autoSizeAlign)switch(n.textAlign){case`left`:Om(t,`x`,e[Dm]);break;case`right`:Om(t,`x`,-e[Tm])}if(!i&&n.autoSizeAlign)switch(n.verticalAlign){case`top`:Om(t,`y`,e[wm]);break;case`bottom`:Om(t,`y`,-e[Em])}}(o,s,t,i,a),function(e,t){let{rows:n,bounds:r}=e,i=n.length,{__lineHeight:a,__baseLine:o,__letterSpacing:s,__clipText:c,textAlign:l,verticalAlign:u,paraSpacing:d,autoSizeAlign:f}=t,{x:p,y:m,width:h,height:g}=r,_=a*i+(d?d*(e.paraNumber-1):0),v=o;if(c&&_>g)_=Math.max(g,a),i>1&&(e.overflow=i);else if(g||f)switch(u){case`middle`:m+=(g-_)/2;break;case`bottom`:m+=g-_}v+=m;let y,b,x,S=h||f?h:e.maxWidth;for(let o=0,u=i;o<u;o++){if(y=n[o],y.x=p,y.width<h||y.width>h&&!c)switch(l){case`center`:y.x+=(S-y.width)/2;break;case`right`:y.x+=S-y.width}y.paraStart&&d&&o>0&&(v+=d),y.y=v,v+=a,e.overflow>o&&v>_&&(y.isOverflow=!0,e.overflow=o+1),b=y.x,x=y.width,s<0&&(y.width<0?(x=-y.width+t.fontSize+s,b-=x,x+=t.fontSize):x-=s),b<r.x&&(r.x=b),x>r.width&&(r.width=x),c&&h&&h<x&&(y.isOverflow=!0,e.overflow||=n.length)}r.y=m,r.height=_}(s,t),t.__isCharMode&&function(e,t,n){let{rows:r}=e,{textAlign:i,paraIndent:a,letterSpacing:o}=t,s=n&&i.includes(`both`),c=s||n&&i.includes(`justify`),l=c&&i.includes(`letter`),u,d,f,p,m,h,g,_,v,y;r.forEach(e=>{e.words&&=(m=a&&e.paraStart?a:0,_=e.words.length,c&&(y=!e.paraEnd||s,d=n-e.width-m,l?p=d/(e.words.reduce((e,t)=>e+t.data.length,0)-1):f=_>1?d/(_-1):0),h=o||e.isOverflow||l?0:f?1:2,e.isOverflow&&!o&&(e.textMode=!0),h===2?(e.x+=m,function(e){e.text=``,e.words.forEach(t=>{t.data.forEach(t=>{e.text+=t.char})})}(e)):(e.x+=m,u=e.x,e.data=[],e.words.forEach((t,n)=>{h===1?(g={char:``,x:u},u=function(e,t,n){return e.forEach(e=>{n.char+=e.char,t+=e.width}),t}(t.data,u,g),(e.isOverflow||g.char!==` `)&&e.data.push(g)):u=function(e,t,n,r,i){return e.forEach(e=>{(r||e.char!==` `)&&(e.x=t,n.push(e)),t+=e.width,i&&(t+=i)}),t}(t.data,u,e.data,e.isOverflow,y&&p),y&&(v=n===_-1,f?v||(u+=f,e.width+=f):p&&(e.width+=p*(t.data.length-(v?1:0))))})),null)})}(s,t,i),s.overflow&&function(e,t,n,r){if(!r)return;let{rows:i,overflow:a}=e,{textOverflow:o}=t;if(i.splice(a),o&&o!==`show`){let e,s;o===`hide`?o=``:o===`ellipsis`&&(o=`...`);let c=o?T.canvas.measureText(o).width:0,l=n+r-c;(t.textWrap===`none`?i:[i[a-1]]).forEach(t=>{if(t.isOverflow&&t.data){let n=t.data.length-1;for(let r=n;r>-1&&(e=t.data[r],s=e.x+e.width,!(r===n&&s<l));r--){if(s<l&&e.char!==` `||!r){t.data.splice(r+1),t.width-=e.width;break}t.width-=e.width}t.width+=c,t.data.push({char:o,x:s}),t.textMode&&function(e){e.text=``,e.data.forEach(t=>{e.text+=t.char}),e.data=null}(t)}})}}(s,t,n,i),t.textDecoration!==`none`&&function(e,t){let n,r=0,{fontSize:i,textDecoration:a}=t;switch(e.decorationHeight=i/11,C(a)?(n=a.type,a.color&&(e.decorationColor=Ic.string(a.color)),a.offset&&(r=Math.min(.3*i,Math.max(a.offset,.15*-i)))):n=a,n){case`under`:e.decorationY=[.15*i+r];break;case`delete`:e.decorationY=[.35*-i];break;case`under-delete`:e.decorationY=[.15*i+r,.35*-i]}}(s,t),s}}),Object.assign(Ic,{string:function(e,t){if(!e)return`#000`;let n=x(t)&&t<1;if(y(e)){if(!n||!Ic.object)return e;e=Ic.object(e)}let r=_(e.a)?1:e.a;n&&(r*=t);let i=e.r+`,`+e.g+`,`+e.b;return r===1?`rgb(`+i+`)`:`rgba(`+i+`,`+r+`)`}}),Object.assign(J,ff),Object.assign(zc,Kf),Object.assign(Bc,dp),Object.assign(Vc,wp),Object.assign(N,{interaction:(e,t,n,r)=>new Jd(e,t,n,r),hitCanvas:(e,t)=>new Cd(e,t),hitCanvasManager:()=>new sd}),Ed();var km={class:`tetris-container`},Am={class:`game-info`},jm={class:`score-board`},Mm={class:`controls`},Nm=20,Pm=10,Fm=30,Im=500,Lm=l({__name:`game`,setup(e){let t=[[[1,1,1,1]],[[1,1],[1,1]],[[0,1,0],[1,1,1]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[0,1,1],[1,1,0]],[[1,1,0],[0,1,1]]],i=[null,`#00FFFF`,`#FFFF00`,`#800080`,`#FFA500`,`#0000FF`,`#00FF00`,`#FF0000`],a=u(0),s=u(!0),c=u(!1),l=null,p=null,h=[],g=null,_=null,v=()=>{l=new El({view:`leafer-view`,width:Pm*Fm,height:Nm*Fm,fill:`#1a1a1a`}),p=new Cl,l.add(p),y()},y=()=>{let e=new Cl({opacity:.1});for(let t=0;t<=Pm;t++)e.add(new Dl({x:t*Fm,y:0,width:1,height:Nm*Fm,fill:`#fff`}));for(let t=0;t<=Nm;t++)e.add(new Dl({x:0,y:t*Fm,width:Pm*Fm,height:1,fill:`#fff`}));l.add(e)},b=()=>{h=Array.from({length:Nm},()=>Array(Pm).fill(0))},x=()=>{let e=Math.floor(Math.random()*t.length),n=t[e];g={shape:n,colorIndex:e+1,x:Math.floor(Pm/2)-Math.floor(n[0].length/2),y:0},S(0,0,g.shape)&&ae()},S=(e,t,n)=>{for(let r=0;r<n.length;r++)for(let i=0;i<n[r].length;i++)if(n[r][i]){let n=g.x+i+e,a=g.y+r+t;if(n<0||n>=Pm||a>=Nm||a>=0&&h[a][n]!==0)return!0}return!1},C=e=>e[0].map((t,n)=>e.map(e=>e[n]).reverse()),ee=()=>{g.shape.forEach((e,t)=>{e.forEach((e,n)=>{if(e){let e=g.y+t,r=g.x+n;e>=0&&(h[e][r]=g.colorIndex)}})}),w(),x(),te()},w=()=>{let e=0;for(let t=Nm-1;t>=0;t--)h[t].every(e=>e!==0)&&(h.splice(t,1),h.unshift(Array(Pm).fill(0)),e++,t++);e>0&&(a.value+=e*100)},te=()=>{if(p){p.clear();for(let e=0;e<Nm;e++)for(let t=0;t<Pm;t++)h[e][t]&&p.add(new Dl({x:t*Fm,y:e*Fm,width:Fm-1,height:Fm-1,fill:i[h[e][t]],cornerRadius:2}));g&&g.shape.forEach((e,t)=>{e.forEach((e,n)=>{e&&p.add(new Dl({x:(g.x+n)*Fm,y:(g.y+t)*Fm,width:Fm-1,height:Fm-1,fill:i[g.colorIndex],cornerRadius:2,shadow:{x:2,y:2,blur:4,color:`rgba(0,0,0,0.3)`}}))})})}},ne=(e,t)=>{s.value||c.value||(S(e,t,g.shape)?t>0&&ee():(g.x+=e,g.y+=t,te()))},re=()=>{if(s.value||c.value)return;let e=C(g.shape);S(0,0,e)?S(-1,0,e)?S(1,0,e)||(g.x+=1,g.shape=e):(--g.x,g.shape=e):g.shape=e,te()},ie=()=>{b(),a.value=0,s.value=!1,c.value=!1,x(),te(),_&&clearInterval(_),_=setInterval(()=>ne(0,1),Im)},T=()=>{s.value||(c.value=!c.value,c.value?clearInterval(_):_=setInterval(()=>ne(0,1),Im))},ae=()=>{s.value=!0,clearInterval(_),alert(`! : ${a.value}`)},oe=e=>{if(!s.value)switch(e.code){case`ArrowLeft`:ne(-1,0);break;case`ArrowRight`:ne(1,0);break;case`ArrowDown`:ne(0,1);break;case`ArrowUp`:re();break;case`Space`:T();break}};return n(()=>{v(),window.addEventListener(`keydown`,oe)}),o(()=>{l&&l.destroy(),_&&clearInterval(_),window.removeEventListener(`keydown`,oe)}),(e,t)=>(r(),f(`div`,km,[m(`div`,Am,[t[0]||=m(`h1`,null,`Leafer Tetris`,-1),m(`div`,jm,[m(`p`,null,`: `+d(a.value),1),m(`p`,null,`: `+d(s.value?``:c.value?``:``),1)]),m(`div`,Mm,[s.value?(r(),f(`button`,{key:0,onClick:ie},``)):(r(),f(`button`,{key:1,onClick:T},d(c.value?``:``),1))]),t[1]||=m(`div`,{class:`tips`},[m(`p`,null,`:  | : `),m(`p`,null,` :  | Space: `)],-1)]),t[2]||=m(`div`,{id:`leafer-view`,class:`canvas-area`},null,-1)]))}},[[`__scopeId`,`data-v-c15c1133`]]),Rm={class:`flow-chart-container`},zm=l(t({__name:`process`,setup(e){let t={nodeWidth:120,nodeHeight:50,gapX:100,gapY:30,nodeColor:`#EBF5FF`,strokeColor:`#3B82F6`,endNodeColor:`#F1F5F9`,endNodeStroke:`#64748B`},i=u(null),a=s(null),c=u({id:`root`,label:``,children:[]}),l=u({x:0,y:0}),d=()=>Math.random().toString(36).substr(2,9),p=(e,t)=>{let n=e.children.findIndex(e=>e.id===t);if(n!==-1)return e.children.splice(n,1),!0;for(let n of e.children)if(p(n,t))return!0;return!1},h=(e,t)=>{if(e.id===t)return e.children.push({id:d(),label:` ${Math.floor(Math.random()*100)}`,children:[]}),!0;for(let n of e.children)if(h(n,t))return!0;return!1},g=e=>{if(e.children.length===0){e.height=t.nodeHeight;return}let n=0;e.children.forEach(e=>{g(e),n+=e.height+t.gapY}),n-=t.gapY,e.height=Math.max(t.nodeHeight,n)},_=0,v=(e,n,r)=>{let i=r+(e.height-t.nodeHeight)/2;e.x=n,e.y=i,n>_&&(_=n);let a=r;e.children.forEach(e=>{v(e,n+t.nodeWidth+t.gapX,a),a+=e.height+t.gapY})},y=()=>{_=0,g(c.value),v(c.value,50,50),l.value={x:_+t.nodeWidth+t.gapX,y:c.value.y}},b=(e,t,n,r)=>{let i=e+(n-e)/2;return[new hu({stroke:`#94A3B8`,strokeWidth:2,path:`M ${e} ${t} L ${i} ${t} L ${i} ${r} L ${n} ${r}`}),new hu({fill:`#94A3B8`,path:`M ${n} ${r} L ${n-6} ${r-4} L ${n-6} ${r+4} Z`})]},x=(e,n)=>{if(!a.value)return;let r=new Cl({x:e.x,y:e.y});if(n&&n.x!==void 0&&n.y!==void 0){let r=n.x+t.nodeWidth,i=n.y+t.nodeHeight/2,o=e.x;b(r,i,o,e.y+t.nodeHeight/2).forEach(e=>a.value.tree.add(e))}if(e.children.length===0){let n=e.x+t.nodeWidth,r=e.y+t.nodeHeight/2,i=l.value.x;b(n,r,i,l.value.y+t.nodeHeight/2).forEach(e=>a.value.tree.add(e))}let i=new Dl({width:t.nodeWidth,height:t.nodeHeight,fill:t.nodeColor,stroke:t.strokeColor,strokeWidth:2,cornerRadius:4,shadow:{x:2,y:2,blur:4,color:`rgba(0,0,0,0.1)`}}),o=new X({text:e.label,fontSize:14,fill:`#1E293B`,width:t.nodeWidth,height:t.nodeHeight,textAlign:`center`,verticalAlign:`middle`});r.add(i),r.add(o);let s=new Cl({x:t.nodeWidth-10,y:t.nodeHeight/2,cursor:`pointer`});if(s.add(new Rl({width:20,height:20,x:-10,y:-10,fill:`#10B981`})),s.add(new X({text:`+`,fontSize:16,fill:`#fff`,x:-10,y:-10,width:20,height:20,textAlign:`center`,verticalAlign:`middle`})),s.on(Q.TAP,t=>{t.stop(),h(c.value,e.id),C()}),r.add(s),e.id!==`root`){let n=new Cl({x:t.nodeWidth,y:0,cursor:`pointer`});n.add(new Rl({width:16,height:16,x:-8,y:-8,fill:`#EF4444`})),n.add(new X({text:`-`,fontSize:14,fill:`#fff`,x:-8,y:-9,width:16,height:16,textAlign:`center`,verticalAlign:`middle`})),n.on(Q.TAP,t=>{t.stop(),p(c.value,e.id),C()}),r.add(n)}a.value.tree.add(r),e.children.forEach(t=>x(t,e))},S=()=>{if(!a.value)return;let e=new Cl({x:l.value.x,y:l.value.y}),n=new Dl({width:t.nodeWidth,height:t.nodeHeight,fill:t.endNodeColor,stroke:t.endNodeStroke,strokeWidth:2,cornerRadius:25,shadow:{x:2,y:2,blur:4,color:`rgba(0,0,0,0.1)`}}),r=new X({text:``,fontSize:14,fontWeight:`bold`,fill:`#475569`,width:t.nodeWidth,height:t.nodeHeight,textAlign:`center`,verticalAlign:`middle`});e.add(n),e.add(r),a.value.tree.add(e)},C=()=>{a.value&&(a.value.tree.clear(),y(),x(c.value),S())};return n(()=>{i.value&&(a.value=new vu({view:i.value,tree:{},fill:`#ffffff`,move:{scroll:!0}}),C())}),o(()=>{a.value&&a.value.destroy()}),(e,t)=>(r(),f(`div`,Rm,[m(`div`,{ref_key:`canvasContainer`,ref:i,class:`canvas-view`},null,512),t[0]||=m(`div`,{class:`controls`},[m(`p`,null,`:  "+" `)],-1)]))}}),[[`__scopeId`,`data-v-1f2e3144`]]),Bm=t({__name:`base`,setup(e){let t=null,i=u(null),a=()=>{t=new El({view:i.value,fill:`#333`});let e=new Dl({x:100,y:200,width:100,height:100,fill:`#32cd79`,cornerRadius:[6,2,6,2],draggable:!0,event:{[Q.ENTER]:function(e){e.current.fill=`red`},[Q.LEAVE]:function(e){e.current.fill=`#32cd79`}}}),n=new su({x:200,y:250,width:100,strokeWidth:5,stroke:`#32cd79`});t.add(e),t.add(n)};return n(()=>{a()}),(e,t)=>(r(),f(`div`,{ref_key:`canvasContainer`,ref:i,class:`h-[600px] w-full`},null,512))}}),Vm={class:`h-full`},Hm=t({__name:`index`,setup(e){return(e,t)=>{let n=p,o=a;return r(),f(`div`,Vm,[t[0]||=m(`h2`,{class:`title`},`Leafer `,-1),i(o,{"tab-position":`left`,style:{height:`600px`},class:`demo-tabs`},{default:c(()=>[i(n,{label:``},{default:c(()=>[i(Bm)]),_:1}),i(n,{label:``},{default:c(()=>[i(Lm)]),_:1}),i(n,{label:``},{default:c(()=>[i(zm)]),_:1})]),_:1})])}}});export{Hm as default};