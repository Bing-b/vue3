import{Dr as normalizeClass,Fn as openBlock,Jn as withCtx,Mr as toDisplayString,Rn as renderList,Rr as __toESM,Rt as position_default,Sn as createVNode,X as ElTag,bn as createStaticVNode,er as ref,et as require_dayjs_min,fn as Fragment,gn as createBaseVNode,jn as nextTick,nn as _plugin_vue_export_helper_default,or as unref,tt as ElButton,vn as createCommentVNode,wn as defineComponent,xn as createTextVNode,yn as createElementBlock}from"./index-CmCMrn0J.js";/* empty css            *//* empty css            *//* empty css            */var Node=class{value;next;constructor(e){this.value=e}},Queue=class{#e;#t;#n;constructor(){this.clear()}enqueue(e){let t=new Node(e);this.#e?(this.#t.next=t,this.#t=t):(this.#e=t,this.#t=t),this.#n++}dequeue(){let e=this.#e;if(e)return this.#e=this.#e.next,this.#n--,e.value}peek(){if(this.#e)return this.#e.value}clear(){this.#e=void 0,this.#t=void 0,this.#n=0}get size(){return this.#n}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}};function pLimit(e){validateConcurrency(e);let t=new Queue,n=0,r=()=>{n<e&&t.size>0&&(t.dequeue()(),n++)},i=()=>{n--,r()},a=async(e,t,n)=>{let r=(async()=>e(...n))();t(r);try{await r}catch{}i()},o=(i,o,s)=>{new Promise(e=>{t.enqueue(e)}).then(a.bind(void 0,i,o,s)),(async()=>{await Promise.resolve(),n<e&&r()})()},s=(e,...t)=>new Promise(n=>{o(e,n,t)});return Object.defineProperties(s,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value(){t.clear()}},concurrency:{get:()=>e,set(i){validateConcurrency(i),e=i,queueMicrotask(()=>{for(;n<e&&t.size>0;)r()})}}}),s}function validateConcurrency(e){if(!((Number.isInteger(e)||e===1/0)&&e>0))throw TypeError("Expected `concurrency` to be a number from 1 and up")}var import_dayjs_min=__toESM(require_dayjs_min()),_hoisted_1={class:`demo-card`},_hoisted_2={class:`demo-content`},_hoisted_3={class:`control-panel`},_hoisted_4={class:`config-item`},_hoisted_5={class:`console-wrapper`},_hoisted_6={class:`time`},_hoisted_7={key:0,class:`empty-msg`},p_limit_default=_plugin_vue_export_helper_default(defineComponent({__name:`p-limit`,setup(a){let l=ref([]),d=ref(null),f=(e,t=`info`)=>{l.value.push({time:(0,import_dayjs_min.default)().format(`HH:mm:ss.SSS`),text:e,type:t}),nextTick(()=>{d.value&&(d.value.scrollTop=d.value.scrollHeight)})},p=e=>new Promise(t=>{f(`Task [${e}] - 开始执行 (等待 2s)`),setTimeout(()=>{f(`Task [${e}] - 执行完毕`,`success`),t(e)},2e3)}),m=async()=>{l.value=[],f(`初始化最大并发限额: 1`);let e=pLimit(1),t=[e(()=>p(`Task-X`)),e(()=>p(`Task-Y`)),e(()=>p(`Task-Z`))];await Promise.all(t),f(`所有请求已完成`,`success`)};return(a,c)=>{let u=ElTag,f=ElButton;return openBlock(),createElementBlock(`div`,_hoisted_1,[c[4]||=createBaseVNode(`div`,{class:`demo-info`},[createBaseVNode(`h4`,{class:`title`},`并发控制 (P-Limit)`),createBaseVNode(`p`,{class:`desc`},`模拟受限并发环境下的异步请求执行，确保系统稳定性`)],-1),createBaseVNode(`div`,_hoisted_2,[createBaseVNode(`div`,_hoisted_3,[createBaseVNode(`div`,_hoisted_4,[c[1]||=createBaseVNode(`span`,{class:`label`},`最大并发数`,-1),createVNode(u,{type:`warning`,effect:`dark`},{default:withCtx(()=>c[0]||=[createTextVNode(`1`)]),_:1})]),createVNode(f,{type:`primary`,onClick:m,icon:unref(position_default),large:``},{default:withCtx(()=>c[2]||=[createTextVNode(` 开始模拟并发请求 `)]),_:1},8,[`icon`])]),createBaseVNode(`div`,_hoisted_5,[c[3]||=createStaticVNode(`<div class="console-header" data-v-7a32e4c7><span class="dot red" data-v-7a32e4c7></span><span class="dot yellow" data-v-7a32e4c7></span><span class="dot green" data-v-7a32e4c7></span><span class="title" data-v-7a32e4c7>Terminal Output</span></div>`,1),createBaseVNode(`div`,{class:`console-body`,ref_key:`consoleRef`,ref:d},[(openBlock(!0),createElementBlock(Fragment,null,renderList(l.value,(n,i)=>(openBlock(),createElementBlock(`div`,{key:i,class:`log-line`},[createBaseVNode(`span`,_hoisted_6,`[`+toDisplayString(n.time)+`]`,1),createBaseVNode(`span`,{class:normalizeClass([`msg`,n.type])},toDisplayString(n.text),3)]))),128)),l.value.length===0?(openBlock(),createElementBlock(`div`,_hoisted_7,`等待执行任务...`)):createCommentVNode(``,!0)],512)])])])}}}),[[`__scopeId`,`data-v-7a32e4c7`]]);export{p_limit_default as default};