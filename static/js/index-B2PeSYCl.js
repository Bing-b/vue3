/* empty css             *//* empty css                  */import{x as E,aX as R,az as A,r as m,y as L,z as x,V as B,A as _,P as k,O as S,a6 as I,H as V,L as T,M as D}from"./core-OJ5DsH9Q.js";import{_ as $}from"./main-DdQ5JP9U.js";import{m as z}from"./ui-DUCvL7au.js";const H=E({__name:"editor",props:{matchList:{default:[]},matchListModifiers:{}},emits:R(["updateMatchList"],["update:matchList"]),setup(C,{expose:p,emit:s}){const r=s,u=A(C,"matchList"),c=m(null),o=m(!1),i=()=>{o.value=!0},f=()=>{o.value=!1,c.value&&(v(),u.value.forEach(t=>M(t.matchLabel)))},l=t=>{t.preventDefault()},h=t=>{t.preventDefault()},v=()=>{c.value.innerHTML=""},b=t=>{const e=document.createTextNode("​");t.insertNode(e),t.setStartAfter(e),t.setEndAfter(e)},M=t=>{const e=c.value;if(!e)return;const d=window.getSelection();if(!d)return;d?.rangeCount===0&&e.focus();let n=d.rangeCount>0?d.getRangeAt(0):null;(!n||!e.contains(n.startContainer))&&(e.focus(),n=document.createRange(),n.selectNodeContents(e),n.collapse(!1));const a=document.createElement("span");a.className="matchItem",a.contentEditable="false",a.dataset.character=t,a.innerHTML=`${t} <span>x</span>`,a.querySelector("span")?.addEventListener("click",w=>{w.stopPropagation();const y=a.dataset.character,g=u.value.findIndex(N=>N.matchLabel===y);g!==-1&&u.value.splice(g,1),r("updateMatchList")}),n.deleteContents(),b(n),n.insertNode(a),n.setStartAfter(a),n.setEndAfter(a),b(n),d?.removeAllRanges(),d?.addRange(n)};return p({insertMatch:M,clearValue:v}),(t,e)=>(x(),L("div",{ref_key:"inputBoxRef",ref:c,contenteditable:"true",id:"editor-box",placeholder:"请插入",class:"dark:!border-dark-border","on:beforeInput":h,onPaste:e[0]||(e[0]=B(()=>{},["prevent"])),onCompositionstart:i,onCompositionend:f,onKeydown:l},null,544))}}),P=$(H,[["__scopeId","data-v-091a0ac0"]]),K={class:"h-full"},U={class:"w-1/2 p-5"},q={class:"mb-5"},j=E({__name:"index",setup(C){const p=["香蕉","西瓜","葡萄","荔枝","橘子"],s=m([]),r=m(),u=o=>{s.value.push({matchLabel:o}),r.value.insertMatch(o)},c=()=>{r.value.clearValue(),s.value.forEach(o=>{r.value.insertMatch(o.matchLabel)})};return(o,i)=>{const f=z;return x(),L("div",K,[i[1]||(i[1]=_("h2",{class:"title"},"contenteditable div 应用",-1)),_("div",U,[_("div",q,[(x(),L(S,null,I(p,(l,h)=>k(f,{onClick:v=>u(l),key:h},{default:V(()=>[T(D(l),1)]),_:2},1032,["onClick"])),64))]),k(P,{ref_key:"editorRef",ref:r,matchList:s.value,"onUpdate:matchList":i[0]||(i[0]=l=>s.value=l),onUpdateMatchList:c},null,8,["matchList"])])])}}});export{j as default};
